define("2c46c8f0-e214-4f49-951e-fd5b9d7b4ae1_1.21.1",["@ms/odsp-core-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-diagnostics","@microsoft/sp-core-library","@microsoft/sp-page-context","tslib"],(e,t,n,a,i,r)=>(()=>{var o={986:(e,t,n)=>{var a=n(698);e.exports=a.SPAlternativeUrls}
,676:e=>{"use strict";e.exports=a},207:e=>{"use strict";e.exports=n},529:e=>{"use strict";e.exports=t},408:e=>{"use strict";e.exports=i},698:t=>{"use strict";t.exports=e},280:e=>{"use strict";e.exports=r}},s={};function c(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return o[e](n,n.exports,c),n.exports}c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var d={};return(()=>{"use strict";c.r(d),c.d(d,{CACHE_BREAKPOINT_S:()=>R,CACHE_BREAKPOINT_XL:()=>N,CropMode:()=>n,ImageHelper:()=>V,_PreviewHelper:()=>A,_PreviewUtility:()=>j,_SPResourcePath:()=>h,_SPResourcePathFormat:()=>u,_ThumbnailProviderType:()=>_,_ThumbnailUrlGenerator:()=>H,_UserPhotoSize:()=>t.UserPhotoSize});var e,t=c(986),n={Default:"fit",Fit:"fit",Fill:"fill",Top:"top",Bottom:"bottom"},a=c(529),i=c(207),r=c(676),o=c(408),s=c(698);function l(){return!s.KillSwitch.isActivated("92cd451c-a1b1-4c3e-8003-e98a9a54744e","1/30/2025","joyoshioka - Dynamically retrieves Hubble endpoint by environment.")&&s.FeatureOverrides.isFeatureEnabled({ODB:61703})}!function(e){e.Public="hubblecontent.osi.office.net",e.PublicCDN="cdn.hubblecontent.osi.office.net",e.USNat="hubblecontent.azureedge.eaglex.ic.gov",e.USNatCDN="hubblecontent.azureedge.eaglex.ic.gov",e.USSec="hubblecontent.azureedge.microsoft.scloud",e.USSecCDN="hubblecontent.azureedge.microsoft.scloud"}(e||(e={}));var u,f=c(280),p=new RegExp(/(\%[0-9][A-F])|(\%[A-F][0-9])|(\%[A-F][A-F])/g),m=new RegExp(/(\%[0-9][a-f])|(\%[a-f][0-9])|(\%[a-f][a-f])/g);!function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative"}(u||(u={}));var _,h=function(){function e(e,t){void 0===e&&(e=""),t&&("/"===e[e.length-1]&&"/"===t[0]?e+=t.slice(1):"/"!==e[e.length-1]&&"/"!==t[0]?e=e+"/"+t:e+=t);var n=e.indexOf("//"),a=e.indexOf("/"),i=e.indexOf("?"),r=n>-1&&n<=a?n+"//".length:-1,o=function(e,t){if(t>-1){var n=e.indexOf("/",t);return n>-1?e.slice(0,n):e}return""}(e,r),s=o&&o.slice(r),c=s&&s.split(":")[0],d=i>0?e.slice(o.length,i):e.slice(o.length),l=o?u.absolute:"/"===d[0]?u.serverRelative:u.relative,f=d.split("/");this._originalSearchString=i>0?e.slice(i):"",this.searchParams=new URLSearchParams(this._originalSearchString),this.authority=o,this.domain=s,this.host=c,this.format=l,this.path=d,this.segments=f,this.value=e}return e._getTenantInfoFromPageContext=function(e){var t,n=null!==(t=null==e?void 0:e.legacyPageContext)&&void 0!==t?t:e,a=!s.KillSwitch.isActivated("78469d39-5abf-45a7-8609-c4f00dab856b");return e?{isMultiGeo:a?n.isMultiGeoTenant:e.legacyPageContext.isMultiGeoTenant,multiGeoInfo:a?n.multiGeoInfo:e.legacyPageContext.multiGeoInfo,singleTenant:a?n.vanityUrls:e.legacyPageContext.vanityUrls}:void 0},e._getHostFromUrl=function(t){return t?new e(t).domain:t},e._getMySiteAndPortalDomain=function(){var e="-my",t="-admin",n="".concat(window.location.protocol,"//").concat(window.location.hostname),a=window.location.hostname.substr(0,window.location.hostname.indexOf("."));if(s.KillSwitch.isActivated("751b021d-5b05-45f0-b649-d8fd0dab3170")||-1===a.indexOf(t))return-1===a.indexOf(e,a.length-e.length)?[n.toString().replace(a,a+e),n]:(i=n.toString().replace(a,a.substring(0,a.length-e.length)),[n,i]);var i,r=a.substring(0,a.length-t.length);return[n.toString().replace(a,r+e),i=n.toString().replace(a,r)]},e.prototype.toString=function(){return this.authority+this.path+this.searchParamString},e.prototype.equals=function(e){return e&&this.toString()===e.toString()},e.prototype.isInternalResource=function(t){var n=this,a=e._getTenantInfoFromPageContext(t);try{if((null==a?void 0:a.isMultiGeo)&&(null==a?void 0:a.multiGeoInfo))return a.multiGeoInfo.some(function(e){return n._isSameHost(e.PortalUrl)||n._isSameHost(e.MySiteHostUrl)||n._isSameHosts(e.AdditionalUrls)});var i=e._getMySiteAndPortalDomain();if(this._isSameHosts(i))return!0;if((null==a?void 0:a.singleTenant)&&(null==a?void 0:a.singleTenant.SingleTenant_AdditionalVanityUrls)&&-1!==a.singleTenant.SingleTenant_AdditionalVanityUrls.split(";").indexOf(this.domain))return!0;if((null==a?void 0:a.singleTenant)&&this._isInternalResourceOfSingleTenant(a.singleTenant))return!0}catch(e){return!1}return!1},e.prototype.setSearchParam=function(e,t){t?this.searchParams.set(e,decodeURIComponent(t.replace(/\+/g," "))):this.searchParams.set(e,t)},Object.defineProperty(e.prototype,"searchParamString",{get:function(){var e,t=null===(e=this.searchParams.toString())||void 0===e?void 0:e.replace(/\+/g,"%20");return t&&this._originalSearchString.match(m)&&(t=t.replace(p,function(e){return null==e?void 0:e.toLowerCase()})),t?"?"+t:t},enumerable:!1,configurable:!0}),e.prototype.getQueryParameter=function(e){var t;return null===(t=this.searchParams)||void 0===t?void 0:t.get(e)},e.prototype.removeQueryParameter=function(e){var t;null===(t=this.searchParams)||void 0===t||t.delete(e)},e.prototype._isInternalResourceOfSingleTenant=function(e){return e.SingleTenant_OneDriveUrl===this.domain||e.SingleTenant_PortalUrl===this.domain||e.SingleTenant_TeamSitesUrl===this.domain},e.prototype._isSameHost=function(t){return this.domain.toLowerCase()===e._getHostFromUrl(t).toLowerCase()},e.prototype._isSameHosts=function(e){var t=this;return!!(null==e?void 0:e.some(function(e){return t._isSameHost(e)}))},e}(),b=function(){function e(){}var t;return e.isHostApprovedForThumbnail=function(e){if(e.format!==u.absolute)return!0;var t=e.host.toLowerCase();if(this._allowListHosts.has(t)||this._allowListDomains.has(t))return!0;for(var n=0;n<this._allowListDomainsArray.length;n++)if(t.endsWith(this._allowListDomainsArray[n]))return!0;return!1},t=e,e._stockHostNamesArray=["modern.akamai.odsp.cdn.office.net","az741266.vo.msecnd.net","spoprod-a.akamaihd.net","spoppe-a.akamaihd.net","az742526.vo.msecnd.net","spoppe-b.akamaized.net","spoppe-b.azureedge.net","spoppe-b2.azureedge.net","modernb.akamai.odsp.cdn.office.net","modernb.verizon.odsp.cdn.office.net","res-1-sdf.cdn.office.net","res-2-sdf.cdn.office.net","res-1.cdn.office.net","res-2.cdn.office.net","res.cdn.office.net","res-sdf.cdn.office.net","res-1.df.onecdn.static.microsoft","res-2.df.onecdn.static.microsoft","res.df.onecdn.static.microsoft","res-2.public.onecdn.static.microsoft","res-1.public.onecdn.static.microsoft","res.public.onecdn.static.microsoft","odspwebcidev.z13.web.core.windows.net","odspwebuserdev.z1.web.core.windows.net"],e.STOCK_HOST_NAMES=new Set(t._stockHostNamesArray),e._allowListDomainsArray=["1drv.com","1drv-int.com","livefilestore.com","onedrive.com","protection.office.com","protection.office.de","scc.office365.us","compliance.microsoft.us","security.microsoft.us","scc.protection.apps.mil","compliance.apps.mil","security.apps.mil","scc.eaglex.ic.gov","compliance.eaglex.ic.gov","security.eaglex.ic.gov","scc.microsoft.scloud","compliance.microsoft.scloud","security.microsoft.scloud","scc.microsoftonline.cn","compliance.microsoftonline.cn","security.microsoftonline.cn","odsp.microsoft.scloud","microsoft.eaglex.ic.gov","spo.eaglex.ic.gov","spo.microsoft.scloud","microsoft.scloud","sharepoint.com","sharepoint-df.com","sharepointonline.com","spoppe.com","storage.live.com","yammer.com","yammer.dev","microsoft.com"],e._allowListDomains=new Set(t._allowListDomainsArray),e._allowListHosts=new Set((0,f.__spreadArray)((0,f.__spreadArray)([],t._stockHostNamesArray,!0),["filevilleprod.blob.core.windows.net","filevillebackupprod.blob.core.windows.net","filevillestaging.blob.core.windows.net","filevillebackupstaging.blob.core.windows.net","mediatestfiles.blob.core.windows.net","metastoragecentralus.blob.core.windows.net","yameufileville.blob.core.windows.net","outlook.live.com","outlook.office.com","outlook-sdf.office.com","exchangelabs.live-int.com","attachment.outlook.live.net","attachment.outlook.office.net","attachments.office.net","attachments-sdf.office.net","attachments.office365-net.cn","attachments.office365-net.de","attachments.office365-net.us","attachments-dod.office365-net.us","media.akamai.odsp.cdn.office.net","cdn.hubblecontent.osi.office.net","static2.azure.odsp.microsoft.scloud","static2.azure.odsp.microsoft.eaglex.ic.gov","modern.azure.odsp.microsoft.scloud","modern.azure.odsp.microsoft.eaglex.ic.gov","hubblecontent.azureedge.microsoft.scloud","hubblecontent.azureedge.eaglex.ic.gov","scc.protection.apps.mil","scc.eaglex.ic.gov","compliance.eaglex.ic.gov","security.eaglex.ic.gov","wus2.proxyservice.ediscovery.office365.com","wus.proxyservice.ediscovery.office365.com","eus.proxyservice.ediscovery.office365.com","cus.proxyservice.ediscovery.office365.com","ncus.proxyservice.ediscovery.office365.com","scus.proxyservice.ediscovery.office365.com","weur.proxyservice.ediscovery.office365.com","seas.proxyservice.ediscovery.office365.com","gcc.proxyservice.ediscovery.office365.com","gcch.proxyservice.ediscovery.office365.us","dod.proxyservice.ediscovery.office365.us"],!1)),e}();!function(e){e[e.Unknown=0]="Unknown",e[e.PrivateCDN=1]="PrivateCDN",e[e.AFDPrivateCDN=2]="AFDPrivateCDN",e[e.DocViz=3]="DocViz",e[e.MeTA=4]="MeTA",e[e.MySite=5]="MySite",e[e.Original=6]="Original",e[e.SharePointHost=7]="SharePointHost",e[e.Stock=8]="Stock",e[e.VROOMMeTACache=9]="VROOMMeTACache",e[e.PublicCDN=10]="PublicCDN",e[e.AFDPublicCDN=11]="AFDPublicCDN",e[e.External=12]="External",e[e.MediaCDNDefault=13]="MediaCDNDefault",e[e.MediaCDNHubble=14]="MediaCDNHubble",e[e.HubbleStock=15]="HubbleStock",e[e.HubbleStockThumbnail=16]="HubbleStockThumbnail",e[e.SPOLayoutsImage=17]="SPOLayoutsImage",e[e.MediaCDNLayoutsImage=18]="MediaCDNLayoutsImage",e[e.MediaCDNOptimalLayoutsImage=19]="MediaCDNOptimalLayoutsImage"}(_||(_={}));var g=/(\/thumbnails\/\d\/(.*?)\/content\/?(|(\?(.*?)))$)/i,v=/(.svc.ms\/transform\/thumbnail\/?(|(\?(.*?)))$)/i,y=/(privatecdn(.*?).sharepointonline.com\/(.*?)\?(.*?)(_oat_=(.*?)|AuthVer=2)(.*?)$)/i,S=/(publiccdn(.*?).sharepointonline.com\/(.*?)$)/i,D=/(public-cdn(.*?).sharepointonline.com\/(.*?)$)/i,I=/(\/_vti_bin\/afdcache.ashx\/?(|(\/(.*?)))$)/i,x=/(\/_layouts\/15\/getpreview.ashx\/?(|(\?(.*?)))$)/i,C="media.akamai.odsp.cdn.office.net",O="cdn.hubblecontent.osi.office.net";function w(e){return!!e&&e.toLowerCase().indexOf("_layouts/15/images/")>-1}function E(t){var n;return function(t,n){var a=t.env2;return function(e){return"ag08"===e}(a)?e.USNat:function(e){return"ag09"===e}(a)?e.USSec:e.PublicCDN}(null!==(n=null==t?void 0:t.legacyPageContext)&&void 0!==n?n:t)}var A=function(){function e(){}return e.hasThumbnailOrFileTypeSupportsPreview=function(e,t){return!!t||!!e&&j.getPreviewSupportedMap.has(e.toLowerCase())},e.getPreviewImageUrl=function(t,n,a,r,o,s,c,d,l,u,f,p){!l&&F.instance.isVROOMThumbnailEnabled()&&new i._QosMonitor("DocVizCaller").writeSuccess({service:u||"unknown"});var m=j.normalizeWidthToResolution(d);return e._generateGetPreviewImageUrl(t,a,r,o,s,c,m,l,f,p)},e._generateGetPreviewImageUrl=function(n,a,i,o,s,c,d,l,f,p){if(i){var m=new h(i);m.format===u.absolute&&(a=m.authority,i=m.path),i.indexOf("/")>=0&&(i=encodeURIComponent(i))}var _=a&&a.length?new h(a):void 0,b=a&&a.length?new h(null==_?void 0:_.authority,e.PREVIEW_HANDLER_PATH):new h(e.PREVIEW_HANDLER_PATH);void 0===d||isNaN(d)||b.searchParams.set(e.RESOLUTION,d.toString());var g=r.Guid.tryParse(o),v=r.Guid.tryParse(s),y=r.Guid.tryParse(c),S="True"===t.tryGetAlternativeUrl("PrivateCDNEnabled"),D=g&&v&&y&&!B.has(c)&&!B.has(s)&&!B.has(o),I=S&&l&&!!i&&b.toString().length+encodeURIComponent(i).length<=255,x=!1;if(D&&!I)b.searchParams.set(e.GUID_SITE,g.toString().replace(/-/g,"")),b.searchParams.set(e.GUID_WEB,v.toString().replace(/-/g,"")),b.searchParams.set(e.GUID_FILE,y.toString().replace(/-/g,""));else{if(!i)return;b.setSearchParam(e.PATH,i),x=!0}return l||b.searchParams.set(j.CLIENT_TYPE,j.MODERN_WEB_PART),l&&n&&!x&&(b.searchParams.set(e.EXT,n),b.toString().length>=255&&b.searchParams.delete(e.EXT)),l&&f&&p&&(b.searchParams.set(e.ORIGINAL_WIDTH,f.toString()),b.searchParams.set(e.ORIGINAL_HEIGHT,p.toString()),b.toString().length>=255&&(b.searchParams.delete(e.ORIGINAL_WIDTH),b.searchParams.delete(e.ORIGINAL_HEIGHT))),b.toString()},e.RESOLUTION="resolution",e.GUID_SITE="guidSite",e.GUID_WEB="guidWeb",e.GUID_FILE="guidFile",e.PATH="path",e.EXT="ext",e.ORIGINAL_WIDTH="ow",e.ORIGINAL_HEIGHT="oh",e.WIDTH="width",e.WIDTH_SHORT="w",e.HEIGHT_SHORT="h",e.VIEWPORT_LEFT="vl",e.VIEWPORT_TOP="vt",e.VIEWPORT_WIDTH="vw",e.VIEWPORT_HEIGHT="vh",e.CALLER_STACK="cs",e.INPUT_FORMAT="inputFormat",e.DOCID="docid",e.PREVIEW_HANDLER_PATH="/_layouts/15/getpreview.ashx",e.VIDEO_EXTENSIONS=["mts","m2ts","ts","3g2","3gp","3gp2","3gpp","asf","wmv","avi","m4v","mov","mp4","mp4v","ogg","webm","movie","mkv","mpg","mpeg","flv","vob","mod"],e.IMAGE_EXTENSIONS=["gif","jpg","jpeg","bmp","dib","tif","tiff","ico","png","jxr","svg"],e}();function L(){return r._SPKillSwitch.isActivated("a7860782-db85-42fc-b1dc-dfb0abaafc97")}function k(){return r._SPKillSwitch.isActivated("f82624b3-0b57-488e-aa1e-4e164321b4e2")}var M=/(\/_layouts\/15\/getpreview.ashx\/?(|(\?(.*?)))$)/i,P="MediaTAThumbnailHostUrl",T="https://".concat("media.akamai.odsp.cdn.office.net"),U=["ag08","ag09"],F=function(){function e(){var e=this;this._initialize=function(n){var a,i;e._pageContext=e._serviceScope.consume(o.PageContext.serviceKey);var s=e._pageContext,c=(null==s?void 0:s.legacyPageContext)||(null==s?void 0:s._legacyPageContext);if(c){var d=t.getUrlTable();c.MediaTAServiceHostUrl&&!d.MediaTAThumbnailHostUrl&&(d.MediaTAThumbnailHostUrl=c.MediaTAServiceHostUrl),c.userPhotoCdnBaseUrl&&!d.UserPhotoAspx&&(d.UserPhotoAspx=c.userPhotoCdnBaseUrl)}!r._SPKillSwitch.isActivated("9748ceb6-d312-4141-9733-b29ac48f8bcd")&&(null===(i=null===(a=null==n?void 0:n.page)||void 0===a?void 0:a.Content)||void 0===i?void 0:i.AlternativeUrlMap)&&t.updateMap(n.page.Content.AlternativeUrlMap)},this._logSource=i._LogSource.create("ThumbnailUrlGenerator")}return e._isFileTypeSupportedByMediaService=function(e){return r._SPKillSwitch.isActivated("991c0e1c-05b0-4ecb-af32-6eefb92fe9d7")||(j.mediaServiceSupportedMap.delete("svg"),j.mediaServiceSupportedMap.delete("svgz")),!!e&&j.mediaServiceSupportedMap.has(e.toLowerCase())},e._getMediaSupportFileType=function(t,n){var a=t||j.getFileExtension(n);return e._isFileTypeSupportedByMediaService(a)?a:"jpg"},e._isViewportNumberValid=function(e){return void 0!==e&&!isNaN(e)},e._replaceQueryValue=function(e,t,n){return void 0!==n?e.setSearchParam(t,n.toString()):e.searchParams.delete(t),e.toString()},e._getSPResourceAuthority=function(e){var t=new h(e.absoluteUrl||location.href);if(e.spResource){var n=new h(e.spResource);return n.format===u.relative||n.format===u.serverRelative?t:new h(n.authority)}return t},Object.defineProperty(e,"instance",{get:function(){return void 0===this._instance&&(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t){var n=this;this._serviceScope||(this._serviceScope=e,this._serviceScope.whenFinished(function(){return n._initialize(t)})),t&&void 0!==t.MediaTAForThumbnail&&(this._mediaTAForThumbnailEnabled=!!t.MediaTAForThumbnail)},e.prototype.isFileTypeSupported=function(t){if(!t)return!1;var n=t.toLowerCase();return"svg"!==n&&(j.getPreviewSupportedMap.has(n)||this.isVROOMThumbnailEnabled()&&(e._isFileTypeSupportedByMediaService(n)||"aspx"===n))},e.prototype.getUserPhotoUrl=function(e,n){return void 0===n&&(n=t.UserPhotoSize.Small),t.getUserPhotoUrl(e,n)},e.prototype.getThumbnailUrl=function(e,n){if(!e)throw new Error("Input parameter request is ".concat(e));if(e.unknownThumbnailUrl)return this._fromUnknownThumbnailUrl(e,n);e.spResource&&(e.spResource=this._pruneShareUrl(e.spResource));var a,i=this._isViewportParametersSpecified(e);if(!i){var r=this._getPreLoadedImage(e);if(r)return r}if(i&&e.originalWidth&&e.originalHeight&&(e.viewportWidth=Math.min(e.viewportWidth,e.originalWidth-e.viewportLeft),e.viewportHeight=Math.min(e.viewportHeight,e.originalHeight-e.viewportTop)),e.spResource)switch(a=this.getThumbnailProvider(e.spResource,!!n)){case _.DocViz:return this.fromGetPreview(e.spResource,e.callerId,e.width);case _.PrivateCDN:case _.AFDPrivateCDN:if(!e.nonExpiring&&t.isAlterantiveUrlFresh(e.spResource))return this.updateThumbnailWidth(e.spResource,e.width,a);e.spResource=this._getPathFromOptimalUrl(a,e.spResource),a=_.SharePointHost;break;case _.MeTA:case _.VROOMMeTACache:case _.PublicCDN:case _.AFDPublicCDN:case _.MediaCDNDefault:case _.MediaCDNHubble:case _.MediaCDNOptimalLayoutsImage:return this.updateThumbnailWidth(e.spResource,e.width,a);case _.External:case _.MediaCDNLayoutsImage:return this._getPublicCDNMeTAUrl(e.spResource,e,a);case _.HubbleStockThumbnail:return this._updateHubbleThumbnailWidth(e);case _.HubbleStock:return this._getPublicCDNMeTAUrl(e.spResource,e,a);case _.SPOLayoutsImage:return this._getPublicCDNMeTAUrl(this._rewriteOptimalLayoutsImageUrl(e),e,_.MediaCDNLayoutsImage)}if(n||a===_.Stock)return this._getPublicCDNMeTAUrl(n||e.spResource,e,a);if(this._isLayoutsPath(e.spResource))return e.spResource;var o=!1;if(e.fileType&&(o="aspx"===e.fileType.toLowerCase()),e.thumbnail&&!o)return e.thumbnail;var s=this.getCDNUrl(e);return s||(this.getVROOMThumbnailUrl(e,a)||this.getDocVizUrl(e,a)||e.spResource)},Object.defineProperty(e.prototype,"publicCDNBaseUrl",{get:function(){var e,t;return null===(t=null===(e=this._pageContext)||void 0===e?void 0:e.legacyPageContext)||void 0===t?void 0:t.publicCdnBaseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAirGap",{get:function(){var e,t=(null===(e=this._pageContext)||void 0===e?void 0:e.legacyPageContext).cloudType;return!!t&&U.includes(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaCDNBaseUrl",{get:function(){return T},enumerable:!1,configurable:!0}),e.prototype.getVROOMThumbnailUrl=function(t,a){if(!t)throw new Error("Input parameter request is ".concat(t));var i,o=!!t.fileType&&"aspx"===t.fileType.toLowerCase(),s=t.spResource;if(s){if((a=a||t.spResource&&this.getThumbnailProvider(t.spResource))===_.VROOMMeTACache)return j.updateVROOMCustomThumbnailSize(t.spResource,t.width);switch(a){case _.MeTA:s=void 0;break;case _.PrivateCDN:case _.PublicCDN:case _.AFDPublicCDN:var c=new h(t.spResource);s=(s="https:/".concat(c.path)).split("?")[0];break;case _.AFDPrivateCDN:var d=new h(t.spResource);s=(s="".concat(d.authority).concat(d.path.substr("/_vti_bin/afdcache.ashx/authitem".length))).split("?")[0];break;case _.SharePointHost:case _.MySite:s=t.spResource;break;case _.External:case _.Stock:case _.HubbleStock:case _.HubbleStockThumbnail:case _.SPOLayoutsImage:case _.MediaCDNDefault:case _.MediaCDNHubble:default:s=void 0}new h(s).format===u.absolute&&(i=new h(s))}var l=!t.fileType,f=this._isViewportParametersSpecified(t);if((o||e._isFileTypeSupportedByMediaService(t.fileType)||l)&&this.isVROOMThumbnailEnabled()&&!r._SPKillSwitch.isActivated("318c1916-4594-4509-8ab7-cdb100182007")){i=i||e._getSPResourceAuthority(t);var p=j.getVROOMItemUrl(t.siteId,t.webId,t.listId,t.uniqueId,i.authority,i.host,s),m=t.cropMode&&t.cropMode!==n.Default;if(f||m)return j.getVROOMThumbnailUrl(p,t.width,t.height,t.cacheBuster,void 0,t.originalWidth,t.originalHeight,t.cropMode,t.viewportTop,t.viewportLeft,t.viewportWidth,t.viewportHeight);var b=j._optimizableFormats.get(t.fileType),g=r._SPKillSwitch.isActivated("8a1a5f98-061b-4883-a3e6-8e78abb9687a")||!b||b()?void 0:j.CURRENT_OPTIMIZED_FORMAT;return r._SPKillSwitch.isActivated("48d6a25f-6c1d-46b5-a8c9-63fa0a7cfd41")?j.getVROOMThumbnailUrl(p,t.width,t.height,t.cacheBuster,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,g):j.getVROOMThumbnailUrl(p,t.width,t.height,t.cacheBuster,void 0,t.originalWidth,t.originalHeight,void 0,void 0,void 0,void 0,void 0,g)}},e.prototype.getCDNUrl=function(e){if(!e)throw new Error("Input parameter request is ".concat(e));if(e.spResource&&!e.nonExpiring){var t=j.getAlternateUrl(new h(e.spResource),e.width,e.height,e.originalWidth,e.originalHeight,e.cropMode,e.viewportTop,e.viewportLeft,e.viewportWidth,e.viewportHeight,e.cacheBuster);return!r._SPKillSwitch.isActivated("274b374a-7c11-418b-95d9-5723d02ed147")&&this._shouldAddCacheBuster(t,e)?this._addCacheBuster(t,e.cacheBuster):t}},e.prototype.getDocVizUrl=function(e,t){if(!e)throw new Error("Input parameter request is ".concat(e));if(e.spResource&&(e.spResource=this._getPathFromOptimalUrl(t||this.getThumbnailProvider(e.spResource),e.spResource)),!r._SPKillSwitch.isActivated("67d7e188-b33c-4fc2-8862-a072c6d8afb4")&&this.isFileTypeSupported(e.fileType))return this._fallbackToGetPreview(e)},e.prototype.updateThumbnailWidth=function(t,n,a){if(!t||void 0===n||isNaN(n)||n<=0)return t;var r=j.normalizeWidth(n),o=new h(t);if(o.searchParams.has(A.WIDTH_SHORT))return e._replaceQueryValue(o,A.WIDTH_SHORT,r);if(o.searchParams.has(A.WIDTH))return e._replaceQueryValue(o,A.WIDTH,r);if(o.searchParams.has(A.RESOLUTION))return e._replaceQueryValue(o,A.RESOLUTION,j.normalizeWidthToResolution(n));switch(a=a||this.getThumbnailProvider(t)){case _.External:return t;case _.VROOMMeTACache:return j.updateVROOMCustomThumbnailSize(t,n);case _.PrivateCDN:case _.PublicCDN:case _.AFDPublicCDN:case _.AFDPrivateCDN:case _.MediaCDNDefault:case _.MediaCDNHubble:case _.MeTA:return"".concat(t).concat(-1===t.indexOf("?")?"?":"&").concat(A.WIDTH,"=").concat(r);case _.DocViz:return"".concat(t,"&").concat(A.RESOLUTION,"=").concat(j.normalizeWidthToResolution(n));case _.HubbleStockThumbnail:return this._updateHubbleThumbnailWidth({spResource:t,width:n,absoluteUrl:"",callerId:"updateWidth"});case _.SharePointHost:case _.MySite:if(this.isFileTypeSupported(j.getFileExtension(new h(t))))return"".concat(t).concat(-1===t.indexOf("?")?"?":"&").concat(A.WIDTH,"=").concat(r)}return i._TraceLogger.logError(this._logSource,new Error("Could not add width to the URL"),"updateThumbnailWidth"),t},e.prototype.getThumbnailWidth=function(e,t){if(""!==e)try{var n=new h(e);if(n.searchParams.has(A.WIDTH_SHORT))return Number(n.searchParams.get(A.WIDTH_SHORT));if(n.searchParams.has(A.WIDTH))return Number(n.searchParams.get(A.WIDTH));if(n.searchParams.has(A.RESOLUTION))return j.getWidthByResolution(Number(n.searchParams.get(A.RESOLUTION)));switch(t=t||this.getThumbnailProvider(e)){case _.External:return;case _.VROOMMeTACache:return j.getVROOMThumbnailWidth(e);case _.PrivateCDN:case _.PublicCDN:case _.AFDPublicCDN:case _.AFDPrivateCDN:case _.MediaCDNDefault:case _.MediaCDNHubble:case _.MeTA:return 0;case _.DocViz:return 300;case _.SharePointHost:case _.MySite:case _.Stock:return 0;case _.HubbleStockThumbnail:return 300}i._TraceLogger.logError(this._logSource,new Error("Could not find for given URL"),"getThumbnailWidth")}catch(e){}},e.prototype.getThumbnailProvider=function(e,t){return function(e,t,n){var a,i;if(!e)return _.Unknown;var r=new h(e),o=!s.KillSwitch.isActivated("2b63be7f-b012-4d7a-bc70-1b3806db5285","2/8/2024","matchAFDPublicCDNUrl");if(t||0===e.indexOf("/_LAYOUTS/IMAGES/"))return(null===(a=r.host)||void 0===a?void 0:a.toLowerCase())===C?_.MediaCDNDefault:_.Stock;if(l()?r.host===E(n):r.host===O)return r.searchParams.has("file")&&r.path.indexOf("/thumbnails/")>0?_.HubbleStockThumbnail:_.HubbleStock;if(b.STOCK_HOST_NAMES.has(r.host))return _.Stock;if(g.test(e))return _.VROOMMeTACache;if((null===(i=r.host)||void 0===i?void 0:i.toLowerCase())===C){var c=r.getQueryParameter("docid");return c?(null==c?void 0:c.indexOf(l()?E(n):O))>-1?_.MediaCDNHubble:w(c)?_.MediaCDNOptimalLayoutsImage:_.MediaCDNDefault:_.MediaCDNLayoutsImage}if(v.test(e))return _.MeTA;if(y.test(e))return _.PrivateCDN;if(S.test(e))return _.PublicCDN;if(o&&D.test(e))return _.AFDPublicCDN;if(I.test(e))return _.AFDPrivateCDN;if(x.test(e))return _.DocViz;if(w(e))return _.SPOLayoutsImage;var d=new h(window.location.href);if(function(e,t){var n="-my.",a=e.domain.toLowerCase();return a.indexOf(n)>-1&&a.replace(n,".")===t.domain.toLowerCase()}(r,d))return _.MySite;var f=r.host||"",p=d.host.toLowerCase();return f.toLowerCase()===p||r.format!==u.absolute?_.SharePointHost:r.format===u.absolute&&n?r.isInternalResource(n)?_.SharePointHost:_.External:_.Unknown}(e,t,this._pageContext)},e.prototype.isCdnUrl=function(e){var t=this.getThumbnailProvider(e);return t===_.PrivateCDN||t===_.PublicCDN||t===_.AFDPublicCDN||t===_.AFDPrivateCDN},e.prototype.fromGetPreview=function(e,t,n){if(void 0===n&&(n=400),e&&M.test(e)){var a=new h(e),i=a.authority;(!i||i.length<5)&&(i=new h(window.location.href).authority);var r={fileType:a.searchParams.get(A.EXT)||void 0,absoluteUrl:i,spResource:a.searchParams.get(A.PATH)||void 0,siteId:a.searchParams.get(A.GUID_SITE)||void 0,webId:a.searchParams.get(A.GUID_WEB)||void 0,uniqueId:a.searchParams.get(A.GUID_FILE)||void 0,width:n,callerId:t};if(!r.fileType&&r.spResource){var o=new h(r.spResource);r.fileType=j.getFileExtension(o)}return this.getThumbnailUrl(r)||e}},e.prototype.isVROOMThumbnailEnabled=function(){return!r._SPKillSwitch.isActivated("aaa0d161-5c00-4be4-98d2-7147c13548fc")||!!this._mediaTAForThumbnailEnabled},e.prototype._pruneShareUrl=function(e){return e.replace(/\/:\w:\/\w/,"")},e.prototype._fromUnknownThumbnailUrl=function(e,t){var n=this.getThumbnailProvider(e.unknownThumbnailUrl,!!t);switch(n){case _.DocViz:return this.fromGetPreview(e.unknownThumbnailUrl,e.callerId,e.width);case _.MeTA:case _.VROOMMeTACache:case _.PrivateCDN:case _.PublicCDN:case _.AFDPublicCDN:case _.AFDPrivateCDN:case _.MediaCDNDefault:case _.MediaCDNHubble:return this.updateThumbnailWidth(e.unknownThumbnailUrl,e.width,n);case _.SharePointHost:case _.MySite:case _.HubbleStock:case _.HubbleStockThumbnail:case _.Stock:case _.SPOLayoutsImage:return e.spResource||(e.spResource=e.unknownThumbnailUrl),e.unknownThumbnailUrl=void 0,this.getThumbnailUrl(e,t);case _.Unknown:default:return e.unknownThumbnailUrl}},e.prototype._isViewportParametersSpecified=function(t){return e._isViewportNumberValid(t.viewportHeight)&&e._isViewportNumberValid(t.viewportWidth)&&e._isViewportNumberValid(t.viewportTop)&&e._isViewportNumberValid(t.viewportLeft)},e.prototype._fallbackToGetPreview=function(e){return A.getPreviewImageUrl(e.fileType,e.thumbnail,e.absoluteUrl,e.spResource,e.siteId,e.webId,e.uniqueId,e.width,!1,e.callerId)},e.prototype._getPreLoadedImage=function(e){var t=void 0;if(e&&e.spResource){var n=this._getPreloadedDictionary();if(n&&!(t=this._readUrlFromDictionary(n,e.spResource))){var a=new h(e.spResource).path;a&&(t=this._readUrlFromDictionary(n,a))}}if(r._SPFlight.isEnabled(1994)&&t){var i=t.split("?");if(i[1]&&i[1].indexOf("AuthVer=")>-1)return e.width=Math.max(this.getThumbnailWidth(t,_.PrivateCDN),e.width),this.getCDNUrl(e)}return this._shouldAddCacheBuster(t,e)&&(t=this._addCacheBuster(t,e.cacheBuster)),this._validateResolution(t,e)?t:void 0},e.prototype._shouldAddCacheBuster=function(e,t){return t.cacheBuster&&e&&-1===e.indexOf(t.cacheBuster)},e.prototype._addCacheBuster=function(e,t){var n=new URL(e);return n.searchParams.set("cb",t),n.toString()},e.prototype._getPreloadedDictionary=function(){var e=window._preloadImages;if(e&&!this._isDecodedKeyAdded)for(var t in this._isDecodedKeyAdded=!0,e)if(t){var n=void 0;try{n=decodeURIComponent(t)}catch(e){n=t}n!==t&&(e[n]=e[t])}return e},e.prototype._getPublicCDNMeTAUrl=function(a,i,o){if(this.mediaCDNBaseUrl){var s=new h(a);if(!b.isHostApprovedForThumbnail(s)){if(this.isAirGap||!i.optimizePublicImage)return a;a=this._rewriteOptimalImageUrl(a)}if(!r._SPKillSwitch.isActivated("bce5c76e-ffe1-4221-ad00-c8e89952a1b9")&&"svg"===(i.fileType||j.getFileExtension(s)))return a;if(t.tryGetAlternativeUrl(P)){var c=i.width?j.normalizeWidth(i.width,!0):R,d=e._getMediaSupportFileType(i.fileType,s),l=new h(t.tryGetAlternativeUrl(P)),u=this.isAirGap?l.authority:"".concat(this.mediaCDNBaseUrl,"/").concat(l.domain),f="".concat(u,"/transform/thumbnail?provider=url&inputFormat=").concat(d,"&docid=").concat(encodeURIComponent(a),"&w=").concat(c),p=!!i.height&&!!i.cropMode&&i.cropMode!==n.Default,m=this._isViewportParametersSpecified(i);return p?f="".concat(f,"&h=").concat(i.height,"&cm=").concat(i.cropMode):i.height&&(f="".concat(f,"&h=").concat(i.height)),m&&(f="".concat(f,"&vl=").concat(i.viewportLeft,"&vt=").concat(i.viewportTop,"&vw=").concat(i.viewportWidth,"&vh=").concat(i.viewportHeight)),f}}return a},e.prototype._validateResolution=function(e,t){if(!e)return!1;if(!t.width)return!0;var n=new h(e).searchParams.get("resolution")||void 0;if(n){var a=j.normalizeWidthToResolution(t.width),i=Number(n);return this._validateImageProperty(a,i,"Resolution",t.callerId)}var r=this.getThumbnailWidth(e);if(r){var o=j.normalizeWidth(t.width);return this._validateImageProperty(o,r,"Width",t.callerId)}return!0},e.prototype._validateImageProperty=function(e,t,n,a){var r="ImagePreload",o=void 0;return void 0===e?o="".concat(r).concat(n,"Missing"):!isNaN(t)&&e>t&&(o="".concat(r).concat(n,"Mismatch")),o&&new i._QosMonitor("ImagePreloadMismatch").writeUnexpectedFailure(o),!o},e.prototype._readUrlFromDictionary=function(e,t){try{return e[t]||e[decodeURIComponent(t)]}catch(e){return}},e.prototype._isLayoutsPath=function(e){return!!e&&e.toLowerCase().indexOf("/_layouts/15/")>-1},e.prototype._rewriteOptimalLayoutsImageUrl=function(e){var t=e.spResource.toLowerCase(),n=new h(t);if(n.format!==u.absolute){var a=new h(e.absoluteUrl||location.href),i=t.substring(t.indexOf("/_layouts/15/"));return this.isAirGap?s.Uri.concatenate(a.authority,i):s.Uri.concatenate(this.mediaCDNBaseUrl,a.domain,i)}return i=n.path.substring(n.path.indexOf("/_layouts/15/")),this.isAirGap?s.Uri.concatenate(n.authority,i):s.Uri.concatenate(this.mediaCDNBaseUrl,n.domain,i)},e.prototype._rewriteOptimalImageUrl=function(e){if(this.isAirGap)return e;var t=new h(e);return t.format!==u.absolute?e:s.Uri.concatenate(this.mediaCDNBaseUrl,t.domain,t.path)+t.searchParamString},e.prototype._getPathFromOptimalUrl=function(e,t){var n=new h(t),a=t;if(e===_.PrivateCDN||e===_.PublicCDN||e===_.AFDPublicCDN||e===_.MediaCDNLayoutsImage)a=(a="https:/".concat(n.path)).split("?")[0];else if(e===_.AFDPrivateCDN)a=(a="".concat(n.authority).concat(n.path.substr("/_vti_bin/afdcache.ashx/authitem".length))).split("?")[0];else if(e===_.VROOMMeTACache){var i="/sharepoint:/",r="/shares/u!",o="/driveitem/thumbnails/",s=":".concat(o),c=t.toLowerCase(),d=-1===(u=c.indexOf(i))?-1:c.indexOf(s);u>-1&&d>-1?a=t.substring(u+i.length-1,d):(d=-1===(u=c.indexOf(r))?-1:c.indexOf(o),u>-1&&d>-1&&(a=decodeURIComponent(escape(atob(t.substring(u+r.length,d))))))}else if(e===_.MediaCDNDefault||e===_.MediaCDNHubble)a=decodeURIComponent(n.getQueryParameter("docid"));else if(e===_.DocViz){var l=n.getQueryParameter("path");if(l){a=l="/"===(l=decodeURIComponent(l))[0]?l:"/".concat(l);var u,f=n.path.split("/_layouts/15/")[0];f.length>0&&(-1===(u=l.indexOf(f))||u>1)&&(a="".concat(f).concat(l))}}return a},e.prototype._updateHubbleThumbnailWidth=function(e){if(e.width<=300||!t.tryGetAlternativeUrl(P))return e.spResource;var n=new h(e.spResource),a="".concat(e.spResource.split("/thumbnails/")[0],"/").concat(n.getQueryParameter("file"));return this._getPublicCDNMeTAUrl(a,e,_.HubbleStockThumbnail)},e}();const H=F.instance;var R=400,N=2560,B=(new Set).add("00000000-0000-0000-0000-000000000000").add("00000000000000000000000000000000").add("{00000000-0000-0000-0000-000000000000}").add("{00000000000000000000000000000000}"),j=function(){function e(){}return Object.defineProperty(e,"smallestBreakPointWidth",{get:function(){return R},enumerable:!1,configurable:!0}),Object.defineProperty(e,"getPreviewSupportedMap",{get:function(){return e._getPreviewSupportedMap},enumerable:!1,configurable:!0}),e.getAlternateUrl=function(n,a,i,o,s,c,d,l,u,f,p){if(!r._SPKillSwitch.isActivated("c2151f9e-ff03-4fa5-8852-10f75e817d4e")){var m=t.tryGetAlternativeUrl(n.value)||t.tryGetAlternativeUrl(encodeURI(n.value));if(!m)try{m=t.tryGetAlternativeUrl(decodeURI(n.value))}catch(e){}if(!m&&n.authority){var _=n.path;if(!(m=t.tryGetAlternativeUrl(_)||t.tryGetAlternativeUrl(encodeURI(_))))try{m=t.tryGetAlternativeUrl(decodeURI(_))}catch(e){}}if(m&&void 0!==a&&!isNaN(a)&&H.isFileTypeSupported(e.getFileExtension(n))){var b=new h(m);if((void 0===i||isNaN(i))&&(a=e.normalizeWidth(a)),void 0!==a&&b.searchParams.set("width",Math.round(a).toString()),void 0!==i&&!isNaN(i)){var g=e.normalizeHeight(i);void 0!==g&&b.searchParams.set("height",g.toString())}void 0!==d&&void 0!==l&&void 0!==u&&void 0!==f&&(b.searchParams.set("vl",l.toString()),b.searchParams.set("vt",d.toString()),b.searchParams.set("vw",u.toString()),b.searchParams.set("vh",f.toString())),void 0!==c&&b.searchParams.set("cm",c),void 0!==o&&void 0!==s&&(b.searchParams.set("ow",o.toString()),b.searchParams.set("oh",s.toString()));var v=e._optimizableFormats.get(e.getFileExtension(n));v&&!v()&&b.searchParams.set("preferOptimized",(!0).toString()),p&&b.searchParams.set("cb",p),m=b.toString()}return m}},e.normalizeWidth=function(t,n){return void 0===n&&(n=!1),e._getWidthByMeTACache(e.scaleByPixelRatio(t),n)},e.normalizeHeight=function(e){return e?Math.round(e):void 0},e.normalizeWidthToResolution=function(t){return e._widthToResolution(e.scaleByPixelRatio(t))},e.isImage=function(t){return e._imageExtensions||(e._imageExtensions={},e._createLookupEntries(A.IMAGE_EXTENSIONS,e._imageExtensions)),!!t&&!!e._imageExtensions[t.toLowerCase()]},e.isVideo=function(t){return e._videoExtensions||(e._videoExtensions={},e._createLookupEntries(A.VIDEO_EXTENSIONS,e._videoExtensions)),!!t&&!!e._videoExtensions[t.toLowerCase()]},e.scaleByPixelRatio=function(t){return t?Math.round(t*e.getClampedDevicePixelRatio()):t},e.getClampedDevicePixelRatio=function(){var e,t=1;return r._SPFlight.isEnabled(1941)&&(t=Math.min(Math.max(null!==(e=window.devicePixelRatio)&&void 0!==e?e:1,1),2)),isNaN(t)?1:t},e.getVROOMThumbnailUrl=function(t,n,a,i,r,o,s,c,d,l,u,f,p){var m,_,h=99999,b=this.normalizeDimension(n,a,r);if(t){b.width||b.height?(m=b.width||h,_=b.height||h):(m=e.smallestBreakPointWidth,_=h);var g=void 0!==l&&void 0!==d&&void 0!==u&&void 0!==f?"&".concat("vl","=").concat(l,"&").concat("vt","=").concat(d,"&").concat("vw","=").concat(u,"&").concat("vh","=").concat(f):"",v=void 0!==n&&void 0!==a&&void 0!==c?"&".concat("cm","=").concat(c):"",y=void 0!==o&&void 0!==s?"&".concat("ow","=").concat(o,"&").concat("oh","=").concat(s):"",S=void 0!==i?"&".concat("cb","=").concat(i):"",D=void 0!==p?"&".concat(e.VROOM_FORMAT,"=").concat(p):"";return"".concat(t,"/thumbnails/0/c").concat(m,"x").concat(_,"/content?").concat(e.PREFER,"=").concat(e.NO_REDIRECT,",").concat(e.EXTEND_CACHE_MAXAGE,"&").concat(e.CLIENT_TYPE,"=").concat(e.MODERN_WEB_PART).concat(g).concat(v).concat(y).concat(S).concat(D)}},e.getVROOMItemUrl=function(e,t,n,o,s,c,d,l){var f;if(!(s&&c&&e&&t&&n&&o)||B.has(o)||B.has(e)||B.has(n)||B.has(t)){if(s&&c&&e&&t&&o&&!B.has(o)&&!B.has(e)&&!B.has(t))f=(f=(f=(f="{.spHost}/_api/v2.1/sites/{DomainName},{SPSite.Id},{SPWeb.Id}/items/{SPListItem.UniqueId}/driveItem".replace("{.spHost}",s)).replace("{DomainName}",c)).replace("{SPSite.Id}",e)).replace("{SPWeb.Id}",t),o=a.trimEnd(a.trimStart(o,"{"),"}"),f=f.replace("{SPListItem.UniqueId}",o);else if(s&&d){d.indexOf("?")>-1&&(new i._QosMonitor("ThumbnailRequestWithQuery").writeSuccess({service:l||"Unknown",source:d}),d=d.split("?")[0]),d.indexOf("#")>-1&&new i._QosMonitor("ThumbnailRequestWithHash").writeSuccess({service:l||"Unknown",source:d});var p=new h(d),m=d;(m.indexOf("%2F")>-1||m.indexOf("%2f")>-1)&&(m=decodeURIComponent(m)),p.format!==u.absolute&&(m="".concat(s).concat("/"!==m[0]&&"\\"!==m[0]?"/":"").concat(m));var _=r._SPKillSwitch.isActivated("2f268f84-0eee-4f0f-a743-fec73e5e76b2")?r._SPKillSwitch.isActivated("f1135e46-8b4b-41c8-9af2-008a1596012d")?a.trimEnd(a.trimEnd(btoa(unescape(encodeURIComponent(m))),"="),"=".replace("+","-").replace("/","_")):a.trimEnd(btoa(unescape(encodeURIComponent(m))),"=").replace("+","-").replace("/","_"):a.trimEnd(btoa(unescape(encodeURIComponent(m))),"=").replace(/\+/g,"-").replace(/\//g,"_");f="{.spHost}/_api/v2.1/shares/u!{.base64EncodedResourceUrl}/driveItem".replace("{.spHost}",s).replace("{.base64EncodedResourceUrl}",_)}}else f=(f=(f=(f="{.spHost}/_api/v2.1/sites/{DomainName},{SPSite.Id},{SPWeb.Id}/lists/{SPList.Id}/items/{SPListItem.UniqueId}/driveItem".replace("{.spHost}",s)).replace("{DomainName}",c)).replace("{SPSite.Id}",e)).replace("{SPWeb.Id}",t),n=a.trimEnd(a.trimStart(n,"{"),"}"),f=f.replace("{SPList.Id}",n),o=a.trimEnd(a.trimStart(o,"{"),"}"),f=f.replace("{SPListItem.UniqueId}",o);return f},e.updateVROOMCustomThumbnailSize=function(t,n){if(!t||isNaN(n)||n<=0)return t;var a=t.toLowerCase().indexOf(e.THUMBNAIL_SIZE_PREFIX);if(a<0)return t;var i=t.indexOf("x",a+e.THUMBNAIL_SIZE_PREFIX.length);if(i<=a)return t;var r=t.substr(a,i-a);return t.replace(r,"".concat(e.THUMBNAIL_SIZE_PREFIX).concat(this.normalizeWidth(n)))},e.getVROOMThumbnailWidth=function(t){if(""!==t){var n=t.toLowerCase().indexOf(e.THUMBNAIL_SIZE_PREFIX);if(!(n<0)){var a=t.indexOf("x",n+e.THUMBNAIL_SIZE_PREFIX.length);if(!(a<=n))return n+=e.THUMBNAIL_SIZE_PREFIX.length,Number(t.substr(n,a-n))}}},e.normalizeDimension=function(t,n,a){return!n&&t?t=e.normalizeWidth(t):n&&!t?n=e.normalizeWidth(n):t&&n?(t=Math.round(e.scaleByPixelRatio(t)),n=Math.round(e.scaleByPixelRatio(n))):t=void 0!==a?this.getWidthByResolution(a):e.smallestBreakPointWidth,{width:t,height:n}},e.getFileExtension=function(e){if(e){var t=e.path.lastIndexOf(".");if(t>-1){var n=e.path.substr(t+1).toLowerCase();if(!r._SPKillSwitch.isActivated("7e4eedb4-3481-417a-8a74-5ccb886abef5")){var a=n.lastIndexOf("#");a>-1&&(n=n.substr(0,a))}return n}}},e.getWidthByResolution=function(e){if(isNaN(e))return 300;var t=300;switch(e){case 0:t=300;break;case 1:t=480;break;case 2:t=750;break;case 3:t=1024;break;case 4:t=1600;break;case 5:case 6:t=2560}return t},e._widthToResolution=function(e){if(void 0!==e&&!isNaN(e))return e<=300?0:e<=480?1:e<=750?2:e<=1024?3:e<=1600?4:5},e._createLookupEntries=function(e,t){for(var n=0;n<e.length;n++)t[e[n]]=!0},e._getWidthByMeTACache=function(t,n){void 0===n&&(n=!1);var a=e.smallestBreakPointWidth;return void 0===t||isNaN(t)?a:n&&t<=200?200:t<=a?a:t<=960?960:t<=1600?1600:N},e.CLIENT_TYPE="clientType",e.MODERN_WEB_PART="modernWebPart",e.PREFER="prefer",e.EXTEND_CACHE_MAXAGE="extendCacheMaxAge",e.THUMBNAIL_SIZE_PREFIX="/thumbnails/0/c",e.NO_REDIRECT="noRedirect",e.CURRENT_OPTIMIZED_FORMAT="webp",e.VROOM_FORMAT="format",e.mediaServiceSupportedMap=new Set(["doc","docx","xlsb","xlsx","xlsm","xltx","xls","ppt","pptx","pptm","potx","potm","pot","ppsx","ppsxm","pps","odt","ods","odp","rtf","csv","pano","fppx","hcp","eml","msg","ai","cur","epdf","epi","eps","epsf","epsi","ico","icon","log","mat","pdf","pdfa","pict","ps","psb","psd","svg","svgz","txt","xbm","xcf","xpm","mts","m2ts","mpg","mpeg","mp4","mov","wmv","avi","asf","m4v","3gp","3g2","3gp2","3gpp","m1v","m2v","ts","mp4v","ogg","webm","movie","bmp","png","webp","jpeg","jpg","jfif","tiff","tif","wmp","arw","cr2","erf","mef","mrw","nef","orf","nrw","pef","raw","rw2","rw1","sr2","cool","fbx","obj","ply","stl","3mf","glb","dcm","dcm30","dic","dicm","dicom"]),e._optimizableFormats=new Map([["png",L],["jpg",k],["jpeg",k]]),e._browserViewableImageExtensions=["bmp","jpeg","jpg","png","svg","tif","tiff","webp"],e._getPreviewSupportedMap=new Set(["3gp","3g2","3gp2","asf","ai","aspx","avi","docm","docx","dotx","dotm","dv","emf","eps","ismv","m2v","m2ts","mov","mod","mp4","mpeg","mpg","mts","pdf","pptm","pptx","potm","potx","ppsm","ppsx","psd","ts","vob","wmf","wmv","xesc","xlsm","xlsx"].concat(e._browserViewableImageExtensions)),e}(),V=function(){function e(){}return e.convertToImageUrl=function(e){var t={spResource:e.sourceUrl,fileType:j.getFileExtension(new h(e.sourceUrl)),width:e.width,height:e.height,callerId:"PublicApi",absoluteUrl:window.location.href,cacheBuster:e.cacheBuster};return H.getThumbnailUrl(t)},e}()})(),d})());