define("c07208f0-ea3b-4c1a-9965-ac1b825211a6_1.21.1",["@microsoft/sp-http-base","@microsoft/sp-diagnostics","@microsoft/sp-core-library","tslib","@microsoft/sp-http-msgraph"],(e,t,n,a,i)=>(()=>{"use strict";var r={676:e=>{e.exports=n},207:e=>{e.exports=t},737:t=>{t.exports=e},812:e=>{e.exports=i},280:e=>{e.exports=a}},o={};function s(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e](n,n.exports,s),n.exports}s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var c={};return(()=>{s.r(c),s.d(c,{AadHttpClient:()=>e.AadHttpClient,AadHttpClientConfiguration:()=>e.AadHttpClientConfiguration,AadHttpClientFactory:()=>e.AadHttpClientFactory,AadHttpClientResponse:()=>e.AadHttpClientResponse,AadTokenProvider:()=>e.AadTokenProvider,AadTokenProviderFactory:()=>e.AadTokenProviderFactory,BeforeRedirectEventArgs:()=>e.BeforeRedirectEventArgs,DEPRECATED_DO_NOT_USE_OAuthTokenProvider:()=>e.DEPRECATED_DO_NOT_USE_OAuthTokenProvider,DigestCache:()=>e.DigestCache,HttpClient:()=>e.HttpClient,HttpClientConfiguration:()=>e.HttpClientConfiguration,HttpClientResponse:()=>e.HttpClientResponse,MSGraphClient:()=>u.MSGraphClient,MSGraphClientFactory:()=>u.MSGraphClientFactory,ODataVersion:()=>e.ODataVersion,PopupEventArgs:()=>e.PopupEventArgs,SPHttpClient:()=>e.SPHttpClient,SPHttpClientBatch:()=>e.SPHttpClientBatch,SPHttpClientBatchConfiguration:()=>e.SPHttpClientBatchConfiguration,SPHttpClientCommonConfiguration:()=>e.SPHttpClientCommonConfiguration,SPHttpClientConfiguration:()=>e.SPHttpClientConfiguration,SPHttpClientResponse:()=>e.SPHttpClientResponse,SPHttpHeader:()=>e.SPHttpHeader,TokenAcquisitionEventArgs:()=>e.TokenAcquisitionEventArgs,_DEPRECATED_DO_NOT_USE_GraphHttpClient:()=>l,_DEPRECATED_DO_NOT_USE_GraphHttpClientConfiguration:()=>o,_DEPRECATED_DO_NOT_USE_GraphHttpClientResponse:()=>i});var e=s(737),t=s(207),n=s(676),a=s(280);const i=function(e){function t(t){return e.call(this,t)||this}return(0,a.__extends)(t,e),t.prototype.clone=function(){return new t(this.nativeResponse.clone())},Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId||(this._correlationId=n.Guid.tryParse(this.headers.get("request-id"))),this._correlationId},enumerable:!1,configurable:!0}),t}(e.HttpClientResponse);var r=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,a.__extends)(t,e),t}(e.HttpClientConfiguration);const o=r;var d={v1:new r(e.HttpClient.configurations.v1)};const l=function(){function a(a){var i=this;this._serviceScope=a,this._serviceScope.whenFinished(function(){i._tokenProvider=a.consume(e.DEPRECATED_DO_NOT_USE_OAuthTokenProvider.serviceKey),i._parentSource=a.consume(t._logSourceServiceKey),i._graphContext=a.consume(e._GraphHttpClientContext.serviceKey),i._fetchProvider=a.consume(e._fetchProviderServiceKey),i._clientManifestData=i._serviceScope.consume(n._ClientManifestData.serviceKey)})}return a.prototype.fetch=function(t,n,a,i){var r=this;if(!i||!this._cacheDataProvider)return this._fetch(t,n,a);var o=this._cacheDataProvider.getCacheKey(e._CacheKeyType.HttpGenerated,t,n,a);return e._CacheManager.fetchAndCache(o,this._cacheDataProvider,i,function(){return r._fetch(t,n,a)})},a.prototype.get=function(t,n,a,i){return i?this.fetch(t,n,e._HttpClientHelper.overrideHttpMethod(a,"GET"),i):this.fetch(t,n,e._HttpClientHelper.overrideHttpMethod(a,"GET"))},a.prototype.post=function(t,n,a){return this._fetch(t,n,e._HttpClientHelper.overrideHttpMethod(a,"POST"))},a.prototype._fetch=function(t,n,a){var r=this;return this._validateGraphRelativeUrl(t),this._getOAuthToken().then(function(){a||(a={});var o=Object.assign({},a),s=new Headers;s.append("Accept","application/json"),s.append("Authorization","Bearer "+r._token),s.append("Content-Type","application/json; charset=utf-8");var c=e._SPHttpClientHelper.cloneHeaders(a);return o.headers=r._mergeUserHeaders(s,c),r._fetchWithInstrumentation(n,new Request(r._graphContext.getGraphEndpointUrl()+"/"+t,o)).then(function(e){return new i(e)})})},a.prototype._fetchWithInstrumentation=function(t,n){return e._HttpClientHelper.fetchCore(t,n,this._serviceScope,this._fetchProvider,a._className).then(function(e){return e}).catch(function(e){return Promise.reject(e)})},a.prototype._getOAuthToken=function(){var e=this,n=new t._QosMonitor("GraphHttpClient.FetchGraphToken");return this._clientManifestData.manifest&&(n.extraData={alias:this._clientManifestData.manifest.alias,componentId:this._clientManifestData.manifest.id}),this._tokenProvider.getOAuthToken(this._graphContext.getGraphEndpointUrl(),this._graphContext.getWebServerRelativeUrl()).then(function(t){e._writeQosMonitorUpdate(t,n,"FetchGraphToken"),e._token=t.token}).catch(function(t){return n.writeUnexpectedFailure("FetchGraphToken",t,{source:e._logSourceId}),Promise.reject(t)})},Object.defineProperty(a.prototype,"_cacheDataProvider",{get:function(){return this._cacheProvider||(this._cacheProvider=this._serviceScope.consume((0,e._getCacheDataProviderServiceKey)())._provider),this._cacheProvider},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"_logSourceId",{get:function(){return this._parentSource.isEmpty()?a._logSource.id:this._parentSource.id},enumerable:!1,configurable:!0}),a.prototype._mergeUserHeaders=function(e,t){return t.forEach(function(t,n){e.set(n,t)}),e},a.prototype._writeQosMonitorUpdate=function(e,t,n){e.status>=200&&e.status<=299?t.writeSuccess({source:this._logSourceId}):e.status>=300&&e.status<=499?t.writeExpectedFailure(n,void 0,{source:this._logSourceId,responseStatus:e.status}):t.writeUnexpectedFailure(n,void 0,{source:this._logSourceId,responseStatus:e.status})},a.prototype._validateGraphRelativeUrl=function(e){if(n.Validate.isNotNullOrUndefined(e,"url"),"/"===e.charAt(0))throw new Error("GraphHttpClient requests cannot begin with a / character");if(0===e.indexOf("http://",0))throw new Error("GraphHttpClient requests cannot specify a different graph server with the url.");if(0===e.indexOf("https://",0))throw new Error("GraphHttpClient requests cannot specify a different graph server with the url.")},a.configurations=d,a.serviceKey=n.ServiceKey.create("sp-http:GraphHttpClient",a),a._className="DEPRECATED_DO_NOT_USE_GraphHttpClient",a._logSource=t._LogSource.create("DEPRECATED_DO_NOT_USE_GraphHttpClient"),a}();var u=s(812)})(),c})());