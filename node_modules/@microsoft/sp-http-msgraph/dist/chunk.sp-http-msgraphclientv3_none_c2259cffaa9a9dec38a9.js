"use strict";(self["webpackJsonp_aec2bbfd-a968-4d5b-a279-12e570f378e6_1.21.1"]=self["webpackJsonp_aec2bbfd-a968-4d5b-a279-12e570f378e6_1.21.1"]||[]).push([[308],{979:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var a=n(280),i=n(676),r=n(207),o=n(360),s=n(737);function c(){return i._SPKillSwitch.isActivated("cf20bd1c-8f94-466b-b394-382640c75c23")}var d=function(){function e(e,t,n){this._tokenProvider=e,this._graphBaseUrl=t,this._isInternal=n}return e.prototype.getAccessToken=function(){return this._isInternal?this._getInternalToken(this._tokenProvider):this._getOAuthToken(this._tokenProvider)},e.prototype._getOAuthToken=function(e){var t=new r._QosMonitor("MSGraphClient.FetchGraphToken");return e.getToken(this._graphBaseUrl).then(function(e){return t.writeSuccess(),e}).catch(function(e){throw t.writeUnexpectedFailure(e.message,e),e})},e.prototype._getInternalToken=function(e){var t=new r._QosMonitor("MSGraphClient.FetchInternalGraphToken");return e._getTokenInternal(this._graphBaseUrl,s._AadTokenProviders.preAuthorizedConfiguration).then(function(e){return t.writeSuccess(),e}).catch(function(e){throw t.writeUnexpectedFailure(e.message,e),e})},e}();const l=function(){function e(t,n,a,r){var o=this;this._isInternal=!1,t.whenFinished(function(){if(e._graphBaseUrl||(e._graphBaseUrl=t.consume(s._GraphHttpClientContext.serviceKey).getGraphEndpointUrl()),!c()){var d=t.consume(i._ClientManifestData.serviceKey);o._consumerComponentManifest=d.manifest}r?(o._isInternal=!0,e._internalInstance||(e._internalInstance=o._createInternalGraphClientInstance(s._AadTokenProviders.configurable,n))):e._instance||(e._instance=void 0!==a?o._createGraphClientInstanceWithMiddleware(s._AadTokenProviders.configurable,a):o._createGraphClientInstance(s._AadTokenProviders.configurable,n))})}return e.prototype.api=function(t){return i.Validate.isNonemptyString(t,"path"),this._isInternal?e._internalInstance.api(t):e._instance.api(t)},Object.defineProperty(e.prototype,"client",{get:function(){return this._isInternal?e._internalInstance:e._instance},enumerable:!1,configurable:!0}),e.prototype._createGraphClientInstance=function(e,t){var n,i=new r._QosMonitor("MSGraphClientV3.CreateGraphClientInstance");try{n=this._createClientInstance((0,a.__assign)((0,a.__assign)({},t),{authProvider:void 0}),e,!1)}catch(e){throw i.writeUnexpectedFailure(e.message,e),e}return n},e.prototype._createGraphClientInstanceWithMiddleware=function(e,t){var n,a=new r._QosMonitor("MSGraphClientV3.CreateGraphClientInstanceWithMiddleware");try{return n=this._createClientInstance(t,e,!1),a.writeSuccess(),n}catch(e){throw a.writeUnexpectedFailure(e.message,e),e}},e.prototype._createInternalGraphClientInstance=function(e,t){var n,i=new r._QosMonitor("MSGraphClientV3.CreateInternalGraphClientInstance");try{n=this._createClientInstance((0,a.__assign)((0,a.__assign)({},t),{authProvider:void 0}),e,!0)}catch(e){throw i.writeUnexpectedFailure(e.message,e),e}return n},e.prototype._createClientInstance=function(t,n,a){var s,l=t||{};if(l.baseUrl=e._graphBaseUrl,l.middleware?(s=[new o.AuthenticationHandler(new d(n,e._graphBaseUrl,a))],Array.isArray(l.middleware)?s.push.apply(s,l.middleware):s.push(l.middleware)):s=o.MiddlewareFactory.getDefaultMiddlewareChain(new d(n,e._graphBaseUrl,a)),!c()&&this._consumerComponentManifest){l.fetchOptions||(l.fetchOptions={}),l.fetchOptions.headers||(l.fetchOptions.headers={});var u="SPFx/".concat(this._consumerComponentManifest.alias,"/").concat(this._consumerComponentManifest.id,"/Is3PRequest:").concat(this._consumerComponentManifest.isInternal?"0":"1"),f=l.fetchOptions.headers;if(Array.isArray(f)){var p=f.findIndex(function(e){return"SdkVersion"===e[0]});-1===p?f.push(["SdkVersion",u]):f[p][1]+=", ".concat(u)}else f instanceof Headers?f.has("SdkVersion")?f.set("SdkVersion","".concat(f.get("SdkVersion"),", ").concat(u)):f.set("SdkVersion",u):f.SdkVersion=f.SdkVersions?"".concat(f.SdkVersion,", ").concat(u):u}if(l.middleware=s,!i._SPKillSwitch.isActivated("249a915b-2c26-4fe0-a2da-19f8a7b2b56e"))try{var m=new URL(e._graphBaseUrl);l.customHosts=new Set([m.host])}catch(e){new r._QosMonitor("MSGraphClientV3.CustomHostsAdditionsFailed").writeUnexpectedFailure(e.message,e)}return o.Client.initWithMiddleware(l)},e}()}
}]);