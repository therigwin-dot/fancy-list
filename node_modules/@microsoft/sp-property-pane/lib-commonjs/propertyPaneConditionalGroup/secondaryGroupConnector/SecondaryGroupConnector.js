"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var React = tslib_1.__importStar(require("react"));
var office_ui_fabric_react_bundle_1 = require("@ms/office-ui-fabric-react-bundle");
var PropertyPaneConditionalGroup_module_scss_1 = tslib_1.__importDefault(require("../PropertyPaneConditionalGroup.module.scss"));
var Strings_resx_1 = tslib_1.__importDefault(require("../../loc/Strings.resx"));
var SecondaryGroupConnector = /** @class */ (function (_super) {
    tslib_1.__extends(SecondaryGroupConnector, _super);
    function SecondaryGroupConnector(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isCalloutVisible: false
        };
        return _this;
    }
    SecondaryGroupConnector.prototype.render = function () {
        var isCalloutVisible = this.state.isCalloutVisible;
        var onConnectToSourceClick = this.props.onConnectToSourceClick;
        return (React.createElement("div", { className: PropertyPaneConditionalGroup_module_scss_1.default.alternateFieldsConnectorIconBtn },
            React.createElement("div", { ref: this._resolveRef('_ellipsisElement'), title: this.props.tooltip },
                React.createElement(office_ui_fabric_react_bundle_1.IconButton, { "data-automation-id": 'moreOptionsSecondaryGroup', iconProps: { iconName: 'More' }, title: Strings_resx_1.default.DynamicDataSecondaryGroupIconButtonLabel, ariaLabel: Strings_resx_1.default.DynamicDataSecondaryGroupIconButtonLabel, onClick: this._handleConnectorClick, className: PropertyPaneConditionalGroup_module_scss_1.default.moreIcon })),
            isCalloutVisible && (React.createElement("div", { className: PropertyPaneConditionalGroup_module_scss_1.default.callout },
                React.createElement(office_ui_fabric_react_bundle_1.Callout, { role: 'alertdialog', isBeakVisible: false, setInitialFocus: true, directionalHint: office_ui_fabric_react_bundle_1.DirectionalHint.bottomCenter, onDismiss: this._handleCalloutDismiss, target: this._ellipsisElement },
                    React.createElement(office_ui_fabric_react_bundle_1.DefaultButton, { "data-automation-id": 'connectToSource', onClick: onConnectToSourceClick, iconProps: { iconName: 'Plug' }, ariaDescription: Strings_resx_1.default.ConnectToDynamicDataSourceDescription, text: Strings_resx_1.default.ConnectToDynamicDataSource }))))));
    };
    SecondaryGroupConnector.prototype._handleConnectorClick = function () {
        this.setState({
            isCalloutVisible: !this.state.isCalloutVisible
        });
    };
    SecondaryGroupConnector.prototype._handleCalloutDismiss = function () {
        this.setState({
            isCalloutVisible: false
        });
    };
    tslib_1.__decorate([
        office_ui_fabric_react_bundle_1.autobind
    ], SecondaryGroupConnector.prototype, "_handleConnectorClick", null);
    tslib_1.__decorate([
        office_ui_fabric_react_bundle_1.autobind
    ], SecondaryGroupConnector.prototype, "_handleCalloutDismiss", null);
    return SecondaryGroupConnector;
}(office_ui_fabric_react_bundle_1.BaseComponent));
exports.default = SecondaryGroupConnector;
//# sourceMappingURL=SecondaryGroupConnector.js.map