"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isWebpart = exports.isConsumerWithManifest = void 0;
var sp_loader_1 = require("@microsoft/sp-loader");
/**
 * Determines if the specified property pane consumer is a consumer with a manifest
 */
function isConsumerWithManifest(consumer) {
    var _a;
    return Boolean(consumer &&
        Object.prototype.hasOwnProperty.call(consumer, 'context') &&
        ((_a = consumer === null || consumer === void 0 ? void 0 : consumer.context) === null || _a === void 0 ? void 0 : _a.manifest));
}
exports.isConsumerWithManifest = isConsumerWithManifest;
/**
 * Determines if the specified consumer is a webpart.
 */
function isWebpart(consumer) {
    var _a;
    var unverifiedManifestId = isConsumerWithManifest(consumer)
        ? consumer.context.manifest.id
        : undefined;
    return (!!unverifiedManifestId &&
        ((_a = sp_loader_1.SPComponentLoader.tryGetManifestById(unverifiedManifestId)) === null || _a === void 0 ? void 0 : _a.componentType) === 'WebPart');
}
exports.isWebpart = isWebpart;
//# sourceMappingURL=utility.js.map