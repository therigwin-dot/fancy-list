(self["webpackJsonp_f9e737b7-f0df-4597-ba8c-3060f82380db_1.21.1"]=self["webpackJsonp_f9e737b7-f0df-4597-ba8c-3060f82380db_1.21.1"]||[]).push([[409],{3247:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ThumbnailPickerPreview:()=>I});var a=n(280),i=n(5959),r=n.n(i),o=n(2141),s=n(3140),c=n(2207),d=n(4949),l=n(529),u=n(7408),f=n(8414);const p=function(){function e(){}return e.load=function(e,t){return f.SPComponentLoader.loadComponentById("a81a5cf6-c9ad-4a0a-85aa-68c03d2d22a2").then(function(n){var a=new n.FilePicker(e);return a.initialize(t),a.fetchData().catch(function(e){return c._TraceLogger.logError(c._LogSource.create("FilePickerLoader"),e,"fetchData")}),a})},e}();var m=n(5994),_=i.lazy(function(){return n.e(875).then(n.bind(n,5604)).then(function(e){return{default:e.SPFilePickerHost}})});function h(e){return i.createElement(i.Suspense,{fallback:!1},i.createElement(_,(0,a.__assign)({},e)))}var b=n(7620);const g=JSON.parse('{"R":"We\\u0027re still uploading your item. If you leave this page, uploading may not finish and you\\u0027ll have to try again."}');var v=function(){function e(e){var t=this;this._handleSPFilePickerHostCancel=function(){return(0,a.__awaiter)(t,void 0,void 0,function(){var e;return(0,a.__generator)(this,function(t){return(null===(e=this._options)||void 0===e?void 0:e.onCloseFilePicker)&&this._options.onCloseFilePicker(),[2]})})},this._handleSPFilePickerHostPick=function(e){return(0,a.__awaiter)(t,void 0,void 0,function(){var t;return(0,a.__generator)(this,function(n){return this._handleSelectFile(e),(null===(t=this._options)||void 0===t?void 0:t.onCloseFilePicker)&&this._options.onCloseFilePicker(),[2]})})},this._options=e,this._spFileHandlerPromise=Promise.resolve().then(n.t.bind(n,5994,23)).then(function(e){return void 0===t._spFileHandler&&(t._spFileHandler=new e.SPFileHandler({serviceScope:t._options.serviceScope,qosPrefix:t._options.callerName})),t._spFileHandler}),this._options.serviceScope.whenFinished(function(){var e=t._options.serviceScope.consume(u.PageContext.serviceKey);t._webId=e.web.id.toString(),t._siteId=e.site.id.toString(),t._webAbsoluteUrl=e.web.absoluteUrl})}return e.prototype.openFilePicker=function(e,t){l.merge(this._options,e),this._sourceItemUrl=t,this._ensureFilePickerAsync().then(function(e){e.open()}).catch(function(){})},e.prototype.renderSpFilePickerHost=function(e,t){return l.merge(this._options,e),this._sourceItemUrl=t,(0,b.Yg)()&&this._webAbsoluteUrl?r().createElement(h,{serviceScope:this._options.serviceScope,show:!0,app:"SPPages",scenario:"PropertyPaneThumbnailEdit",siteUrl:this._webAbsoluteUrl,handleCancel:this._handleSPFilePickerHostCancel,handlePick:this._handleSPFilePickerHostPick,selectType:"all",selectMode:this._options.isMultiSelectMode?"multiple":"single",disablePivots:this._options.disableWebSearch?["webSearch"]:void 0,useCustomRecentPivot:!0}):r().createElement(r().Fragment,null)},e.prototype._ensureFilePickerAsync=function(){if(!this._filePicker){var e={selectableType:3,onSelect:this._handleSelectFile,onCancel:this._options.onClose,selectionMode:this._options.isMultiSelectMode?s.SelectionMode.multiple:s.SelectionMode.single,itemTypes:this._options.itemTypes,allowExternalTenantLinks:this._options.allowExternalTenantLinks,disableWebSearch:this._options.disableWebSearch,callerName:this._options.callerName,enableMailtoSchema:!0};this._filePicker=p.load(this._options.serviceScope,e)}return this._filePicker},e.prototype._handleSelectFile=function(e){var t=this;e&&e.selectedItems&&e.selectedItems.length>0?e.selectedItems.forEach(function(n){if(t._options.onSelectFile){var a=Boolean(n.ListId||n.UniqueId||n.WebId||n.SiteId)?{listId:n.ListId,uniqueId:n.UniqueId,webId:n.WebId,siteId:n.SiteId}:void 0;t._options.onSelectFile(n.Link,a,e.selectedItems.length)}}):e&&e.localFilesPickedToUpload?(this._itemsCount=e.localFilesPickedToUpload.length,e.localFilesPickedToUpload.forEach(function(e){var n=e.file;t._startUpload(n)})):e&&e.externalImagesPickedToUpload?(this._itemsCount=e.externalImagesPickedToUpload.length,e.externalImagesPickedToUpload.forEach(function(e){t._startUpload(e)})):c._TraceLogger.logErrorWithLogEntry(c._LogSource.create(this._options.callerName),new c._LogEntry(this._options.callerName,"HandleSelectFileFromFilePicker",c._LogType.Error,{response:JSON.stringify(e)}))},e.prototype._startUpload=function(e){var t,n,a,i,r=this;if(e instanceof File){var o=!1;this._sourceItemUrl&&(o=this._sourceItemUrl.split("/").pop()===e.name);var s=Math.floor(4294967296*Math.random()).toString(),l=o?s+m.SPFileHandler.replaceSpecialCharacters(e.name):m.SPFileHandler.replaceSpecialCharacters(e.name);a=new c._QosMonitor("".concat(this._options.callerName,".UploadItem")),i=this._spFileHandlerPromise.then(function(t){return t.uploadLocalFile(e,l)})}else{if(d._ThumbnailUrlGenerator.getThumbnailProvider(e.src)===d._ThumbnailProviderType.HubbleStock)return void(null===(n=(t=this._options).onSelectFile)||void 0===n||n.call(t,e.src,void 0,this._itemsCount));a=new c._QosMonitor("".concat(this._options.callerName,".UploadExternalItem")),i=this._spFileHandlerPromise.then(function(t){return t.uploadExternalFile(e.src,(0,b.Yg)()?m.SPFileHandler.replaceSpecialCharacters(e.name):e.name)})}window.addEventListener("beforeunload",this._promptUploadingWarning),this._options.onUploadFileStart&&this._options.onUploadFileStart(),i.then(function(e){r._onUploadComplete(e),a.writeSuccess()},function(e){e instanceof m.SPFileHandlerError?-2147024891===e.errorCode?a.writeExpectedFailure("PermissionAccessDenied",e):-2130575257===e.errorCode?a.writeExpectedFailure("FileNameExisted",e):a.writeUnexpectedFailure("FailedToUpload",e,{errorCode:e.errorCode}):a.writeUnexpectedFailure("FailedToUploadNoSPFileHandlerError",e),r._onUploadError(e)})},e.prototype._promptUploadingWarning=function(e){var t=g.R;return e.returnValue=t,t},e.prototype._onUploadComplete=function(e){if(window.removeEventListener("beforeunload",this._promptUploadingWarning),this._options.onSelectFile){var t=e.uniqueId?{listId:e.listId,uniqueId:e.uniqueId,webId:this._webId,siteId:this._siteId}:void 0;this._options.onSelectFile(e.serverRelativeUrl,t,this._itemsCount)}},e.prototype._onUploadError=function(e){window.removeEventListener("beforeunload",this._promptUploadingWarning)},(0,a.__decorate)([o.autobind],e.prototype,"openFilePicker",null),(0,a.__decorate)([o.autobind],e.prototype,"renderSpFilePickerHost",null),(0,a.__decorate)([o.autobind],e.prototype,"_handleSelectFile",null),e}(),y=n(6921),S=n(2893),D=n(6207);n(8424).loadStyles(".as_g_d8e860b4{align-items:stretch;display:flex;flex-direction:column;width:100%}.as_g_d8e860b4 .at_g_d8e860b4{align-self:flex-start;margin-bottom:10px;margin-top:10px}",!0);var I=function(e){function t(t){var n=e.call(this,t)||this;return n._handleChangeImageClick=function(){(0,b.Yg)()?n.setState({showFilePicker:!0}):n._filePicker.openFilePicker()},n._onFilePickerClose=function(){n.setState({showFilePicker:!1})},n._filePicker=new v({serviceScope:n.props.serviceScope,itemTypes:new Set([2]),onSelectFile:n._handleSelectFile,onUploadFileError:n._handleUploadError,onUploadFileStart:n._handleUploadFileStart,onCloseFilePicker:(0,b.Yg)()?n._onFilePickerClose:void 0,allowExternalTenantLinks:!1,disableWebSearch:!1,isMultiSelectMode:!1,callerName:n.props.callerName}),n._thumbnailWrapperRef=i.createRef(),n.state={isUploadInProgress:!1,showFilePicker:!1},n}return(0,a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isUploadInProgress:!1})},t.prototype.render=function(){return i.createElement("div",{className:"as_g_d8e860b4",ref:this._thumbnailWrapperRef},i.createElement(y._,{key:this.props.thumbnail.imageUrl,thumbnail:this.props.thumbnail,showLoading:this.state.isUploadInProgress,previewFullWidth:this.props.previewFullWidth,previewGrayBackground:this.props.previewGrayBackground,wrapperClassName:this.props.thumbnailRendererWrapperClassName,iconClassName:this.props.thumbnailRendererIconClassName,qosPrefix:this.props.callerName}),(0,S._)(this._handleChangeImageClick,this.props.onItemDeleted,"at_g_d8e860b4",this.props.disabled,"thumbnailImagePicker"),(0,b.Yg)()&&this.state.showFilePicker&&this._filePicker.renderSpFilePickerHost())},t.prototype._handleUploadFileStart=function(){this.setState({isUploadInProgress:!0})},t.prototype._handleUploadError=function(e){this.setState({isUploadInProgress:!1})},t.prototype._handleSelectFile=function(e,t){this.setState(function(e){return{isUploadInProgress:!1}}),this.props.onItemChanged(e,t),this._handleImageChangeFocus()},t.prototype._handleImageChangeFocus=function(){var e=this;(0,D.Gk)()||setTimeout(function(){var t,n=null===(t=e._thumbnailWrapperRef.current)||void 0===t?void 0:t.querySelector('[data-automation-id="thumbnailImagePickerChangeButton"]');n&&n.focus()},0)},(0,a.__decorate)([o.autobind],t.prototype,"_handleUploadFileStart",null),(0,a.__decorate)([o.autobind],t.prototype,"_handleUploadError",null),(0,a.__decorate)([o.autobind],t.prototype,"_handleSelectFile",null),t}(i.PureComponent)}
,2893:(e,t,n)=>{"use strict";n.d(t,{_:()=>l,t:()=>d});var a=n(280),i=n(5959),r=(n(2141),n(8926)),o=n(9276),s=n(3544),c=n(6207);function d(e,t,n,a,i){return u(e,{change:{description:s.aD,label:s.L1},delete:{description:s.mO,label:s.dH}},t,i,n,a)}function l(e,t,n,a,i){return u(e,{change:{description:s.AA,label:s.x6},delete:{description:s.OH,label:s.tI}},t,a,n,i)}function u(e,t,n,d,l,u){var f=t.change,p=f.description,m=f.label,_=t.delete,h=_.description,b=_.label,g={className:l,onClick:e,disabled:d&&!(0,c.so)(),ariaLabel:m,ariaDescription:p,"data-automation-id":u?"".concat(u,"ChangeButton"):"thumbnailImagePickerChangeButton"},v=i.createElement(r.ActionButton,(0,a.__assign)({},g,{iconProps:{iconName:"Edit"}}),s.o7),y=n?i.createElement(r.ActionButton,{iconProps:{iconName:"Delete"},className:l,onClick:n,disabled:d&&!(0,c.so)(),ariaLabel:b,ariaDescription:h,"data-automation-id":u?"".concat(u,"DeleteButton"):"thumbnailImagePickerDeleteButton"},s.P9):void 0;return y?i.createElement(o.Stack,{tokens:{childrenGap:40},horizontal:!0},v," ",y):v}}
,6921:(e,t,n)=>{"use strict";n.d(t,{_:()=>u});var a=n(280),i=n(5959),r=n(2141),o=n(4779),s=n(2207),c=n(3506),d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isRenderBackup:!1},n}return(0,a.__extends)(t,e),t.prototype.render=function(){var e,t=this._content;return!!t&&i.createElement("div",{role:"img",className:this.props.className,"aria-label":null===(e=this.props.thumbnail)||void 0===e?void 0:e.altText},t)},Object.defineProperty(t.prototype,"_content",{get:function(){if(this.props.onRenderThumbnail)return this.props.onRenderThumbnail();var e=this.props.thumbnail;if(e)switch(e.type){case c.F.FabricReactIcon:return i.createElement(r.Icon,{iconName:e.iconName,style:e.iconColor?{color:e.iconColor}:void 0,role:"presentation",className:this.props.iconClassName});case c.F.IconSizeImage:var t={className:this.props.iconClassName,imageFit:r.ImageFit.cover,src:e.iconUrl,role:"presentation",alt:e.altText};return i.createElement(r.Icon,{iconType:r.IconType.image,style:e.iconColor?{color:e.iconColor}:void 0,imageProps:t,className:this.props.iconClassName});case c.F.Image:var n={imageFit:void 0!==e.imageFit?e.imageFit:r.ImageFit.cover,src:this.state.isRenderBackup&&e.backupImageUrl?e.backupImageUrl:e.imageUrl,alt:e.altText,title:e.altText?e.altText:void 0,role:e.altText?void 0:"presentation",className:this.props.iconClassName,onLoadingStateChange:this._handleImageLoadingStateChange,styles:{image:{width:"100%",height:"100%"}}};return this._imageMonitor=new s._QosMonitor("".concat(this.props.qosPrefix,".ImageLoad")),i.createElement(r.Icon,{iconType:r.IconType.image,imageProps:n,className:this.props.iconClassName});default:return}},enumerable:!1,configurable:!0}),t.prototype._handleImageLoadingStateChange=function(e){this._imageMonitor&&(e===r.ImageLoadState.loaded?this._imageMonitor.writeSuccess():e===r.ImageLoadState.error&&this._imageMonitor.writeUnexpectedFailure("ImageLoadError",void 0,{isRenderBackup:this.state.isRenderBackup})),this.setState(function(t){if(e===r.ImageLoadState.error&&!t.isRenderBackup)return{isRenderBackup:!0}})},(0,a.__decorate)([r.autobind],t.prototype,"_handleImageLoadingStateChange",null),t}(i.PureComponent),l=n(3544);n(8424).loadStyles('.cv_m_d8e860b4{position:relative}.cv_m_d8e860b4.cw_m_d8e860b4{background-color:"[theme:neutralLight, default: #edebe9]"}.cx_m_d8e860b4{padding-bottom:56.25%;width:100%}.cy_m_d8e860b4{height:100px;width:100px}.cz_m_d8e860b4{align-items:center;bottom:0;display:flex;justify-content:center;left:0;overflow:hidden;position:absolute;right:0;top:0}.cz_m_d8e860b4.ea_m_d8e860b4{font-size:64px;line-height:100%;text-align:center}.cz_m_d8e860b4.eb_m_d8e860b4 .ec_m_d8e860b4{height:100%;width:100%}.cz_m_d8e860b4.ee_m_d8e860b4 .ec_m_d8e860b4,.ef_m_d8e860b4{height:64px;width:64px}.ef_m_d8e860b4{display:inline-flex;margin:auto;overflow:visible}.p_m_d8e860b4{left:50%;margin:0;position:absolute;top:50%;transform:translate(-50%,-50%)}',!0);var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(){var e,t,n,a,s,u=(0,r.css)("cv_m_d8e860b4",this.props.previewFullWidth?"cx_m_d8e860b4":"cy_m_d8e860b4",this.props.previewGrayBackground?"cw_m_d8e860b4":"",this.props.wrapperClassName),f=(0,r.css)("cz_m_d8e860b4",((e={}).ef_m_d8e860b4=(null===(t=this.props.thumbnail)||void 0===t?void 0:t.type)===c.F.FabricReactIcon&&"vivaengagelogo"===this.props.thumbnail.iconName,e.ea_m_d8e860b4=(null===(n=this.props.thumbnail)||void 0===n?void 0:n.type)===c.F.FabricReactIcon,e.ee_m_d8e860b4=(null===(a=this.props.thumbnail)||void 0===a?void 0:a.type)===c.F.IconSizeImage,e.eb_m_d8e860b4=(null===(s=this.props.thumbnail)||void 0===s?void 0:s.type)===c.F.Image,e));return this.props.showLoading?i.createElement("div",{className:u},i.createElement(o.Spinner,{className:"p_m_d8e860b4",type:r.SpinnerType.large,label:l.N6})):i.createElement("div",{className:u},i.createElement(d,{thumbnail:this.props.thumbnail,className:f,iconClassName:(0,r.css)(this.props.iconClassName,"ec_m_d8e860b4"),qosPrefix:this.props.qosPrefix,onRenderThumbnail:this.props.onRenderThumbnail}))},t}(i.PureComponent)}
,3140:(e,t,n)=>{var a=n(9816);e.exports=a._Utilities}
,3544:e=>{"use strict";e.exports=JSON.parse('{"N6":"Uploading...","o7":"Change","AA":"Press enter to change the thumbnail image.","x6":"Change the thumbnail image","P9":"Delete","OH":"Press delete to delete the thumbnail image.","tI":"Delete the thumbnail image","aD":"Press enter to change the icon.","L1":"Change the icon","mO":"Press delete to delete the icon.","dH":"Delete the icon"}')}
}]);