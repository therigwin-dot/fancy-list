(()=>{var e=document.currentScript;define("974a7777-0990-4136-8fa6-95d80114c2e0_1.21.1",["tslib","@microsoft/sp-component-base","@microsoft/sp-core-library","@ms/sp-edit-customer-promise","@ms/sp-telemetry","@microsoft/sp-diagnostics","@microsoft/sp-lodash-subset","@microsoft/load-themed-styles","@microsoft/sp-http","@microsoft/sp-loader","@microsoft/sp-page-context"],(t,n,a,i,r,o,s,c,d,l,u)=>(()=>{"use strict";var f,p,m,_={620:(e,t,n)=>{n.d(t,{G9:()=>m,Jx:()=>p,K$:()=>h,Vg:()=>o,Yv:()=>b,cr:()=>d,dQ:()=>l,ky:()=>f,o$:()=>u,wU:()=>s,zZ:()=>c,zy:()=>_});var a=n(676),i=n(408),r=n(207);function o(){var e=-1===navigator.userAgent.indexOf("Chrome")&&navigator.userAgent.indexOf("Safari")>-1;return a._SPFlight.isEnabled(60290)&&(!e||a._SPFlight.isEnabled(60524))}function s(){return a._SPFlight.isEnabled(60400)}function c(){return a._SPFlight.isEnabled(60079)}function d(){return a._SPFlight.isEnabled(60668)}function l(){return a._SPFlight.isEnabled(60759)}function u(){return(!a._BrowserUtilities.isSafari()||(0,r.Vn)())&&(!(0,r.yE)()&&a._SPFlight.isEnabled(60622)||a._SPFlight.isEnabled(60821)||a._SPFlight.isEnabled(60822)||a._SPFlight.isEnabled(60823)||a._SPFlight.isEnabled(60824)||((0,r.DG)()?!(0,r.J$)()&&a._SPFlight.isEnabled(1252)&&a._BrowserUtilities.isFromVivaHome():a._SPFlight.isEnabled(1252)&&a._BrowserUtilities.isTeamsHosted()))}function f(){return!(0,r.__)()&&(a._SPFlight.isEnabled(1967)||1===i._SPPerfExperiment.getVariantAndTrackExperiment(i._PerformanceExperiment.WEXImageWebPartRefactorExp))}function p(){if(a._SPFlight.isEnabled(61149))return!0;if(!(0,r.$6)()&&!a._SPFlight.isEnabled(61426)){var e=i._SPPerfExperiment.getVariantAndTrackExperiment(i._PerformanceExperiment.SpartanListWebPartExp2);return 1===e||2===e}return!1}function m(){return a._SPFlight.isEnabled(22854)}function _(){return(a._SPFlight.isEnabled(60808)||1===a._SPExperiment.getVariantAndLogExposure(90301))&&!(0,r.CV)()}function h(){return a._SPFlight.isEnabled(60693)}function b(){return a._SPFlight.isEnabled(61389)}}
,207:(e,t,n)=>{n.d(t,{$6:()=>o,$l:()=>y,CV:()=>r,DG:()=>v,J$:()=>g,OI:()=>_,OL:()=>x,RC:()=>D,SC:()=>P,Vn:()=>p,_P:()=>S,__:()=>w,a1:()=>k,bJ:()=>C,bR:()=>F,bb:()=>l,df:()=>b,dv:()=>I,fl:()=>E,hH:()=>U,kN:()=>f,lX:()=>u,me:()=>c,mg:()=>H,mj:()=>A,o3:()=>L,pS:()=>d,rD:()=>R,rX:()=>s,sK:()=>O,ve:()=>i,vn:()=>T,xT:()=>M,yE:()=>m,z:()=>h});var a=n(676);function i(){return a._SPKillSwitch.isActivated("d8618918-ac55-4979-b9d4-be944a4feb95")}function r(){return a._SPKillSwitch.isActivated("a3f45048-0db5-4b7c-9a9a-e3183d216c4d")}function o(){return a._SPKillSwitch.isActivated("d0f08b8b-edb0-4056-81ca-75732f5cdcbd")}function s(){return a._SPKillSwitch.isActivated("b8c50ded-d048-4eb9-bc41-21190d9d3bbb")}function c(){return a._SPKillSwitch.isActivated("ca984138-b518-4cf1-b201-2efe9322bb5e")}function d(){return a._SPKillSwitch.isActivated("ab6a720f-9915-4635-9b30-71b5d83e0647")}function l(){return a._SPKillSwitch.isActivated("1a2da4d0-9678-4a79-95a4-f0b9a7732dc2")}function u(){return a._SPKillSwitch.isActivated("e1e44790-a263-4f43-8b40-5b5e9b170300")}function f(){return a._SPKillSwitch.isActivated("c041bc0e-fcb5-4a3e-a4bc-d65a00a39a86")}function p(){return a._SPKillSwitch.isActivated("61a9578e-c6d2-4605-970f-222a8b29196c")}function m(){return a._SPKillSwitch.isActivated("07684c68-2e8e-4a25-b7e0-330781a92661")}function _(){return a._SPKillSwitch.isActivated("56151a3e-a100-403c-9e91-cb5d1677ed66")}function h(){return a._SPKillSwitch.isActivated("e8edc935-7cd4-463b-81f5-aa1cce74d7d0")}function b(){return a._SPKillSwitch.isActivated("21f00b7b-3ed6-4c3a-bd49-8639460de07e")}function g(){return a._SPKillSwitch.isActivated("f993c5d6-5637-47bc-802d-6da6dda11a27")}function v(){return a._SPKillSwitch.isActivated("6c457592-8c32-472e-b340-349c014d6bc2")}function y(){return a._SPKillSwitch.isActivated("bbd78e03-ff18-40ed-9a94-973fc659366c")}function S(){return a._SPKillSwitch.isActivated("43ce53d4-53da-48c4-acbd-20ff31eff5ee")}function D(){return a._SPKillSwitch.isActivated("290c0d46-6ee0-4d0b-aee5-ef3f01e4020e")}function I(){return a._SPKillSwitch.isActivated("8b372850-6897-4ef2-aecd-cd615019e544")}function x(){return a._SPKillSwitch.isActivated("33558902-7587-4229-a570-633976fa332b")}function C(){return a._SPKillSwitch.isActivated("98bb76c9-49c4-4736-80b9-88ff41d65cac")}function O(){return a._SPKillSwitch.isActivated("6e0a6d0e-ec0c-4667-85ce-198b4bbe78af")}function w(){return a._SPKillSwitch.isActivated("138ce21a-eef4-4e30-b350-4225400c72ac")}function E(){return a._SPKillSwitch.isActivated("69933c68-aef0-4f8f-8016-a5974d22b2c6")}function A(){return a._SPKillSwitch.isActivated("bf6ec07d-4440-4ee6-83c6-17b560599c30")}function L(){return a._SPKillSwitch.isActivated("2087be6f-d433-41f5-b91a-5416f455d74d")}function k(){return a._SPKillSwitch.isActivated("4f5fdd22-e54b-443e-b79a-6134a5e59e8d")}function M(){return a._SPKillSwitch.isActivated("4a64c8cf-892b-4f83-8fe4-3a2245297f76")}function P(){return a._SPKillSwitch.isActivated("6d1353bf-844b-4683-afdd-07d4dae51ea2")}function T(){return a._SPKillSwitch.isActivated("e11d11a3-f2a0-4cc3-8c36-60f157abdb47")}function U(){return a._SPKillSwitch.isActivated("a1b3f56e-4ebf-4ae2-bb75-146286e336e4")}function F(){return a._SPKillSwitch.isActivated("e34f2e15-eaed-404b-93ee-bed24f7e5eec")}function H(){return a._SPKillSwitch.isActivated("b56be5bc-975c-4c10-b387-808c5404f3b3")}function R(){return a._SPKillSwitch.isActivated("757e6220-8354-49d2-979a-cd70080da6d9")}}
,390:(e,t,n)=>{n.d(t,{A:()=>a});var a={DeleteWebPart:"iframeDeleteWebPart",RequestDisplayMode:"iframeRequestDisplayMode",RequestPropertyPaneAction:"iframeRequestPropertyPaneAction",SetDisplayMode:"iframeSetDisplayMode",SetDimensions:"iframeSetDimensions",SetWebPartData:"iframeSetWebPartData",UpdateWebPartData:"iframeUpdateWebPartData",UpdatePropertyPaneData:"iframeUpdatePropertyPaneData",UpdatePropertyPaneLifeCycle:"iframePropertyPaneLifeCycle",WebPartRenderedInPropertyPaneIframe:"webPartRenderedInPropertyPaneIframe",DynamicDataMessage:"isolatedDynamicDataMessage",UpdateWebpartLifeCycle:"iframeUpdateWebpartLifeCycle",GetOboToken:"iframeGetOboToken",SetOboToken:"iframeSetOboToken",RequestTheme:"iframeRequestTheme",SetTheme:"iframeSetTheme",UpdateAudiences:"iframeUpdateAudiences"}}
,424:e=>{e.exports=c},962:e=>{e.exports=n},676:e=>{e.exports=a},588:e=>{e.exports=o},909:e=>{e.exports=d},414:e=>{e.exports=l},529:e=>{e.exports=s},27:e=>{e.exports=u},952:e=>{e.exports=i},408:e=>{e.exports=r},280:e=>{e.exports=t},729:e=>{e.exports=JSON.parse('{"$f":"Màńĩƒēśţś ƒàĩĺ ţō ďōŵńĺōàď.","_4":"Màńĩƒēśţ ƒōŕ ţĥē ŵēƀ ƥàŕţ {0} ĩś ńũĺĺ.","qb":"Màńĩƒēśţ ƒōŕ ţĥē ŵēƀ ƥàŕţ {0} ĩś ĩńvàĺĩď.","ik":"Ţĥĩś ĩś à ŕēàď-ōńĺŷ ƥŕōƥēŕţŷ.","X8":"ßàśēĆĺĩēńţŚĩďēŴēƀƤàŕţ ĩś àń àƀśţŕàćţ ćĺàśś àńď mũśţ ƀē ēxţēńďēď ƀēƒōŕē ũśē.","g0":"Ŕēńďēŕ mēţĥōď ńēēďś ţō ƀē ōvēŕŕĩďēń ĩń ţĥē ďēŕĩvēď ćĺàśś ōƒ ŵēƀ ƥàŕţ {0}.","ou":"Ŵēƀ ƥàŕţ {0} mũśţ ĩńĥēŕĩţ ƒŕōm ţĥē ßàśēĆĺĩēńţŚĩďēŴēƀƤàŕţ ćĺàśś.","Sz":"Ŵēƀ ƥàŕţ {0} ŵàś ńōţ ĩńĩţĩàĺĩźēď ƥŕōƥēŕĺŷ. Ŵēƀ ƥàŕţś mũśţ ƀē ĩńśţàńţĩàţēď ũśĩńĝ ţĥē ĆĺĩēńţŚĩďēŴēƀƤàŕţMàńàĝēŕ. Màńŷ ŵēƀ ƥàŕţ ƒēàţũŕēś ćàńńōţ ƀē ũśēď ţĩĺĺ ţĥē ĩńĩţĩàĺĩźàţĩōń ĩś ćōmƥĺēţē.","zd":"Ńũĺĺ ƥŕōƥēŕţŷ ƀàĝ ĩś ńōţ àĺĺōŵēď ƒōŕ ŵēƀ ƥàŕţ {0}. Ēmƥţŷ ƥŕōƥēŕţŷ ƀàĝ ĩś śũƥƥōŕţēď.","$m":"Mōďũĺē ĩś ńōţ ĺōàďēď ōŕ ńōţ ďēƒĩńēď ĩń ţĥē màńĩƒēśţ ƒōŕ ŵēƀ ƥàŕţ {0}.","Ye":"ßōōţśţŕàƥ mōďũĺē ƒōŕ ŵēƀ ƥàŕţ {0} ĩś ńōţ ĺōàďēď. Mōďũĺē ńàmēś ēxƥōŕţēď ƀŷ ţĥē ƀũńďĺē àŕē \\u0027{1}\\u0027.","nt":"ßōōţśţŕàƥ mōďũĺē ƒōŕ ŵēƀ ƥàŕţ {0} ńōţ ōƒ ţĥē ćōŕŕēćţ ţŷƥē. Màķē śũŕē ţō ēxƥōŕţ ŷōũŕ ŵēƀ ƥàŕţ àś \\u0027ēxƥōŕţ ďēƒàũĺţ ŴēƀƤàŕţŃàmē\\u0027.","xD":"Ţĥē ćĺàśś ƒōŕ ŵēƀ ƥàŕţ {0} ĩś mĩśśĩńĝ àń ēxƥēćţēď mēmƀēŕ \\u0027{1}\\u0027.","Oq":"Ũńàƀĺē ţō ĺōàď ŵēƀ ƥàŕţ {0} śćŕĩƥţ ŕēśōũŕćēś ďũē ţō: {1}.","ZO":"Śēŕĩàĺĩźàţĩōń ƒàĩĺēď ƒōŕ ŵēƀ ƥàŕţ {0}.","TB":"ŕēńďēŕĆōmƥĺēţēď ĩś ńōţ ćàĺĺēď ƒōŕ àń àśŷńćĥŕōńōũśĺŷ ŕēńďēŕēď ŵēƀ ƥàŕţ {0}.","nN":"Àţţēmƥţēď ţō ćàĺĺ ƒĩŕśţ ţĩmē ŕēńďēŕ mōŕē ţĥàń ōńćē ƒōŕ ţĥē ŵēƀ ƥàŕţ {0}. Ƥĺēàśē ćōńţàćţ Mĩćŕōśōƒţ ďēvēĺōƥēŕ śũƥƥōŕţ ţō ŕēśōĺvē ţĥĩś.","MY":"Ĩńvàĺĩď ŚƤĹĨŃĶ àţţŕĩƀũţē vàĺũē {0}","PZ":"Ĩńvàĺĩď ŚƤĹĨŃĶ ĩńďēx vàĺũē {0}","bl":"Ĺōàďĩńĝ {0}...","CG":"ōńÀƒţēŕĎēśēŕĩàĺĩźē ƒōŕ ŵēƀ ƥàŕţ {0} ŕēţũŕńēď ńũĺĺ ōŕ ũńďēƒĩńēď.","$N":"ōńĨńĩţ mēţĥōď ƒōŕ ŵēƀ ƥàŕţ {0} ŕēţũŕńēď ńũĺĺ ōŕ ũńďēƒĩńēď Ƥŕōmĩśē.","lh":"{0} ŵēƀ ƥàŕţ","jD":"Śōmēţĥĩńĝ ŵēńţ ŵŕōńĝ","RB":"Ĩƒ ţĥē ƥŕōƀĺēm ƥēŕśĩśţś, ćōńţàćţ ţĥē śĩţē àďmĩńĩśţŕàţōŕ àńď ĝĩvē ţĥēm ţĥē ĩńƒōŕmàţĩōń ĩń Ţēćĥńĩćàĺ Ďēţàĩĺś.","SD":"Ţēćĥńĩćàĺ Ďēţàĩĺś","k6":"ĆÀĹĹ ŚŢÀĆĶ:{0}{1}","PQ":"ĒŔŔŌŔ:{0}{1}{0}{0}{2}{3}","NE":"Ţĥē ŵēƀ ƥàŕţ ŵàś mōďĩƒĩēď ƀŷ ţĥē Ƥàĝēś ÀƤĨ ({0}) ōń {1} àţ {2}.","zI":"Ŵēƀƥàŕţ {0} ĩś ŕēǫũēśţēď ţō ďēĺēţē.","T8":"Ţŕàńśƥĩĺē ńōţ ĩmƥĺēmēńţēď","Tz":"Ŵēƀƥàŕţ {0} ŕēńďēŕ ćàĺĺƀàćķ ƥŕōmĩśē ƒōŕ ŕēśōĺvē ōŕ ŕēĴēćţ ĩś ũńďēƒĩńēď.","f_":"Ŵēƀƥàŕţ {0} ŕēńďēŕ ţĩmēōũţ.","Ph":"Àũďĩēńćē ţàŕĝēţĩńĝ","cY":"Śēĺēćţ àũďĩēńćēś ţō ţàŕĝēţ ţĥĩś ćàŕď ţō.","dY":"Ţàŕĝēţ ţĥĩś ēńţĩŕē ŵēƀ ƥàŕţ ţō śƥēćĩƒĩć àũďĩēńćēś.","Dw":"{0} Ƥŕōƥēŕţĩēś","Y6":"Ćàŕď ĩś ńōţ àvàĩĺàƀĺē: {0}. Ĩţ mĩĝĥţ ĥàvē ƀēēń ŕēmōvēď ōŕ ƀĺōćķēď ƀŷ ţĥē Ţēàmś àďmĩńĩśţŕàţōŕ."}')}
},h={};function b(e){var t=h[e];if(void 0!==t)return t.exports;var n=h[e]={exports:{}};return _[e](n,n.exports,b),n.exports}b.m=_,b.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return b.d(t,{a:t}),t},b.d=(e,t)=>{for(var n in t)b.o(t,n)&&!b.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},b.f={},b.e=e=>Promise.all(Object.keys(b.f).reduce((t,n)=>(b.f[n](e,t),t),[])),b.u=e=>"chunk."+{183:"spfx-core-teamsenv-teamsJs-v2",426:"sp-webpart-base-iframedwebpartcontroller"}[e]+"_none_"+{183:"670327dd1b8dcb719237",426:"146c3d8957f77c4dd720"}[e]+".js",b.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),b.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),f={},p="974a7777-0990-4136-8fa6-95d80114c2e0_1.21.1:",b.l=(e,t,n,a)=>{if(f[e])f[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==p+n){i=c;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,b.nc&&i.setAttribute("nonce",b.nc),i.setAttribute("data-webpack",p+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous")),f[e]=[t];var d=(t,n)=>{i.onerror=i.onload=null,clearTimeout(l);var a=f[e];if(delete f[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),r&&document.head.appendChild(i)}},b.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},m=e?e.src:"",b.p=m.slice(0,m.lastIndexOf("/")+1),b.f.compat=(e,t)=>{for(var n=function(e){return{426:[{i:"8496636c-2300-4915-abef-20de64c98d8b",v:"1.21.1",m:737}]}[e]||[]}(e),a=0;a<n.length;a++)b.m[n[a].m]||(e=>{t.push(g.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{b.m[e.m]=e=>e.exports=t}))})(n[a])};var g=b(414);(()=>{var e={994:0};b.f.j=(t,n)=>{var a=b.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=b.p+b.u(t),o=new Error;b.l(r,n=>{if(b.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)b.o(o,a)&&(b.m[a]=o[a]);s&&s(b)}for(t&&t(n);c<r.length;c++)i=r[c],b.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_974a7777-0990-4136-8fa6-95d80114c2e0_1.21.1"]=self["webpackJsonp_974a7777-0990-4136-8fa6-95d80114c2e0_1.21.1"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var v={};return(()=>{b.r(v),b.d(v,{BaseClientSideWebPart:()=>J,BaseWebPart:()=>K,BaseWebPartContext:()=>i,CONTENT_PANEL_TOGGLED:()=>le,ClientSideWebPartManager:()=>ye,ClientSideWebPartManagerFactory:()=>De,DynamicDataSharedDepth:()=>F,PROPERTY_PANE_TOGGLED:()=>ue,PROPERTY_PANE_WILL_OPEN:()=>de,PropertyPaneAction:()=>H,PropertyPaneButton:()=>y,PropertyPaneButtonType:()=>T,PropertyPaneCheckbox:()=>S,PropertyPaneChoiceGroup:()=>D,PropertyPaneCustomField:()=>g,PropertyPaneDropdown:()=>I,PropertyPaneDropdownOptionType:()=>U,PropertyPaneDynamicField:()=>x,PropertyPaneDynamicFieldSet:()=>C,PropertyPaneDynamicTextField:()=>M,PropertyPaneFieldType:()=>P,PropertyPaneHorizontalRule:()=>O,PropertyPaneLabel:()=>w,PropertyPaneLink:()=>E,PropertyPaneSlider:()=>A,PropertyPaneTextField:()=>L,PropertyPaneToggle:()=>k,WebPartContext:()=>r,WebPartDataConverter:()=>Ie,WebPartFormFactor:()=>oe,WebPartIsolationLevel:()=>o,_AdaptiveCardExtensionWidthCalculator:()=>xe,_BaseWebPartHost:()=>u,_ClientSideWebPartStatusRenderer:()=>re,_IframedWebPartAction:()=>Ce.A,_MinimalWebPartContainer:()=>Oe,_MinimalWebPartHost:()=>f,_PropertyPaneLoader:()=>ee,_TeamsAwareWebPartHost:()=>m,_TeamsEnvironmentManager:()=>p,_WebPartWidthCacheManager:()=>q,_audienceFormServiceKey:()=>j,_getErrorAceLoadConfiguration:()=>me});var e=b(280),t=b(962),n=b(676);const a=function(){function e(e,t,n,a,i,r,o){this._open=e,this._close=t,this._refresh=n,this._openDetails=a,this._isRenderedByWebPart=i,this._isPropertyPaneOpen=r,this._isContentPanelOpen=o,this.open=this.open.bind(this),this.close=this.close.bind(this),this.refresh=this.refresh.bind(this),this.openDetails=this.openDetails.bind(this),this.isRenderedByWebPart=this.isRenderedByWebPart.bind(this)}return e.prototype.open=function(){this._open()},e.prototype.close=function(){this._close()},e.prototype.refresh=function(){this._refresh()},e.prototype.openDetails=function(e){this._openDetails(e)},e.prototype.isRenderedByWebPart=function(){return this._isRenderedByWebPart()},e.prototype.isPropertyPaneOpen=function(e){return this._isPropertyPaneOpen(e)},e.prototype.isContentPanelOpen=function(){var e;return!!(null===(e=this._isContentPanelOpen)||void 0===e?void 0:e.call(this))},e}(),i=function(t){function i(e){var i=t.call(this,e)||this;return n.Validate.isNotNullOrUndefined(e,"webpart context"),n.Validate.isNotNullOrUndefined(e.instanceId,"webpart context instanceId"),n.Validate.isNotNullOrUndefined(e.webPartTag,"webpart context webPartTag"),n.Validate.isNotNullOrUndefined(e.host,"webpart context host"),n.Validate.isNotNullOrUndefined(e.isPropertyPaneRenderedByWebPart,"webpart context isPropertyPaneRenderedByWebPart"),n.Validate.isNotNullOrUndefined(e.isPropertyPaneOpen,"webpart context isPropertyPaneOpen"),n.Validate.isNotNullOrUndefined(e.requestPropertyPaneAction,"webpart context requestPropertyPaneAction"),n.Validate.isNotNullOrUndefined(e.formFactor,"webpart context form factor"),i._webPartTag=e.webPartTag,i._host=e.host,i._requestPropertyPaneAction=e.requestPropertyPaneAction,i._isPropertyPaneRenderedByWebPart=e.isPropertyPaneRenderedByWebPart,i._isPropertyPaneOpen=e.isPropertyPaneOpen,i._isContentPanelOpen=e.isContentPanelOpen,i._privateDataUpdatedEvent=e._dataUpdatedEvent,i._formFactor=e.formFactor,i._propertyPaneAccessor=new a(function(){i._requestPropertyPaneAction(i.instanceId,"Open",!0)},function(){i._requestPropertyPaneAction(i.instanceId,"Close",!0)},function(){i._requestPropertyPaneAction(i.instanceId,"Refresh",!0)},function(e){i._requestPropertyPaneAction(i.instanceId,"OpenDetails",!0,e)},function(){return i._isPropertyPaneRenderedByWebPart()},function(e){return i._isPropertyPaneOpen(e)},function(){return i._isContentPanelOpen()}),i}return(0,e.__extends)(i,t),Object.defineProperty(i.prototype,"webPartTag",{get:function(){return this._webPartTag},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"propertyPane",{get:function(){return this._propertyPaneAccessor},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"formFactor",{get:function(){return this._formFactor},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"host",{get:function(){return this._host},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"_dataUpdatedEvent",{get:function(){return this._privateDataUpdatedEvent},enumerable:!1,configurable:!0}),i}(t.BaseComponentContext),r=function(t){function a(e){var a=t.call(this,e)||this;return n.Validate.isNotNullOrUndefined(e.domElement,"webpart context domElement"),n.Validate.isNotNullOrUndefined(e.statusRenderer,"webpart context statusRenderer"),a._domElement=e.domElement,a._statusRenderer=e.statusRenderer,a._pageLayoutType=e.pageLayoutType,a._teams=e.microsoftTeams,a._sdks=e.sdks,a._widthCacheKey=e.widthCacheKey,a._sdksAsync=e.sdksAsync,a._getPositionOnPage=e.getPositionOnPage,a}return(0,e.__extends)(a,t),Object.defineProperty(a.prototype,"domElement",{get:function(){return this._domElement},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"sdks",{get:function(){return this._sdks},enumerable:!1,configurable:!0}),a.prototype._getSdksAsync=function(){return this._sdksAsync},Object.defineProperty(a.prototype,"statusRenderer",{get:function(){return this._statusRenderer},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"microsoftTeams",{get:function(){return this._teams},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"widthCacheKey",{get:function(){return this._widthCacheKey},enumerable:!1,configurable:!0}),a.prototype._getPageLayoutType=function(){return this._pageLayoutType},a.prototype._setTeams=function(e){this._teams=e},a}(i);var o;!function(e){e.None="None",e.DomIsolation="DOMIsolation"}(o||(o={}));var s,c=b(952),d=b(408),l=b(207),u=function(){function e(e){this.serviceScope=e}return e.prototype.onBeforeWebPartLoad=function(e){d._PerformanceLogger.devMark("ClientSideWebPartManager.load(".concat(e.webPartTag,").start")),d._PerformanceLogger.startMarkForComponent(e.webPartTag)},e.prototype.onAfterWebPartLoad=function(e){d._PerformanceLogger.devMark("ClientSideWebPartManager.load(".concat(e.webPartTag,").end")),d._PerformanceLogger.markComponentModuleLoaded(e.webPartTag)},e.prototype.onAfterWebPartLoadFailed=function(e,t){d._PerformanceLogger.endFailureForComponent(e.webPartTag,"Load",t,void 0,"ViewMode WebPart Failure"),e.displayMode===n.DisplayMode.Edit&&e.manifest.isInternal&&e.serviceScope&&this._logFailuresForEditCustomerPromise(e.manifest.alias,t,"Load",e.serviceScope,(0,l.xT)()?"WebPart Load Failure":void 0,(0,l.xT)()?void 0:"WebPart Load Failure")},e.prototype.onBeforeWebPartInitializeOld=function(e){d._PerformanceLogger.devMark("ClientSideWebPartManager.initialize(".concat(e.webPartTag,").start"))},e.prototype.onBeforeWebPartInitialize=function(e){return d._PerformanceLogger.devMark("ClientSideWebPartManager.initialize(".concat(e.webPartTag,").start")),Promise.resolve()},e.prototype.onAfterWebPartInitialize=function(e){d._PerformanceLogger.devMark("ClientSideWebPartManager.initialize(".concat(e.webPartTag,").end"))},e.prototype.onAfterWebPartInitializeFailed=function(e,t){d._PerformanceLogger.endFailureForComponent(e.webPartTag,"Initialize",t),e.displayMode===n.DisplayMode.Edit&&e.manifest.isInternal&&e.serviceScope&&this._logFailuresForEditCustomerPromise(e.manifest.alias,t,"Initialize",e.serviceScope,(0,l.xT)()?"WebPart Init Failure":void 0,(0,l.xT)()?void 0:"WebPart Init Failure")},e.prototype.onBeforeWebPartRender=function(e){d._PerformanceLogger.devMark("ClientSideWebPartManager.render(".concat(e.webPartTag,").start"))},e.prototype.onAfterWebPartRender=function(e){"number"==typeof e.renderCompleteTime?d._PerformanceLogger.endMarkForComponentWithTimestamp(e.webPartTag,e.renderCompleteTime):d._PerformanceLogger.endMarkForComponent(e.webPartTag)},e.prototype.onAfterWebPartRenderFailed=function(e,t){if(d._PerformanceLogger.endFailureForComponent(e.webPartTag,"Render",t),e.displayMode===n.DisplayMode.Edit&&e.manifest.isInternal&&e.serviceScope)if((0,l.RC)())this._logFailuresForEditCustomerPromise(e.manifest.alias,t,"Render",e.serviceScope,void 0,(0,l.xT)()?void 0:"WebPart Render Failure");else{var a="";t.name&&(a+="name:"+t.name+";"),t.message&&(a+="msg:"+t.message+";"),e.webPartTag&&(a+="webPT:"+e.webPartTag+";"),e.domElement&&e.domElement.title&&(a+="domTitle:"+e.domElement.title+";"),e.manifest&&e.manifest.imagePreviewUrl&&(a+="previewImageUrl:"+e.manifest.imagePreviewUrl+";"),this._logFailuresForEditCustomerPromise(e.manifest.alias,t,"Render",e.serviceScope,a,"WebPart Render Failure")}},e.prototype.onAudiencesChanged=function(e,t){},e.prototype._logFailuresForEditCustomerPromise=function(e,t,n,a,i,r){if(!(0,l.RC)()&&i){var o={errorCode:"WebPartBase ".concat(e," Failure"),errorMessage:i,errorScenario:n,errorStack:null==t?void 0:t.stack,veto:r};(0,c._logFailuresForEditCustomerPromise)(o,a)}else o={errorCode:"WebPartBase ".concat(e," Failure"),errorMessage:t.message,errorScenario:n,errorStack:null==t?void 0:t.stack,veto:r},(0,c._logFailuresForEditCustomerPromise)(o,a)},e}(),f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n}(u),p=function(){function e(){}return e.initialize=function(){return!n._BrowserUtilities.isTeamsHosted()||e._teamsContext||e.sdkProvider?Promise.resolve():b.e(183).then(b.bind(b,732)).then(function(t){return t.initialize(),(n=t.getContext,new Promise(function(e,t){try{n(function(t){return e(t)})}catch(e){t(e)}})).then(function(n){e._teamsContext=n,e._teamsJs=t});var n})},e.getTeamsSDK=function(){return e.sdkProvider?e.sdkProvider:Promise.resolve({})},e.getTeamsContext=function(){return e._teamsContext},e.getTeamsJs=function(){return e._teamsJs},e}(),m=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype.getAdditionalContextProperties=function(){var e=p.getTeamsJs();return e?{microsoftTeams:{teamsJs:e,context:p.getTeamsContext()}}:{}},n.prototype.getAdditionalContextPropertiesAsync=function(){return p.getTeamsSDK()},n.prototype.onBeforeWebPartInitialize=function(e){return t.prototype.onBeforeWebPartInitialize.call(this,e).then(function(){return p.initialize()})},n}(f),_=b(588),h=b(529);function g(e){return function(e){return{type:s.Custom,targetProperty:void 0,properties:e}}(e)}function y(e,t){return function(e,t){return{type:s.Button,targetProperty:e,properties:t}}(e,t)}function S(e,t){return function(e,t){return{type:s.CheckBox,targetProperty:e,properties:t}}(e,t)}function D(e,t){return function(e,t){return{type:s.ChoiceGroup,targetProperty:e,properties:t}}(e,t)}function I(e,t){return function(e,t){return{type:s.Dropdown,targetProperty:e,properties:t}}(e,t)}function x(e,t){return function(e,t){return{type:s.DynamicField,targetProperty:e,properties:t}}(e,t)}function C(e){return function(e){return{type:s.DynamicFieldSet,targetProperty:"",properties:e}}(e)}function O(){return{type:s.HorizontalRule,targetProperty:void 0,properties:void 0}}function w(e,t){return function(e,t){return{type:s.Label,targetProperty:e,properties:t}}(e,t)}function E(e,t){return function(e,t){return{properties:t,type:s.Link,targetProperty:void 0}}(0,t)}function A(e,t){return function(e,t){return{type:s.Slider,targetProperty:e,properties:t}}(e,t)}function L(e,t){return function(e,t){return{type:s.TextField,targetProperty:e,properties:t}}(e,t)}function k(e,t){return function(e,t){return{type:s.Toggle,targetProperty:e,properties:t}}(e,t)}function M(e,t){return function(e,t){return{type:s.DynamicTextField,targetProperty:e,properties:t}}(e,t)}!function(e){e[e.Custom=1]="Custom",e[e.CheckBox=2]="CheckBox",e[e.TextField=3]="TextField",e[e.Toggle=5]="Toggle",e[e.Dropdown=6]="Dropdown",e[e.Label=7]="Label",e[e.Slider=8]="Slider",e[e.Heading=9]="Heading",e[e.ChoiceGroup=10]="ChoiceGroup",e[e.Button=11]="Button",e[e.HorizontalRule=12]="HorizontalRule",e[e.Link=13]="Link",e[e.DynamicField=14]="DynamicField",e[e.DynamicTextField=15]="DynamicTextField",e[e.DynamicFieldSet=16]="DynamicFieldSet",e[e.SpinButton=17]="SpinButton",e[e.ThumbnailPicker=18]="ThumbnailPicker",e[e.IconPicker=19]="IconPicker",e[e.AlternativeText=20]="AlternativeText",e[e.WebPartTitleHeading=21]="WebPartTitleHeading",e[e.SortableAccordion=22]="SortableAccordion"}(s||(s={}));var P,T,U,F,H={Open:1,Close:2,Toggle:3,Default:4,Refresh:5};!function(e){e[e.Custom=1]="Custom",e[e.CheckBox=2]="CheckBox",e[e.TextField=3]="TextField",e[e.Toggle=5]="Toggle",e[e.Dropdown=6]="Dropdown",e[e.Label=7]="Label",e[e.Slider=8]="Slider",e[e.Heading=9]="Heading",e[e.ChoiceGroup=10]="ChoiceGroup",e[e.Button=11]="Button",e[e.HorizontalRule=12]="HorizontalRule",e[e.Link=13]="Link",e[e.DynamicField=14]="DynamicField",e[e.DynamicTextField=15]="DynamicTextField",e[e.DynamicFieldSet=16]="DynamicFieldSet",e[e.SpinButton=17]="SpinButton",e[e.ThumbnailPicker=18]="ThumbnailPicker",e[e.IconPicker=19]="IconPicker",e[e.AlternativeText=20]="AlternativeText",e[e.WebPartTitleHeading=21]="WebPartTitleHeading",e[e.SortableAccordion=22]="SortableAccordion"}(P||(P={})),function(e){e[e.Normal=0]="Normal",e[e.Primary=1]="Primary",e[e.Hero=2]="Hero",e[e.Compound=3]="Compound",e[e.Command=4]="Command",e[e.Icon=5]="Icon"}(T||(T={})),function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header"}(U||(U={})),function(e){e[e.None=0]="None",e[e.Source=1]="Source",e[e.Property=2]="Property"}(F||(F={}));var R,N=b(729);!function(e){e[e.ModuleUndefined=0]="ModuleUndefined",e[e.ModuleNotLoaded=1]="ModuleNotLoaded",e[e.IncorrectBoostrapModule=2]="IncorrectBoostrapModule",e[e.MissingExpectedWebPartMemberError=3]="MissingExpectedWebPartMemberError",e[e.NonBaseWebPart=4]="NonBaseWebPart",e[e.ScriptLoadError=5]="ScriptLoadError",e[e.ManifestDownloadFailed=6]="ManifestDownloadFailed",e[e.ManifestNull=7]="ManifestNull",e[e.ManifestInvalid=8]="ManifestInvalid",e[e.BaseConstructError=9]="BaseConstructError",e[e.MustOverrideRender=10]="MustOverrideRender",e[e.NotInitializedError=11]="NotInitializedError",e[e.PropertyBagNull=12]="PropertyBagNull",e[e.OnAfterDeserializeReturnedNull=13]="OnAfterDeserializeReturnedNull",e[e.OnInitReturnedNullPromise=14]="OnInitReturnedNullPromise",e[e.ReadOnlyProperty=15]="ReadOnlyProperty",e[e.SerializationFailed=16]="SerializationFailed",e[e.FirstTimeRenderCalledMoreThanOnce=17]="FirstTimeRenderCalledMoreThanOnce",e[e.RenderCompletedCallNotCalled=18]="RenderCompletedCallNotCalled",e[e.InvalidSPLinkAttributeFormat=19]="InvalidSPLinkAttributeFormat",e[e.InvalidSPLinkIndex=20]="InvalidSPLinkIndex",e[e.GetDataReturnedNullPromise=21]="GetDataReturnedNullPromise",e[e.RenderPromiseUndefined=22]="RenderPromiseUndefined",e[e.RenderTimeout=23]="RenderTimeout",e[e.TranspileNotImplemented=24]="TranspileNotImplemented"}(R||(R={}));var B=function(t){function a(e,i){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var s=this,c=e;return c&&((s=t.call(this,R[c],n.Text.format(a._errorCodeToMessageMap.get(c),r),i)||this).__proto__=a.prototype,s._id=c),s}return(0,e.__extends)(a,t),Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"category",{get:function(){return"SPWebPartErrorCode"},enumerable:!1,configurable:!0}),a.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new a(e,void 0,t)},a.createWithLogProperties=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return new a(e,t,n)},a._errorCodeToMessageMap=new Map([[R.ModuleUndefined,N.$m],[R.ModuleNotLoaded,N.Ye],[R.IncorrectBoostrapModule,N.nt],[R.MissingExpectedWebPartMemberError,N.xD],[R.NonBaseWebPart,N.ou],[R.ScriptLoadError,N.Oq],[R.ManifestDownloadFailed,N.$f],[R.ManifestNull,N._4],[R.ManifestInvalid,N.qb],[R.BaseConstructError,N.X8],[R.MustOverrideRender,N.g0],[R.NotInitializedError,N.Sz],[R.PropertyBagNull,N.zd],[R.OnAfterDeserializeReturnedNull,N.CG],[R.OnInitReturnedNullPromise,N.$N],[R.ReadOnlyProperty,N.ik],[R.SerializationFailed,N.ZO],[R.FirstTimeRenderCalledMoreThanOnce,N.nN],[R.RenderCompletedCallNotCalled,N.TB],[R.InvalidSPLinkAttributeFormat,N.MY],[R.InvalidSPLinkIndex,N.PZ],[R.RenderPromiseUndefined,N.Tz],[R.RenderTimeout,N.f_],[R.TranspileNotImplemented,N.T8]]),a}(n.SPError),j=n.ServiceKey.createCustom("sp-property-pane.AudienceForm",function(e){return{}}),V=b(620),z="4eae8b0b-40f6-4ea9-aabb-b6834ae24532",G="f3bc67ee-015d-4678-a95f-c7e90ea62c1e";const K=function(a){function i(){var e=a.call(this)||this;if(e._initialized=!1,e._baseLogSource=_._LogSource.create("BaseWebPart"),e._hasEditLogged=!1,e._emptyResolvedPromise=Promise.resolve(),e._disposeDynamicPropertiesIfRequired=e._disposeDynamicPropertiesIfRequired.bind(e),e._onPropertyPaneFieldChanged=e._onPropertyPaneFieldChanged.bind(e),"BaseWebPart"===e.constructor.name)throw B.create(R.BaseConstructError);return e}return(0,e.__extends)(i,a),Object.defineProperty(i.prototype,"previewImageUrl",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"displayMode",{get:function(){return this._displayMode},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"modifiedByGraph",{get:function(){return this._modifiedByGraph},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dataVersion",{get:function(){return n.Version.parse("1.0")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"properties",{get:function(){if(this._initialized)return this._properties;throw B.create(R.NotInitializedError)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"propertiesMetadata",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"disableReactivePropertyChanges",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"accessibleTitle",{get:function(){return this._getDefaultAccessibleTitle()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"iconImageUrl",{get:function(){return this._iconImageUrl},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"description",{get:function(){return this._description},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"audiences",{get:function(){return this._audiences},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"_persistedProperties",{get:function(){return this.disableReactivePropertyChanges&&this._backupProperties?this._backupProperties:this.properties},enumerable:!1,configurable:!0}),i.prototype._getPropertyPaneData=function(e,t){var n=this;return this._loadPropertyPaneResources().then(function(){var a=e?n.getDetailsPaneConfiguration(t):n.getPropertyPaneConfiguration();return(n.context.manifest.id===G||(0,V.cr)()&&!a.disableAudiencePicker)&&n._addAudienceTargetingConfiguration(a),n._fixUpDynamicDataConfiguration(a),{webPartId:n.context.instanceId,title:n.title,isReactive:!n.disableReactivePropertyChanges,configuration:a,properties:n._cloneProperties(n.properties),onPropertyPaneFieldChanged:void 0,onConfigurationEvent:void 0,onRendered:n.onPropertyPaneRendered,dynamicConfiguration:{defaultCallback:function(){n._dynamicPropertyRefresh()}.bind(n),dynamicDataProvider:n.context.dynamicDataProvider}}})},i.prototype._loadPropertyPaneResources=function(){return this._loadPropertyPaneResourcesPromise||(this._loadPropertyPaneResourcesPromise=this.loadPropertyPaneResources()),this._loadPropertyPaneResourcesPromise},i.prototype._onPropertyPaneFieldChanged=function(e,n,a){var i,r,o,s=this,d=this.context.manifest.id===G?"ACE":"WebPart";try{var u=h.get(this._properties,e);if(!h.isEqual(u,n)||a===P.Button||a===P.Custom){if(!(0,l.df)()&&this.manifest.isInternal&&(o=new _._QosMonitorShareFailureWithCP("PropertyPane.".concat(d,".").concat(this.manifest.alias,".Update"),!1,[{errorModuleName:"".concat(d," PropertyPaneUpdate Failure"),veto:"WebPart Property Pane Failure",logFailure:this.context.serviceScope.consume(c._EditModeCustomerPromiseHandler.serviceKey).logFailure}])),this.disableReactivePropertyChanges&&!this._backupProperties&&(this._backupProperties=this._cloneProperties(this.properties)),u instanceof t.DynamicProperty&&!(n instanceof t.DynamicProperty)){var f=new t.DynamicProperty(this.context.dynamicDataProvider,function(){s._dynamicPropertyRefresh()}.bind(this));f.setValue(n),n=f}return e===z?(this._audiences=n,(0,V.cr)()&&(_._EngagementLogger.logEvent("".concat(d,".PropertyPane"),"AudienceUpdated"),null===(r=(i=this.context.host).onAudiencesChanged)||void 0===r||r.call(i,this.instanceId,n))):this._updateProperty(e,n),this.onPropertyPaneFieldChanged(e,u,n),this._afterPropertyUpdated(!this.disableReactivePropertyChanges),!(0,l.df)()&&o&&o.writeSuccess(),!0}}catch(e){throw!(0,l.df)()&&o&&o.writeUnexpectedFailure(e.message),e}return!1},i.prototype._onPropertyPaneLifeCycleEvent=function(e){var t=this;switch(this.context.host.propertyPaneLifeCycleEventCallback&&this.context.host.propertyPaneLifeCycleEventCallback(e,{webPartData:this._internalSerialize(),isPropertyPaneReactive:this._isPropertyPaneReactive()}),e){case"ConfigurationStart":this._loadPropertyPaneResources().then(function(){return t.onPropertyPaneConfigurationStart()}).catch(function(e){return _._TraceLogger.logVerboseData({source:t._baseLogSource,message:e.message})});break;case"ConfigurationComplete":this.disableReactivePropertyChanges&&this._backupProperties&&(this._properties=this._backupProperties,this._backupProperties=void 0),this.onPropertyPaneConfigurationComplete();break;case"ApplyClicked":this._backupProperties=this.properties,this._onPropertyPaneChangesApplied().then(function(){t.onAfterPropertyPaneChangesApplied(),t._afterPropertyUpdated(!0)}).catch(function(e){throw _._TraceLogger.logVerboseData({source:t._baseLogSource,message:e.message}),e})}},i.prototype._isPropertyPaneReactive=function(){return!this.disableReactivePropertyChanges},i.prototype._internalSerialize=function(){var e,a=this;return function(e,t,a){n.Validate.isNotNullOrUndefined(e,"method");try{e()}catch(e){throw a&&_._TraceLogger.logError(a,new Error("Error: "+e)),t.innerError=e,t}}(function(){a.onBeforeSerialize();var i=JSON.stringify(a.properties);if(!a._hasEditLogged&&a._initPropertiesSnapshot!==i){var r=!!a.context.manifest.isInternal,o=new _._LogEntry(a._baseLogSource.id,"WebPartEdited",_._LogType.Event,{alias:a.context.manifest.alias,isInternal:r.toString()});_._EngagementLogger.logEventWithLogEntry(o),a._hasEditLogged=!0}var s=a._serialize();n.Validate.isNotNullOrUndefined(s.dataVersion,"serialized data version"),i&&-1!==i.indexOf(t.DynamicProperty._TYPE_NAME)&&a._serializeDynamicData(s),e={id:a.context.manifest.id,instanceId:a.context.instanceId,title:a.title,description:a.description,audiences:a.audiences,serverProcessedContent:s.serverProcessedContent,dynamicDataPaths:s.dynamicDataPaths,dynamicDataValues:s.dynamicDataValues,dataVersion:s.dataVersion.toString(),properties:s.properties},(0,l.$l)()||(e.containsDynamicDataSource=a._containsDynamicDataSource)},B.create(R.SerializationFailed,this.context.webPartTag),this._baseLogSource),e},i.prototype._internalDispose=function(){this._disposeDynamicPropertiesIfRequired(),a.prototype.dispose.call(this)},i.prototype._internalOnAfterResize=function(){},i.prototype._internalSetWebPartData=function(e,t){var n=this.properties;this._previousState=void 0,void 0!==t&&(this._renderedFromPersistedData=t),this._internalDeserialize(e),this.onAfterPropertiesUpdatedExternally(n)},i.prototype._internalSetDisplayMode=function(e){if(this._displayMode!==e){var t=this._displayMode;this._displayMode=e,this.onDisplayModeChanged(t)}},i.prototype._internalSetDirtyBit=function(){if(this.displayMode!==n.DisplayMode.Read){var e=this._internalSerialize(),t=JSON.stringify(e);this._previousState?this._previousState!==t&&this.context.host.setDirty&&(this.context.host.setDirty(this.context.instanceId,e),this._previousState=t):this._previousState=t}},i.prototype._internalInitialize=function(e,t,i){if(n.Validate.isNotNullOrUndefined(e,"webPartContext"),function(e){if(e){Object.isFrozen(e)||Object.freeze(e);var t=0,n=function(e){++t>5||Object.getOwnPropertyNames(e).forEach(function(t){var a=e[t];"object"!=typeof a||!a||h.isElement(a)||Object.isFrozen(a)||n(a)})};n(e)}}(e.manifest),a.prototype._initializeContext.call(this,e),this.onDispose=this.onDispose.bind(this),this.onPropertyPaneRendered=this.onPropertyPaneRendered.bind(this),this._initialized=!0,this._displayMode=i,this._renderedFromPersistedData=t,!this._renderedFromPersistedData){var r=this.context.manifest.isInternal||!1,o=new _._LogEntry(this._baseLogSource.id,"WebPartAdded",_._LogType.Event,{alias:this.context.manifest.alias,isInternal:r.toString()});_._EngagementLogger.logEventWithLogEntry(o)}},i.prototype._internalDeserialize=function(e){if(e=h.cloneDeep(e)){this._previousState||(this._previousState=JSON.stringify(e)),e.title&&(this._title=e.title),e.modifiedByGraph&&(this._modifiedByGraph=e.modifiedByGraph),e.description&&(this._description=e.description),e.iconImageUrl&&(this._iconImageUrl=e.iconImageUrl),this._audiences=e.audiences||[],"string"!=typeof e.dataVersion&&(e.dataVersion=this.dataVersion.toString());var t={properties:e.properties,serverProcessedContent:e.serverProcessedContent,dynamicDataPaths:e.dynamicDataPaths,dynamicDataValues:e.dynamicDataValues,dataVersion:n.Version.tryParse(e.dataVersion)},a=(0,V.Yv)(),i=void 0;a&&(i=this._reInstateServerProcessedData(t.properties,t.serverProcessedContent)),(0,l.$l)()||(t.containsDynamicDataSource=e.containsDynamicDataSource,this._containsDynamicDataSource=!!t.containsDynamicDataSource),this._deserializeDynamicData(t),this._initializeDynamicPropertiesIfRequired(t.properties),a||(i=this._reInstateServerProcessedData(t.properties,t.serverProcessedContent));var r=this.onAfterDeserialize(i,t.dataVersion);if(this._initPropertiesSnapshot=JSON.stringify(i),!r)throw B.create(R.OnAfterDeserializeReturnedNull,this.context.webPartTag);this._properties=r}},i.prototype.getTopActionsConfiguration=function(){},i.prototype._checkA11y=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){return[2,Promise.resolve([void 0])]})})},i.prototype._preOnClickA11yResult=function(e){},i.prototype.onInit=function(){return Promise.resolve(void 0)},i.prototype.onDisplayModeChanged=function(e){},i.prototype.onBeforeSerialize=function(){},i.prototype.onAfterDeserialize=function(e,t){return e},i.prototype.loadPropertyPaneResources=function(){return this._emptyResolvedPromise},i.prototype.getPropertyPaneConfiguration=function(){return{pages:[]}},i.prototype.getDetailsPaneConfiguration=function(e){return{pages:[]}},i.prototype.onDispose=function(){},i.prototype.onPropertyPaneFieldChanged=function(e,t,n){},i.prototype.onPropertyPaneConfigurationStart=function(){},i.prototype.onPropertyPaneConfigurationComplete=function(){},i.prototype.onAfterPropertyPaneChangesApplied=function(){},i.prototype.onPropertyPaneRendered=function(){},i.prototype.onAfterPropertiesUpdatedExternally=function(e){return this._refresh()},i.prototype._internalGetData=function(){return this._emptyResolvedPromise},i.prototype._getDefaultAccessibleTitle=function(){return n.Text.format(N.lh,this.title)},i.prototype._onPropertyPaneChangesApplied=function(){return Promise.resolve(this._properties)},i.prototype._reInstateServerProcessedData=function(e,n){var a=this.propertiesMetadata;if(!e)return{};var i=e;return!(0,V.Yv)()&&n||this._renderedFromPersistedData?(t._PropertyMetadataProcessor.reInstateServerProcessedData(a,i,n,this.context.manifest),i):i},i.prototype._forEachPropertyWithMetaData=function(e,t){if(this.propertiesMetadata)for(var n=function(n,i){a._validateAndIteratePath(n,t||a.properties,function(t,n){e(t,i,n)})},a=this,i=0,r=Object.entries(this.propertiesMetadata);i<r.length;i++){var o=r[i];n(o[0],o[1])}},i.prototype._validateAndIteratePath=function(e,t,n){var a=(e.match(/\*/g)||[]).length;if(a>1)console.warn("Invalid property path: Multiple wildcards are not supported in property paths.\nEntry with path '".concat(e,"' got ignored in the properties metadata."));else if(1===a){var i=e.indexOf("[*]");if(i<-1)return void console.warn("Invalid property path: Wildcards are only supported inside brackets to select array\nindices as in 'foo[*].bar'. Entry with path '".concat(e,"' got ignored in the properties metadata."));var r=e.substr(0,i),o=h.get(t,r);if(!o)return void console.warn("Invalid property path: Could not find an array named '".concat(r,"' in the properties.\nEntry with path '").concat(e,"' got ignored in the properties metadata."));for(var s=0;s<o.length;s++)n(e.replace("*","".concat(s)),s)}else n(e)},i.prototype._afterPropertyUpdated=function(e){this._internalSetDirtyBit(),e&&this._refresh()},i.prototype._fixUpDynamicDataConfiguration=function(e){var t=this;e.pages.forEach(function(e){e.groups.forEach(function(e){if("primaryGroup"in e){var n=e,a=n.primaryGroup,i=n.secondaryGroup;e=n.showSecondaryGroup?i:a}(e=e).groupFields.forEach(function(e){if(e.type===P.DynamicTextField){var n=e.properties;n.dynamicDataProvider=t.context.dynamicDataProvider,n.changeCallback=function(){t._dynamicPropertyRefresh()}.bind(t)}})})})},i.prototype._addAudienceTargetingConfiguration=function(e){var t,n;e.pages&&0!==e.pages.length||(e.pages=[{groups:[]}]);var a=this.context.serviceScope.consume(j);if(a&&a.renderAudienceFormPropertyPaneField){var i=this.context.manifest.id===G,r={groupName:N.Ph,groupFields:[a.renderAudienceFormPropertyPaneField({pageContext:this.context.pageContext.legacyPageContext,audiences:this.audiences,limit:50,propertyName:z,helpLink:i?"https://go.microsoft.com/fwlink/?linkid=2155166":"https://go.microsoft.com/fwlink/?linkid=2134207",tooltipText:i?N.cY:N.dY})]};if((0,l.a1)())e.pages[0].groups.push(r);else{var o=e.pages[0],s=(0,l.SC)()?(null===(n=e.audiencePickerPosition)||void 0===n?void 0:n.columnIndex)||1:null===(t=e.audiencePickerPosition)||void 0===t?void 0:t.columnIndex;o&&void 0!==o.columns&&s&&s<o.columns.length?o.columns[s].push(r):e.pages[0].groups.push(r)}}},i.prototype._serialize=function(){var e={htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},n=this._cloneProperties(this._persistedProperties);return h.set(n,"",void 0),t._PropertyMetadataProcessor.serializeServerProcessedData(this.propertiesMetadata,n,e),{dataVersion:this.dataVersion,properties:n,serverProcessedContent:e}},i.prototype._serializeDynamicData=function(e){for(var n=e.properties,a={},i={},r=h.findKey(n,{__type:t.DynamicProperty._TYPE_NAME});r;){var o=h.get(n,r+".reference"),s=h.get(n,r+".value");if(o)a[r]=o,h.unset(n,r);else{if(void 0===s)throw new Error("Dynamic Data is misconfigured");i[r]=s,h.unset(n,r)}r=h.findKey(n,{__type:t.DynamicProperty._TYPE_NAME})}e.dynamicDataPaths=a,e.dynamicDataValues=i},i.prototype._deserializeDynamicData=function(e){var n=this;if(e.dynamicDataPaths)for(var a in e.dynamicDataPaths)e.dynamicDataPaths.hasOwnProperty(a)&&((i=new t.DynamicProperty(this.context.dynamicDataProvider,function(){n._dynamicPropertyRefresh()}.bind(this))).setReference(e.dynamicDataPaths[a]),h.set(e.properties,a,i));if(e.dynamicDataValues)for(var a in e.dynamicDataValues){var i;e.dynamicDataValues.hasOwnProperty(a)&&((i=new t.DynamicProperty(this.context.dynamicDataProvider,function(){n._dynamicPropertyRefresh()}.bind(this))).setValue(e.dynamicDataValues[a]),h.set(e.properties,a,i))}},i.prototype._initializeDynamicPropertiesIfRequired=function(e){var n=this,a=new Map([["boolean",!1],["number",0],["string",""],["array",[]],["object",{}]]);this._forEachPropertyWithMetaData(function(i,r){if(r.dynamicPropertyType){var o=h.get(e,i);if(!(o instanceof t.DynamicProperty)){var s=void 0;r.dynamicPropertyType,s=new t.DynamicProperty(n.context.dynamicDataProvider,function(){n._dynamicPropertyRefresh()}.bind(n)),o=o||a.get(r.dynamicPropertyType),s.setValue(o),h.set(e,i,s)}}},e)},i.prototype._disposeDynamicPropertiesIfRequired=function(){var e=this;this._forEachPropertyWithMetaData(function(n,a){if(a.dynamicPropertyType){var i=h.get(e._persistedProperties,n);i instanceof t.DynamicProperty&&i.dispose()}},this._persistedProperties)},i.prototype._updateProperty=function(e,t){h.update(this.properties,e,function(){return t})},i.prototype._cloneProperties=function(e){return h.cloneDeepWith(e,function(e){if(e instanceof t.DynamicProperty)return e._cloneDeep(e)})},i}(t.BaseComponent),W=function(){function e(){}return e.disableAutomaticPostbacks=function(e,t){n.Validate.isNotNullOrUndefined(e,"domElement"),t===n.EnvironmentType.ClassicSharePoint&&(e.addEventListener("click",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},!0),e.addEventListener("keydown",function(e){13===e.keyCode&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},!0))},e.removeFabricLinks=function(){var e=document.getElementsByTagName("link");if(e&&e.length)for(var t=0;t<e.length;t++)if(e[t]&&-1!==e[t].href.indexOf("fabric.min.css")){var n=e[t].parentNode;n&&n.removeChild(e[t])}},e}(),q=function(){function e(){}return e.get=function(t){return e._sectionWidthCache.get(t)},e.getOrCalculateWidth=function(t,n){if(void 0===n)return e.calculateWebPartWidth(t);var a=e.get(n);return void 0===a&&(a=e.calculateWebPartWidth(t))>0&&e._put(n,a),a},e.clear=function(){e._sectionWidthCache.clear()},e.calculateWebPartWidth=function(e){var t=n._BrowserDetection.getBrowserInformation().browser;return t===n._Browser.Edge||t===n._Browser.IE?e.getBoundingClientRect().width:parseFloat(window.getComputedStyle(e).width)||0},e._put=function(t,n){e._sectionWidthCache.set(t,n)},e._sectionWidthCache=new Map,e}();var Q=b(424);Q.loadStyles(".a_a_7caff1a1{display:inline-block;left:0;overflow:hidden;padding:12px 0;position:relative;right:0;top:0;z-index:1}[dir=ltr] .a_a_7caff1a1{text-align:left}[dir=rtl] .a_a_7caff1a1{text-align:right}.b_a_7caff1a1{color:#605e5c;display:inline-block;font-weight:700;position:relative;white-space:pre-wrap}.c_a_7caff1a1{background:none;border:none;color:#0078d4;margin-top:20px;text-transform:uppercase}[dir=ltr] .c_a_7caff1a1{padding-left:0}[dir=rtl] .c_a_7caff1a1{padding-right:0}.e_a_7caff1a1{color:#0078d4;font-weight:400}.f_a_7caff1a1{color:#0078d4;font-weight:700}.g_a_7caff1a1{border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;text-indent:-9999px;width:1px}",!0);const Y="a_a_7caff1a1",J=function(a){function i(){var e=a.call(this)||this;if(e._logSource=_._LogSource.create("BaseClientSideWebPart"),e._asyncRenderQosMonitor=new _._QosMonitor("WebPartAsyncRender"),e._asyncRenderCompleteCalled=!1,e._isVisible=!0,e._internalIsDisposing=!1,"BaseClientSideWebPart"===e.constructor.name)throw B.create(R.BaseConstructError);return e._firstTimeRenderPromises=[],e}return(0,e.__extends)(i,a),Object.defineProperty(i.prototype,"domElement",{get:function(){return this.context.domElement},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.displayMode===n.DisplayMode.Read?this._width=q.getOrCalculateWidth(this.domElement,this._getExtendedWidthCacheKey()):void 0===this._width&&(this._width=q.calculateWebPartWidth(this.domElement)),this._width},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"renderedOnce",{get:function(){return!!this._renderedOnce},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"renderedFromPersistedData",{get:function(){return!!this._renderedFromPersistedData},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"canOpenPopupOnRender",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isRenderAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isVisible",{get:function(){return this.displayMode===n.DisplayMode.Edit||this._isVisible},set:function(e){var t,a;this.displayMode!==n.DisplayMode.Edit&&e!==this._isVisible&&(this._isVisible=e,null===(a=(t=this.context.host).onAfterWebPartVisibilityChanged)||void 0===a||a.call(t,this.context.instanceId,e))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"_isDisposing",{get:function(){return this._internalIsDisposing},enumerable:!1,configurable:!0}),i.prototype._internalOnAfterResize=function(){this._width=void 0,this.onAfterResize(this.width)},i.prototype._internalFirstTimeRender=function(){var e=this;if(this._renderPromiseResolver)throw B.create(R.FirstTimeRenderCalledMoreThanOnce,this.context.webPartTag);return new Promise(function(t,n){e._renderPromiseResolver=t,e._renderPromiseRejecter=n,e._onInViewport()})},i.prototype._internalSetDisplayMode=function(e){this.displayMode!==e&&(this._width=void 0,this._renderedFromPersistedData=!0),a.prototype._internalSetDisplayMode.call(this,e)},i.prototype._internalTranspile=function(e){return this.onTranspile(e)},i.prototype._internalInitialize=function(e,n,i){a.prototype._internalInitialize.call(this,e,n,i),this._renderedOnce=!1,this.__type="BaseClientSideWebPart",this.render=this.render.bind(this),this.onDispose=this.onDispose.bind(this),this.onTranspile=this.onTranspile.bind(this),this.renderError=this.renderError.bind(this),this.clearError=this.clearError.bind(this),this.renderCompleted=this.renderCompleted.bind(this),this._asyncRenderTimeout=this._asyncRenderTimeout.bind(this),this._internalHandleThemeChangedEvent=this._internalHandleThemeChangedEvent.bind(this),this._internalThemeProvider=this.context.serviceScope.consume(t.ThemeProvider.serviceKey),this._internalThemeVariant=this._internalThemeProvider.tryGetTheme(),this.onThemeChanged(this._internalThemeVariant),this._internalThemeProvider.themeChangedEvent.add(this,this._internalHandleThemeChangedEvent)},i.prototype._internalDispose=function(){var e;this._disposeAfterRenderPromises(),null===(e=this._internalThemeProvider)||void 0===e||e.themeChangedEvent.remove(this,this._internalHandleThemeChangedEvent)},i.prototype.onTranspile=function(e){throw B.create(R.TranspileNotImplemented)},i.prototype.renderCompleted=function(e,t){e?this._handleAsyncRenderFailed(e):this._renderCompleted(t)},i.prototype.onDisplayModeChanged=function(e){var t=this;a.prototype.onDisplayModeChanged.call(this,e),e!==this.displayMode&&Promise.all(this._firstTimeRenderPromises).then(function(){return t._renderWithAccessibleTitle()}).catch(function(e){return _._TraceLogger.logVerboseData({source:t._logSource,message:e.message})})},i.prototype.onDispose=function(){},i.prototype.onAfterResize=function(e){},i.prototype.onThemeChanged=function(e){},i.prototype.renderError=function(e){if(this.context.statusRenderer.clearLoadingIndicator(this.domElement),this.context.statusRenderer.renderError(this.domElement,e),this.displayMode===n.DisplayMode.Edit&&this.context.manifest.isInternal&&this.context.serviceScope&&((0,l.hH)()||!this.isDisposed)){var t="";(0,l.RC)()?t=e.message:(e.name&&(t+="name:"+e.name+";"),e.message&&(t+="msg:"+e.message+";"),this.context&&this.context.webPartTag&&(t+="webPT:"+this.context.webPartTag+";"),this.iconImageUrl&&(t+="iconImageUrl:"+this.iconImageUrl+";"),this.title&&(t+="title:"+this.title+";"),this.previewImageUrl&&(t+="previewImageUrl:"+this.previewImageUrl+";"),this.context&&this.context.pageContext&&this.context.pageContext.web&&this.context.pageContext.web.absoluteUrl&&(t+="absUrl:"+this.context.pageContext.web.absoluteUrl+";"));var a={errorCode:"WebPartBase ".concat(this.context.manifest.alias," Failure"),errorMessage:t,errorScenario:"Render",errorStack:null==e?void 0:e.stack,veto:"WebPart Render Failure"};(0,c._logFailuresForEditCustomerPromise)(a,this.context.serviceScope)}_._TraceLogger.logError(this._logSource,e)},i.prototype.clearError=function(){this.context.statusRenderer.clearError(this.domElement)},i.prototype._refresh=function(){this._renderWithAccessibleTitle()},i.prototype._dynamicPropertyRefresh=function(){this.renderedOnce&&this.render()},i.prototype._disposeAfterRenderPromises=function(){var e=this;this.isDisposed||(0,l.me)()||!(0,V.dQ)()?a.prototype._internalDispose.call(this):(this._internalIsDisposing=!0,Promise.all(this._firstTimeRenderPromises).then(function(){e._internalIsDisposing=!1,a.prototype._internalDispose.call(e)},function(t){var n=t.message;_._TraceLogger.logVerboseData({source:e._logSource,message:n}),e._internalIsDisposing=!1,a.prototype._internalDispose.call(e)}))},i.prototype._getExtendedWidthCacheKey=function(){var e=this.context.widthCacheKey;return e?"".concat(this.displayMode,"-").concat(e):void 0},i.prototype._onInViewport=function(){var e=this;if(!this._renderPromiseResolver||!this._renderPromiseRejecter)throw B.create(R.RenderPromiseUndefined,this.context.webPartTag);var t=this.onInit();if(!t){var n=B.create(R.OnInitReturnedNullPromise,this.context.webPartTag);return this._renderPromiseRejecter(n),void this._clearRenderPromises()}this._firstTimeRenderPromises.push(t),t.then(function(){d._PerformanceLogger.markComponent(e.context.webPartTag,"init");var t=Promise.resolve();if(!(t=e._internalGetData()))throw B.create(R.GetDataReturnedNullPromise,e.context.webPartTag);return e._firstTimeRenderPromises.push(t),t.then(function(){d._PerformanceLogger.markComponent(e.context.webPartTag,"getDataComplete"),e.context.statusRenderer.clearLoadingIndicator(e.domElement),e.isRenderAsync&&e._startAsyncRenderGuardTimer(),e._renderWithAccessibleTitle(),d._PerformanceLogger.markComponent(e.context.webPartTag,"syncRender"),!(0,l.z)()&&e.isRenderAsync?e._syncRenderTime=d._PerformanceLogger.now():e._resolveOrRejectOnRenderPromise()})}).catch(function(t){e._renderPromiseRejecter&&(e._renderPromiseRejecter(t),e._clearRenderPromises())})},i.prototype._renderWithAccessibleTitle=function(){d._PerformanceLogger.devMark("webpart(".concat(this.context.webPartTag,")._renderWithAccessibleTitle"));var e=(0,l.OL)()?this.domElement:this.domElement.parentElement;if(this.render(),this.displayMode===n.DisplayMode.Edit){var t=this.accessibleTitle||this._getDefaultAccessibleTitle();if(t){var a="cswpAccessibleLabelContextual_".concat(this.context.instanceId),i=e.querySelector("#".concat(a)),r=!i;r&&((i=document.createElement("div")).id=a,i.className="g_a_7caff1a1",i.setAttribute("aria-hidden","true")),i.textContent=t,r&&e.appendChild(i)}W.disableAutomaticPostbacks(this.domElement,n.Environment.type)}},i.prototype._startAsyncRenderGuardTimer=function(){var e=this;this._clearAsyncRenderGuardTimer(),this._asyncRenderGuardTimer=window.setTimeout(function(){e._asyncRenderTimeout()},25e3),(0,l.sK)()||!0!==this._asyncRenderCompleteCalled||(this._renderCompleted(this._asyncRenderCompleteDidUpdate),this._asyncRenderCompleteCalled=!1,this._asyncRenderCompleteDidUpdate=void 0)},i.prototype._renderCompleted=function(e){this._asyncRenderGuardTimer?(this._clearAsyncRenderGuardTimer(),this._asyncRenderQosMonitor.writeSuccess({alias:this.context.manifest.alias,isInternal:this.context.manifest.isInternal,webPartId:this.context.manifest.id}),(0,l.z)()?this._resolveOrRejectOnRenderPromise():this._resolveOrRejectOnRenderPromise(void 0,e)):(0,l.sK)()||(this._asyncRenderCompleteCalled=!0,this._asyncRenderCompleteDidUpdate=e)},i.prototype._handleAsyncRenderFailed=function(e){this._asyncRenderGuardTimer&&(this._clearAsyncRenderGuardTimer(),this._logAsyncRenderError(e,"Failed"),this._resolveOrRejectOnRenderPromise(e))},i.prototype._asyncRenderTimeout=function(){if(this._asyncRenderGuardTimer){this._clearAsyncRenderGuardTimer();var e=B.create(R.RenderCompletedCallNotCalled,this.context.webPartTag);this._logAsyncRenderError(e,"Timeout"),this._resolveOrRejectOnRenderPromise()}},i.prototype._logAsyncRenderError=function(e,t){_._TraceLogger.logErrorData({source:this._logSource,error:e,serviceScope:this.context.serviceScope}),this._asyncRenderQosMonitor.writeUnexpectedFailure(t,e,{alias:this.context.manifest.alias,isInternal:this.context.manifest.isInternal,webPartId:this.context.manifest.id,instanceId:this.instanceId})},i.prototype._clearAsyncRenderGuardTimer=function(){this._asyncRenderGuardTimer&&(window.clearTimeout(this._asyncRenderGuardTimer),this._asyncRenderGuardTimer=void 0)},i.prototype._resolveOrRejectOnRenderPromise=function(e,t){this._renderedOnce=!0,d._PerformanceLogger.devMark("webpart(".concat(this.context.webPartTag,").complete")),e?this._renderPromiseRejecter&&this._renderPromiseRejecter(e):this._renderPromiseResolver&&this._renderPromiseResolver((0,l.z)()||t?d._PerformanceLogger.now():this._syncRenderTime),this._clearRenderPromises()},i.prototype._clearRenderPromises=function(){this._renderPromiseResolver=void 0,this._renderPromiseRejecter=void 0,this.domElement.style.minHeight=null},i.prototype._internalHandleThemeChangedEvent=function(e){this._internalThemeVariant=e.theme,this.onThemeChanged(this._internalThemeVariant),this.onThemeChanged!==i.prototype.onThemeChanged&&this.render()},i}(K);var X=b(909),Z=b(414),$=b(27);const ee=function(){function e(){this._logSource=_._LogSource.create("PropertyPaneLoader")}return Object.defineProperty(e.prototype,"propertyPane",{get:function(){var t=this;if(this._propertyPaneController)return Promise.resolve(this._propertyPaneController);var n=new _._QosMonitor("PropertyPaneLoader.loadPropertyPaneModule");return Z.SPComponentLoader.loadComponentById(e._propertyPaneModuleId).then(function(e){return t._propertyPaneController||(t._propertyPaneController=new e._ConfigurableOptionsController),Promise.resolve(t._propertyPaneController)}).catch(function(e){return _._TraceLogger.logErrorData({source:t._logSource,error:e}),n.writeUnexpectedFailure("UnhandledError",e),Promise.reject(e)})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this._propertyPaneController},enumerable:!1,configurable:!0}),e.serviceKey=n.ServiceKey.create("sp-webpart-base:PropertyPaneLoader",e),e._propertyPaneModuleId="f9e737b7-f0df-4597-ba8c-3060f82380db",e}();function te(e,t){n.Validate.isNotNullOrUndefined(e,"method");try{e()}catch(e){t&&_._TraceLogger.logError(t,new Error("Error: "+e))}}const ne=function(){function e(e){this._props=e}return e.prototype.render=function(){var e=document.createElement("div");e.className=Y,e.setAttribute("role","alert"),e.setAttribute("aria-live","assertive");var t=document.createElement("span");return t.className="b_a_7caff1a1",t.innerText=this._props.errorMessage,e.appendChild(t),e},e}(),ae=function(){function e(e){this._toggleExpandedDetails=this._toggleExpandedDetails.bind(this),this._errorMessage=new ne(e).render(),this._errorMessage.style.display="none"}return e.prototype.render=function(){var e=document.createElement("div");e.className=Y;var t=document.createElement("div"),n=document.createElement("h2");n.className="e_a_7caff1a1",n.innerText=N.jD,t.appendChild(n),e.appendChild(n);var a=document.createElement("span");a.className="f_a_7caff1a1",a.innerText=N.RB,e.appendChild(a);var i=document.createElement("div"),r=document.createElement("button");return r.className="c_a_7caff1a1",r.innerText=N.SD,r.onclick=this._toggleExpandedDetails,i.appendChild(r),e.appendChild(i),e.appendChild(this._errorMessage),e},e.prototype._toggleExpandedDetails=function(){"none"===this._errorMessage.style.display?this._errorMessage.style.display="":this._errorMessage.style.display="none"},e}();Q.loadStyles('@keyframes l_b_7caff1a1{0%{transform:rotate(-45deg)}to{transform:rotate(315deg)}}.h_b_7caff1a1{padding:164px 0;position:relative;width:100%}.i_b_7caff1a1{height:20px;margin:auto;position:relative;width:20px}.j_b_7caff1a1,.k_b_7caff1a1{position:absolute}.j_b_7caff1a1{color:"[theme:themeLight, default: #c7e0f4]";z-index:0}.k_b_7caff1a1{animation:l_b_7caff1a1 1.5s infinite;animation-timing-function:easeInOutCirc;z-index:10}.k_b_7caff1a1,.m_b_7caff1a1{color:"[theme:themePrimary, default: #0078d4]"}.m_b_7caff1a1{margin-top:10px;text-align:center}.n_b_7caff1a1{border-width:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}',!0);const ie=function(){function e(){}return e.createSpinner=function(e){var t=document.createElement("div");t.className="h_b_7caff1a1";var n=document.createElement("div");n.className="i_b_7caff1a1",n.innerHTML="<svg class=".concat("k_b_7caff1a1",' xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 21">\n      <defs>\n        <style>\n          .slice {\n            fill: none;\n            stroke: currentColor;\n            stroke-miterlimit:10;\n            stroke-width:2px;\n          }\n        </style>\n      </defs>\n      <path class="slice" d="M17.5,6.5a10,10,0,0,1,10,10" transform="translate(-7 -6)"/>\n    </svg>\n    <svg class=').concat("j_b_7caff1a1",' xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 21">\n      <defs>\n        <style>\n          .ring {\n            fill: none;\n            stroke: currentColor;\n            stroke-miterlimit:10;\n            stroke-width:2px;\n          }\n        </style>\n      </defs>\n      <path class="ring" d="M10,0A10,10,0,1,1,0,10,10,10,0,0,1,10,0Z" transform="translate(0.5 0.5)"/>\n  </svg>'),t.appendChild(n);var a=document.createElement("div");a.className="m_b_7caff1a1",a.innerText=e,t.appendChild(a);var i=document.createElement("div");i.setAttribute("role","status"),i.setAttribute("aria-live","polite");var r=document.createElement("div");return r.className="n_b_7caff1a1",r.innerText=e,i.appendChild(r),t.appendChild(i),t},e}(),re=function(){function e(){this._errorId="cswp-error",this._activeIndicatorCache=new Map}return e._getAdditionalTimeOut=function(e){var t=d._PerformanceLogger.readComponentBreakdown(e,"loadingDelayed"),n=d._PerformanceLogger.readComponentBreakdown(e,"inViewPortLoading");return t&&n?n-t:t?500:0},e.prototype.displayLoadingIndicator=function(e,t,n,a){this._logEngagement(e,"displayLoadingIndicator"),this._createLoadingIndicator(e,t,n,void 0,void 0,void 0,a)},e.prototype._displayLoadingIndicator=function(e,t,n,a,i,r,o,s){this._createLoadingIndicator(e,t,a,r,n,i,o,s)},e.prototype.clearLoadingIndicator=function(e){if(n.Validate.isNotNullOrUndefined(e,"domElement"),this._activeIndicatorCache.has(e)){var t=this._getCacheEntry(e);t.loadingTimer&&window.clearTimeout(t.loadingTimer),t.placeholder&&t.placeholder.parentElement&&t.placeholder.parentElement.removeChild(t.placeholder),this._activeIndicatorCache.delete(e)}},e.prototype.renderError=function(e,t,n){"function"==typeof n&&(n={clearDomElementCallback:n}),this._renderError(e,t,n)},e.prototype.clearError=function(e){if(n.Validate.isNotNullOrUndefined(e,"domElement"),this._activeIndicatorCache.has(e)){var t=this._activeIndicatorCache.get(e);if(t&&t.isErrorBeingRendered){t.isErrorBeingRendered=!1;var a=e.querySelector("div[data-sp-id='".concat(this._errorId,"']"));a&&(a.style.display="none",a.removeAttribute("data-automation-id"))}}},e.prototype._createLoadingIndicator=function(t,a,i,r,o,s,c,d){var l=this;n.Validate.isNotNullOrUndefined(t,"domElement"),(!r||r&&isNaN(r))&&(r=1500);var u=this._getCacheEntry(t);u.loadingTimer&&window.clearTimeout(u.loadingTimer),u.loadingTimer=window.setTimeout(function(){if(o&&s){var n=e._getAdditionalTimeOut(o);u.loadingTimer=window.setTimeout(function(){l._showLoadingIndicator(t,a,i,o,s,c,d)},n)}else l._showLoadingIndicator(t,a,i,o,s,c,d)},r)},e.prototype._renderError=function(e,t,a){var i=a||{},r=i.message,o=i.clearDomElementCallback;n.Validate.isNotNullOrUndefined(e,"domElement"),n.Validate.isNotNullOrUndefined(t,"error"),this._logEngagement(e,"renderError");var s,c="",d=r?"\r\n\r\n"+r:"";if(t instanceof n.SPError)c=t.toStringForUI(),c+=d;else{var l=t,u=l.stack,f=u?n.Text.format(N.k6,"\r\n",u):"";c=n.Text.format(N.PQ,"\r\n","".concat(l.message||t),f,d)}this._getCacheEntry(e).isErrorBeingRendered=!0,s=new ae({errorMessage:c}).render();var p=e.querySelector("div[data-sp-id='".concat(this._errorId,"']"));p?p.style.display="block":((p=document.createElement("div")).setAttribute("data-sp-id",this._errorId),o&&o(e),this._clearChildren(e),e.appendChild(p),W.disableAutomaticPostbacks(e,n.Environment.type)),p.setAttribute("data-automation-id","webPartError"),p.innerHTML="",p.appendChild(s)},e.prototype._showLoadingIndicator=function(e,t,n,a,i,r,o){a&&i&&d._PerformanceLogger.markComponent(a,"displaySpinner"),this._renderLoadingIndicator(e,t,n,a,r,o)},e.prototype._renderLoadingIndicator=function(e,t,n,a,i,r){if(this._activeIndicatorCache.has(e)){var o=this._getCacheEntry(e);o.isErrorBeingRendered||(o.placeholder=this._createLoadingIndicatorElement(e,t,n,a,i,r))}},e.prototype._getCacheEntry=function(e){if(this._activeIndicatorCache.has(e))return this._activeIndicatorCache.get(e);var t={loadingTimer:void 0,placeholder:void 0,isErrorBeingRendered:!1};return this._activeIndicatorCache.set(e,t),t},e.prototype._createLoadingIndicatorElement=function(e,a,i,r,o,s){o&&o(e),this._clearChildren(e);var c=n.Text.format(N.bl,a),d=r||s?t._ShimmerFactory.createShimmer(e.clientWidth,i,r,c):this._createSpinnerElement(c,i);return d.style.display="block",e.appendChild(d)},e.prototype._createSpinnerElement=function(e,t){var n=ie.createSpinner(e);if(void 0!==t){var a=document.createElement("div");a.style.maxHeight="".concat(t,"px"),a.appendChild(n),n=a}return n},e.prototype._clearChildren=function(e){for(;e.hasChildNodes();)e.lastChild&&e.removeChild(e.lastChild)},e.prototype._logEngagement=function(e,t){var n=!1,a=e.getAttribute("data-sp-web-part-id")||"";a&&(n=!0),d._EngagementLogger.log({name:"ClientSideWebPartStatusRenderer.".concat(t),isIntentional:!0,extraData:{spWebPartId:a,isWebPartRoot:n}})},e}();var oe,se,ce;!function(e){e[e.Standard=0]="Standard",e[e.FullSize=1]="FullSize",e[e.FullWidth=2]="FullWidth"}(oe||(oe={})),function(e){e[e.Unknown=0]="Unknown",e[e.WebPart=1]="WebPart",e[e.Application=2]="Application",e[e.Library=3]="Library",e[e.Extension=4]="Extension",e[e.ProviderHostedApp=5]="ProviderHostedApp",e[e.Assembly=6]="Assembly",e[e.AdaptiveCardExtension=7]="AdaptiveCardExtension"}(se||(se={})),function(e){e[e.TeamsTab=0]="TeamsTab",e[e.SharePointFullPage=1]="SharePointFullPage",e[e.SharePointWebPart=2]="SharePointWebPart",e[e.Dashboard=3]="Dashboard"}(ce||(ce={}));var de="Property pane will open",le="Content panel toggled",ue="Property pane toggled";const fe=JSON.parse('{"x":"Ćàŕď ńō ĺōńĝēŕ àvàĩĺàƀĺē: {0}"}');var pe="3ed4834b-756c-4c82-add3-a3acae4bf6cd";function me(t,a){return{manifest:Z._ManifestStore.instance.tryGetManifest(pe),webPartData:(0,e.__assign)((0,e.__assign)({},t),{id:pe,iconProperty:"Error",properties:{errorMessage:a||n.Text.format(fe.x,(null==t?void 0:t.title)||""),originalACEData:t}})}}var _e=/(\/_layouts\/15\/getpreview.ashx\/?(|(\?(.*?)))$)/i,he="e6b93447-8007-4f1e-934f-754a0031a769",be="d1d91016-032f-456d-98a4-721247c305e8",ge="fe2f2812-4df0-42c7-ae2e-2db57e092751",ve="LoadIsolatedWebPart";const ye=function(){function a(e){this._webParts=new Map,this._statusRenderer=new re,this._iframedWebpartInstanceIds=new Set,this._propertyPaneConsumerQueue=new Map,this._displayMode=n.DisplayMode.Read,n.Validate.isNotNullOrUndefined(e,"host"),this._host=e,this._pageContext=e.serviceScope.consume($.PageContext.serviceKey),this._onContainerResize=this._onContainerResize.bind(this),this._onPropertyPaneNotifications=this._onPropertyPaneNotifications.bind(this),this.requestPropertyPaneAction=this.requestPropertyPaneAction.bind(this),this.isPropertyPaneRenderedByWebPart=this.isPropertyPaneRenderedByWebPart.bind(this),this.isPropertyPaneOpen=this.isPropertyPaneOpen.bind(this),0===a._webPartManagerList.length&&this._initialzeOnResizeEventHandler(),a._webPartManagerList.push(this)}return a.createWebPartTag=function(e,t){return"WebPart.".concat(e.alias,".").concat(e.isInternal?"internal":"external",".").concat(t)},a._instanceOfBase=function(e){if(e){if(e instanceof J)return!0;var t=e.__type;return"BaseClientSideWebPart"===t||"BaseMRClientSideWebPart"===t}return!1},a._getWebPartTag=function(e){var t;if(a._instanceOfBase(e)?e.context||(t="WebpartTag requested for instance that is missing context"):t="WebpartTag requested for non-webpart",!t)return e.context.webPartTag;_._TraceLogger.logError(a._logSource,new Error(t))},a._isLoadingIsolatedWebPart=function(e,t){var i=e.manifest,r=e.pageLayoutType;if((0,V.wU)()&&i.isInternal&&"DomainIsolation"===i.isolationLevel){var s=t.match(a._1PIsolatedDomainRegex);if(s)i.isolatedDomain=new URL(t.replace(a._1PIsolatedDomainRegex,"".concat(s[0],"-app3bc2296eaa224ed29e1e946d05afa6a2"))).hostname;else if("Isolated"!==r)throw new Error("Cannot create isolated domain for: ".concat(t))}return n._SPFlight.isEnabled(1147)&&"Isolated"!==r&&(i.isolationLevel===o.DomIsolation||!!i.isolatedDomain)},a._getWebPartTitle=function(e,t){var n=t&&t.title;return n||(n=e.title&&e.title.default),n||e.preconfiguredEntries[0].title.default},a._loadDynamicComponentDependencies=function(e,t,a){for(var i=t.serverProcessedContent&&t.serverProcessedContent.componentDependencies||{},r=0,o=Object.keys(i);r<o.length;r++){var s=o[r],c=i[s];if(!n.Guid.isValid(c))throw new Error("Failed to load web part's (".concat(a,") dynamic dependency ").concat(s," with component id {").concat(c,"}"));e.push(Z.SPComponentLoader.loadComponentById(c))}},Object.defineProperty(a,"isMaintenanceMode",{get:function(){return"true"===new n.UrlQueryParameterCollection(window.location.href).getValue("maintenanceMode")},enumerable:!1,configurable:!0}),a.prototype.loadWebPart=function(e){var a=this;try{if((0,l.vn)())return this._loadWebPartOld(e);var i,r,o=e,s=this._isIsolatedWebPart(o),c=new _._QosMonitor("WebPart.Load",!0);return this._loadAndInitWebPart(o).then(function(e){return e===ve?Promise.reject(new Error(ve)):(a._validateIfWPIsNotDisposed(e),a._host.onBeforeWebPartRender(o),Q.flush(),e)}).then(function(e){return a._validateIfWPIsNotDisposed(e),(0,l.hH)()||(r=e),a._loadPropertyPaneModule(e)}).then(function(e){return a._validateIfWPIsNotDisposed(e),a._renderWebPart(e)}).then(function(e){var t=e.webPart,n=e.renderCompleteTime;return o.renderCompleteTime=n,!(0,l.pS)()&&s&&o.manifest.id===he&&a._iframedWebPartController&&a._iframedWebPartController.assignIsolatedACEWP(o.instanceId,t),a._host.onAfterWebPartRender(o),W.removeFabricLinks(),a._loadLegacyFabricCssIfRequired(o)}).catch(function(e){if(e instanceof Error&&e.message===ve)return ve;if("isDisposed"in e)throw e.stage="Render",e;throw i||(i={error:e,stage:"Render"}),i}).then(function(e){if(e!==ve){var n=t._WebPartLoadDataCollector.collect(o.manifest,o.webPartTag,a._pageContext);c.writeSuccess(n)}}).catch(function(e){var i=t._WebPartLoadDataCollector.collect(o.manifest,o.webPartTag,a._pageContext);if((0,l.kN)()||e.error instanceof Error||(i.errorData=e.error),!("isDisposed"in e)&&!(null==r?void 0:r.isDisposed)){c.writeUnexpectedFailure(e.stage,e.error,i);var s=e.error;switch(e.stage){case"Load":a._host.onAfterWebPartLoadFailed(o,s);break;case"Initialize":a._host.onAfterWebPartInitializeFailed(o,s);break;case"Render":a._host.onAfterWebPartRenderFailed(o,s)}var d=o.instanceId,u=a._webParts.get(d);u&&(u.dispose(),a._webParts.delete(d));var f="";if(null==u?void 0:u.modifiedByGraph){var p=new Date(1e3*(null==u?void 0:u.modifiedByGraph.lastModified));f=n.Text.format(N.NE,null==u?void 0:u.modifiedByGraph.apiVersion,p.toLocaleDateString(),p.toLocaleTimeString())}throw a._statusRenderer.renderError(o.domElement,s,{message:f}),e.error}c.writeExpectedFailure(e.stage,e.error,i),a._statusRenderer.clearLoadingIndicator(o.domElement)})}catch(e){return Promise.reject(e)}},a.prototype.setPropertyPaneConsumer=function(e,t){n.Validate.isNonemptyString(e,"id"),n.Validate.isNotNullOrUndefined(t,"control"),this._webParts.set(e,t),this._registerWebPartAsPropertyPaneConsumer(e)},a.prototype.fetchWebPartManifests=function(){var e=this,t=!(0,V.zZ)();if(t&&(this._toolboxACEManifestsPromise=this._fetchAdaptiveCardExtensionManifests()),this._toolboxManifestsPromise||this._pageContext.web&&this._pageContext.web.serverRelativeUrl&&n.Environment.type!==n.EnvironmentType.Local&&n.Environment.type!==n.EnvironmentType.Test||(this._toolboxManifestsPromise=Promise.resolve()),!this._toolboxManifestsPromise){var i,r,o,s=new _._QosMonitor("ClientSideWebPartManager.FetchWebParts");o=(0,V.zZ)()?"_api/web/GetClientSideComponentsByComponentType(componentTypesString='".concat(se.WebPart,",").concat(se.AdaptiveCardExtension,"', includeManifestActivatedTime=true)"):"_api/web/GetClientSideComponentsByComponentType(componentTypesString='".concat(se.WebPart,"',supportedHostTypeValue=").concat(ce.SharePointWebPart,")");var c="".concat(n.UrlUtilities.removeEndSlash(this._pageContext.web.serverRelativeUrl),"/").concat(o);this._host.serviceScope.whenFinished(function(){var t=e._host.serviceScope.consume(X.SPHttpClient.serviceKey);e._toolboxManifestsPromise=e._fetchManifestsWithCache(t,c).then(function(e){if(i=e.correlationId?e.correlationId.toString():void 0,r="true"===e.headers.get("X-From-Service-Worker"),e.ok)return e.jsonCached||(e.jsonCached=Promise.resolve(e.json()));throw B.create(R.ManifestDownloadFailed)}).then(function(t){var a=t.value.map(function(e){var t=JSON.parse(e.Manifest);return e.ManifestActivatedTime&&(t.manifestActivatedTime=e.ManifestActivatedTime),t});e._disambiguateWebPartManifestLocales(a),(0,l.bJ)()||e._isDebugSession||n._BrowserUtilities.isWorkbenchHosted()?Z.SPComponentLoader.registerManifests(a):Z.SPComponentLoader.refreshWebPartManifests(a),s.writeSuccess()}).catch(function(t){throw e._toolboxManifestsPromise=void 0,e._clearManifestCacheItem(c),_._TraceLogger.logErrorData({source:a._logSource,error:t,serviceScope:e._host.serviceScope}),s.writeUnexpectedFailure("Rejected",t,{correlationId:i,fromServiceWorker:r}),t})})}var d=this._fetchTeamsACEManifests();return t?Promise.all([this._toolboxACEManifestsPromise,this._toolboxManifestsPromise,d]).then(function(){}):(0,l.fl)()?this._toolboxManifestsPromise:Promise.all([this._toolboxManifestsPromise,d]).then(function(){})},a.prototype.getWebPartManifests=function(e){var t;void 0===e&&(e=!1);for(var n=[],a=0,i=Z.SPComponentLoader._getManifestReferences();a<i.length;a++){var r=i[a],o=null===(t=r.experimentalData)||void 0===t?void 0:t.ACE;"WebPart"!==r.componentType||o?e&&("AdaptiveCardExtension"===r.componentType||o)&&n.push(r):n.push(r)}return n},a.prototype.getAdaptiveCardExtensionManifests=function(){var e,t,n=Z.SPComponentLoader._getManifestReferences(),a=[];(0,V.K$)()&&this._toolboxTeamsAppComponentsManifests&&a.push.apply(a,Array.from(this._toolboxTeamsAppComponentsManifests.values()));for(var i=0,r=n;i<r.length;i++){var o=r[i];"AdaptiveCardExtension"!==o.componentType&&!(null===(e=o.experimentalData)||void 0===e?void 0:e.ACE)||(null===(t=this._toolboxTeamsAppComponentsManifests)||void 0===t?void 0:t.has(o.id))||this._toolboxTeamsAppComponentsManifests&&o.connectedTeamsAppId||a.push(o)}return a},a.prototype.setDisplayMode=function(e,t){this._setDisplayMode(e,t).catch(function(e){return _._TraceLogger.logVerboseData({source:a._logSource,message:e.message})})},a.prototype._setDisplayMode=function(e,t){var a=this;this._displayMode=e,this._displayMode===n.DisplayMode.Read&&this._closeIsolatedPropertyPaneIfRequired();var i=this._loadPropertyPaneModuleOld();return this._executeForIdsOrAll(this._getArrayOrUndefined(t),function(t,n){if(n)n._internalSetDisplayMode(e);else if(a._iframedWebpartInstanceIds.has(t)){var i=new _._QosMonitor("ClientSideWebPartManager._setDisplayMode");a._iframedWebPartController?(i.writeSuccess(),a._iframedWebPartController.setDisplayMode(e,t)):i.writeUnexpectedFailure("iFrame controller used before deferral loading is complete")}}),this._startDirtyBitTimer(e),i},a.prototype.serialize=function(e){var t=this,a=new Map;return this._executeForIdsOrAll(this._getArrayOrUndefined(e),function(e,i){i?a.set(e,i._internalSerialize()):t._iframedWebpartInstanceIds.has(e)&&(n.Validate.isNotNullOrUndefined(t._iframedWebPartController,"IFramedWebPartController is undefined"),a.set(e,t._iframedWebPartController.serialize(e)))}),a},a.prototype.setWebPartData=function(e,t,a){void 0===a&&(a=!1),n.Validate.isNotNullOrUndefined(e,"web part manager context"),n.Validate.isNonemptyString(t,"web part instance id");var i=this._webParts.get(t),r=!(0,l.rD)()&&(0,V.zy)()&&function(e){var t=e,n=e;return Boolean("string"==typeof t.dataVersion&&"string"==typeof t.id&&"string"==typeof t.instanceId&&"string"==typeof t.title)&&Boolean(!n.domElement&&!n.manifest&&!n.displayMode)}(e),o=r?void 0:e,s=r?e:null==o?void 0:o.webPartData;if(n.Validate.isNotNullOrUndefined(s,"web part data"),i&&s){if(a&&o)return this.disposeWebparts(t),this.loadWebPart(o);var c=!r&&!!(null==o?void 0:o.addedFromPersistedData);i._internalSetWebPartData(s,c),n._SPEventManager.instance.raiseEvent(this._getDataUpdatedEventName(s.instanceId),{})}return Promise.resolve()},a.prototype.dispose=function(){this.disposeWebparts();var e=a._webPartManagerList.indexOf(this);e>=0&&a._webPartManagerList.splice(e,1)},a.prototype.disposeWebparts=function(e){var t=this;this._executeForIdsOrAll(this._getArrayOrUndefined(e),function(e,i){i?(t._deleteWebPart(e),te(function(){i._internalDispose()},a._logSource)):t._iframedWebpartInstanceIds.has(e)&&(n.Validate.isNotNullOrUndefined(t._iframedWebPartController,"IFramedWebPartController is undefined"),t._iframedWebPartController.deleteWebPart(e))})},a.prototype.tryGeneratePreviewImageUrl=function(e){var t,n=this,i=void 0,r=void 0,o=new _._QosMonitor("ClientSideWebPartManager.tryGeneratePreviewImageUrl");(0,l.bR)()||this._webParts.forEach(function(e,t){a._instanceOfBase(e)&&n._isTitleAreaBannerWebPart(e)&&e.previewImageUrl&&(i=e.previewImageUrl)}),this._executeForIdsOrAll(e,function(e,s){if(s){if(!i){var c=s.previewImageUrl;if(c)if(r=s.context.manifest.alias,c.length<255){var d=(t=c).toUpperCase();(_e.test(d)||d.indexOf("/_API/")>=0||(0,l.bR)()&&n._isTitleAreaBannerWebPart(s))&&(i=t)}else{var u=s.previewImageUrl;_._TraceLogger.logVerboseData({source:a._logSource,eventName:"tryGeneratePreviewImageUrl",message:"".concat(r," attempted preview URL of ").concat(u&&u.length," chars.")})}}}else if(n._iframedWebpartInstanceIds.has(e))return void o.writeExpectedFailure("IframedPart")});var s=o&&r?{alias:r}:void 0;if(!i&&t&&(i=t,o.writeExpectedFailure("NonLayouts",void 0,s)),!i&&r)throw o.writeUnexpectedFailure("PathTooLong",void 0,s),new Error("tryGeneratePreviewImageUrl PathLengthError.");return o.hasEnded||o.writeSuccess(s),i},a.prototype.getWebpartTopActions=function(e){var t=this._webParts.get(e);return null==t?void 0:t.getTopActionsConfiguration()},a.prototype.getWebpartA11yResult=function(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n,i,r,o;return(0,e.__generator)(this,function(e){for(i=0,r=a._webPartManagerList;i<r.length&&(o=r[i],void 0===(n=o._webParts.get(t)));i++);return void 0===n?[2,Promise.resolve([void 0])]:[2,n._checkA11y()]})})},a.prototype.preOnClickA11yResult=function(e){var t;if(e.webPartInstanceId){for(var n=0,i=a._webPartManagerList;n<i.length&&void 0===(t=i[n]._webParts.get(e.webPartInstanceId));n++);null==t||t._preOnClickA11yResult(e)}},a.prototype.requestPropertyPaneAction=function(e,t,n,i){var r,o=this;if(void 0===t&&(t="Default"),this._iframedWebpartInstanceIds.has(e))(null===(r=this._propertyPane)||void 0===r?void 0:r.isOpen((0,V.zy)()?e:void 0))&&this._propertyPane.requestAction(e,"Close",n),this._iframedWebPartController.requestPropertyPaneAction(t,e);else{var s=!1;this._host.requestPropertyPaneAction&&(s=this._host.requestPropertyPaneAction(e,t,n,i)),s||(this._iframedWebPartController&&this._iframedWebPartController.requestPropertyPaneAction("Close"),this._propertyPane?this._propertyPane.requestAction(e,t,n,(0,l.lX)()?void 0:i):"OpenDetails"===t&&this._loadPropertyPaneModuleOld(!0).then(function(){return o._propertyPane.requestAction(e,t,n,i)}).catch(function(e){return _._TraceLogger.logVerboseData({source:a._logSource,message:e.message})}))}},a.prototype.isPropertyPaneRenderedByWebPart=function(){return!!this._propertyPane&&this._propertyPane.isRenderedByConsumer()},a.prototype.isPropertyPaneOpen=function(e){return!!this._propertyPane&&this._propertyPane.isOpen(e)},a.prototype.isContentPanelOpen=function(){var e,t;return!!(null===(t=null===(e=this._propertyPane)||void 0===e?void 0:e.isContentPanelOpen)||void 0===t?void 0:t.call(e))},a.prototype.onWebPartDelete=function(e){this.disposeWebparts(e)},a.prototype.renderError=function(e,t){var n=this;te(function(){n._statusRenderer.renderError(e,t),_._TraceLogger.logErrorData({source:a._logSource,error:t,serviceScope:n._host.serviceScope})},a._logSource)},a.prototype.notifyWebPartContainerResize=function(e){var t=this;this._executeForIdsOrAll(this._getArrayOrUndefined(e),function(e,a){a?a._internalOnAfterResize():t._iframedWebpartInstanceIds.has(e)&&(n.Validate.isNotNullOrUndefined(t._iframedWebPartController,"IFramedWebPartController is undefined"),t._iframedWebPartController.notifyContainerResize(e))})},a.prototype.notifyWebPartsSetDirtyBit=function(){this._notifyWebPartsSetDirtyBit()},a.prototype.clearManifestPromise=function(){this._toolboxManifestsPromise=void 0},a.prototype.getWebPartTranspileRenderProps=function(e,t){var n=new _._QosMonitor("WebPart.GetTranspileRenderProps");return this._getLoadedWebPart(e).then(function(e){var a=e._internalTranspile(t);return n.writeSuccess(),a}).catch(function(t){var a=e.manifest.alias;return t instanceof B&&t.id===R.TranspileNotImplemented?n.writeExpectedFailure("TranspileNotImplementedError for webpart: ".concat(a,"}"),t):n.writeUnexpectedFailure("Unexpected transpile error for webpart: ".concat(a),t),Promise.reject(t)})},a.prototype.getWebPartByInstanceId=function(e){return this._webParts.get(e)},a.prototype._getWebPartContext=function(e){var t=a.createWebPartTag(e.manifest,e.instanceId),i=this._host.getAdditionalContextProperties&&this._host.getAdditionalContextProperties()||{},o=i.microsoftTeams&&i.microsoftTeams.teamsJs,s=Promise.resolve({});s=this._host.getAdditionalContextPropertiesAsync&&this._host.getAdditionalContextPropertiesAsync()||Promise.resolve({});var c={sdks:i,microsoftTeams:o,parentServiceScope:e.serviceScope||this._host.serviceScope,manifest:this._getManifestInstance(e),instanceId:e.instanceId,webPartTag:t,domElement:e.domElement,statusRenderer:this._statusRenderer,isPropertyPaneRenderedByWebPart:this.isPropertyPaneRenderedByWebPart,isPropertyPaneOpen:this.isPropertyPaneOpen,isContentPanelOpen:this.isContentPanelOpen,formFactor:e.formFactor||oe.Standard,host:this._host,requestPropertyPaneAction:this.requestPropertyPaneAction,loggingTag:t,_dataUpdatedEvent:new n.SPEvent(this._getDataUpdatedEventName(e.instanceId)),widthCacheKey:e.widthCacheKey,pageLayoutType:e.pageLayoutType,sdksAsync:s,getPositionOnPage:e.getPositionOnPage};return new r(c)},a.prototype._getLoadedWebPart=function(e){var t;return!(0,l.mg)()&&this._webParts.has(e.instanceId)&&(t=this._webParts.get(e.instanceId)),t?Promise.resolve(t):this._loadAndInitWebPart(e,!0)},a.prototype._loadWebPartOld=function(i){var r,o=this;try{var s=i,c="f3bc67ee-015d-4678-a95f-c7e90ea62c1e"===s.manifest.id,d=s.manifest.id===he,u="AdaptiveCardExtension"===s.manifest.componentType||(null===(r=s.manifest.experimentalData)||void 0===r?void 0:r.ACE)||c||d,f=a._isLoadingIsolatedWebPart(s,this._pageContext.site.absoluteUrl);if(f&&!u)return this._loadIsolatedWebPart(s);var p=Promise.resolve();return u&&s.manifest.isPendingTeamsAppSync&&(p=this._waitForTeamsAppSync(s)),p.then(function(){return o._doesUserHasPermissions(s.manifest).then(function(i){var r,p,m,h;if(!i){var b=n.Text.format(N.Y6,(null===(r=s.webPartData)||void 0===r?void 0:r.title)||s.manifest.alias);if(s.displayMode===n.DisplayMode.Edit){if((0,l.o3)())throw new Error(b);var g=me(s.webPartData,b),v=g.manifest,y=g.webPartData;s.manifest=v,s.webPartData=y}else null===(m=(p=o._host).onAfterWebPartVisibilityChanged)||void 0===m||m.call(p,s.instanceId,!1)}u&&(!(0,l.rX)()&&(0,l.pS)()&&s.displayMode===n.DisplayMode.Edit||!c&&!f?s.manifest=Z._ManifestStore.instance.tryGetManifest("f3bc67ee-015d-4678-a95f-c7e90ea62c1e"):(0,V.o$)()&&!d&&f&&(s.manifest=Z._ManifestStore.instance.tryGetManifest(he)),s.webPartData&&(s.webPartData=(0,e.__assign)((0,e.__assign)({},s.webPartData),null===(h=s.webPartData.properties)||void 0===h?void 0:h.aceData)),s.displayMode===n.DisplayMode.Edit&&!(0,l.pS)()&&f&&s.manifest.id===he&&o._loadIsolatedWebPart(s,!0)),s.webPartTag=a.createWebPartTag(s.manifest,s.instanceId),s.domElement&&s.domElement.setAttribute&&s.domElement.setAttribute("data-sp-web-part-id",s.manifest.id);var S,D=new _._QosMonitor("WebPart.Load",!0);return new Promise(function(e){o._host.onBeforeWebPartLoad(s),e(o._loadComponentModules(s))}).then(function(e){return o._host.onAfterWebPartLoad(s),e}).catch(function(e){throw S={error:e,stage:"Load"}}).then(function(e){return o._host.onBeforeWebPartInitialize(s).then(function(){return o._initializeWebPart(e,s)})}).then(function(e){return o._validateIfWPIsNotDisposed(e),o._host.onAfterWebPartInitialize(s),e}).catch(function(e){if("isDisposed"in e)throw e.stage="Initialize",e;throw S||(S={error:e,stage:"Initialize"}),S}).then(function(e){return o._validateIfWPIsNotDisposed(e),o._host.onBeforeWebPartRender(s),Q.flush(),e}).then(function(e){return o._validateIfWPIsNotDisposed(e),o._loadPropertyPaneModule(e)}).then(function(e){return o._validateIfWPIsNotDisposed(e),o._renderWebPart(e)}).then(function(e){var t=e.webPart,n=e.renderCompleteTime;return s.renderCompleteTime=n,!(0,l.pS)()&&f&&s.manifest.id===he&&o._iframedWebPartController&&o._iframedWebPartController.assignIsolatedACEWP(s.instanceId,t),o._host.onAfterWebPartRender(s),W.removeFabricLinks(),o._loadLegacyFabricCssIfRequired(s)}).catch(function(e){if("isDisposed"in e)throw e.stage="Render",e;throw S||(S={error:e,stage:"Render"}),S}).then(function(){var e=t._WebPartLoadDataCollector.collect(s.manifest,s.webPartTag,o._pageContext);D.writeSuccess(e)}).catch(function(e){var a=t._WebPartLoadDataCollector.collect(s.manifest,s.webPartTag,o._pageContext);if((0,l.kN)()||e.error instanceof Error||(a.errorData=e.error),!("isDisposed"in e)){D.writeUnexpectedFailure(e.stage,e.error,a);var i=e.error;switch(e.stage){case"Load":o._host.onAfterWebPartLoadFailed(s,i);break;case"Initialize":o._host.onAfterWebPartInitializeFailed(s,i);break;case"Render":o._host.onAfterWebPartRenderFailed(s,i)}var r=s.instanceId,c=o._webParts.get(r);c&&(c.dispose(),o._webParts.delete(r));var d="";if(null==c?void 0:c.modifiedByGraph){var u=new Date(1e3*(null==c?void 0:c.modifiedByGraph.lastModified));d=n.Text.format(N.NE,null==c?void 0:c.modifiedByGraph.apiVersion,u.toLocaleDateString(),u.toLocaleTimeString())}throw o._statusRenderer.renderError(s.domElement,i,{message:d}),e.error}D.writeExpectedFailure(e.stage,e.error,a),o._statusRenderer.clearLoadingIndicator(s.domElement)})})})}catch(e){return Promise.reject(e)}},a.prototype._isIsolatedWebPart=function(e){return a._isLoadingIsolatedWebPart(e,this._pageContext.site.absoluteUrl)},a.prototype._isACE=function(e){var t,n="f3bc67ee-015d-4678-a95f-c7e90ea62c1e"===e.manifest.id,a=e.manifest.id===he;return"AdaptiveCardExtension"===e.manifest.componentType||(null===(t=e.manifest.experimentalData)||void 0===t?void 0:t.ACE)||n||a},a.prototype._isPrefab=function(e){return"Prefab"===e.manifest.componentType},a.prototype._loadAndInitWebPart=function(t,i){var r=this;try{var o=t,s="f3bc67ee-015d-4678-a95f-c7e90ea62c1e"===o.manifest.id,c=o.manifest.id===he,d=this._isACE(o),u=this._isPrefab(o),f=this._isIsolatedWebPart(o);if(f&&!d)return i?Promise.reject(new Error(ve)):this._loadIsolatedWebPart(o).then(function(){return ve});var p=Promise.resolve();return d&&o.manifest.isPendingTeamsAppSync&&(p=this._waitForTeamsAppSync(o)),p.then(function(){return r._doesUserHasPermissions(o.manifest).then(function(t){var p,m,_,h,b;if(!t){var g=n.Text.format(N.Y6,(null===(p=o.webPartData)||void 0===p?void 0:p.title)||o.manifest.alias);if(o.displayMode===n.DisplayMode.Edit){if((0,l.o3)())throw new Error(g);var v=me(o.webPartData,g),y=v.manifest,S=v.webPartData;o.manifest=y,o.webPartData=S}else null===(_=(m=r._host).onAfterWebPartVisibilityChanged)||void 0===_||_.call(m,o.instanceId,!1)}if(d){if(!(0,l.rX)()&&(0,l.pS)()&&o.displayMode===n.DisplayMode.Edit||!s&&!f?o.manifest=Z._ManifestStore.instance.tryGetManifest("f3bc67ee-015d-4678-a95f-c7e90ea62c1e"):(0,V.o$)()&&!c&&f&&(o.manifest=Z._ManifestStore.instance.tryGetManifest(he)),o.webPartData&&(o.webPartData=(0,e.__assign)((0,e.__assign)({},o.webPartData),null===(h=o.webPartData.properties)||void 0===h?void 0:h.aceData)),o.displayMode===n.DisplayMode.Edit&&!(0,l.pS)()&&f&&o.manifest.id===he){if(i)return Promise.reject(new Error(ve));r._loadIsolatedWebPart(o,!0)}}else u&&(o.manifest=Z._ManifestStore.instance.tryGetManifest("a0957e08-a450-4de0-b402-7db1bd92c4de"));return o.webPartTag=a.createWebPartTag(o.manifest,o.instanceId),o.domElement&&o.domElement.setAttribute&&o.domElement.setAttribute("data-sp-web-part-id",o.manifest.id),new Promise(function(e){r._host.onBeforeWebPartLoad(o),e(r._loadComponentModules(o))}).then(function(e){return r._host.onAfterWebPartLoad(o),e}).catch(function(e){throw b={error:e,stage:"Load"}}).then(function(e){return r._host.onBeforeWebPartInitialize(o).then(function(){return r._initializeWebPart(e,o)})}).then(function(e){return r._validateIfWPIsNotDisposed(e),r._host.onAfterWebPartInitialize(o),e}).catch(function(e){if("isDisposed"in e)throw e.stage="Initialize",e;throw b||(b={error:e,stage:"Initialize"}),b})})})}catch(e){return Promise.reject(e)}},a.prototype._initializeWebPart=function(e,t){var n=e;n.default&&"function"!=typeof(n=n.default)&&n.default&&(n=n.default);var a=new n;a._internalInitialize(this._getWebPartContext(t),!!t.addedFromPersistedData,t.displayMode);var i=a.instanceId;return this._webParts.set(i,a),this._registerWebPartAsPropertyPaneConsumer(i),this._startDirtyBitTimer(t.displayMode),t.webPartData&&a._internalDeserialize(t.webPartData),a},a.prototype._fetchManifestsWithCache=function(e,t){return a._manifestRequestPromiseCache[t]||(a._manifestRequestPromiseCache[t]=e.post(t,X.SPHttpClient.configurations.v1,{body:JSON.stringify({project:n.Session.clientSideApplicationId}),headers:{"x-odsp-web-version":Z._ManifestStore.instance.buildNumber}})),a._manifestRequestPromiseCache[t]},a.prototype._fetchAdaptiveCardExtensionManifests=function(){var e=this;this._toolboxACEManifestsPromise||this._pageContext.web&&this._pageContext.web.serverRelativeUrl&&n.Environment.type!==n.EnvironmentType.Local&&n.Environment.type!==n.EnvironmentType.Test||(this._toolboxACEManifestsPromise=Promise.resolve());var t="_api/web/GetClientSideComponentsByComponentType(componentTypesString='".concat(se.AdaptiveCardExtension,"',supportedHostTypeValue=").concat(ce.Dashboard,", includeManifestActivatedTime=true)");if(!this._toolboxACEManifestsPromise){var i="".concat(n.UrlUtilities.removeEndSlash(this._pageContext.web.serverRelativeUrl),"/").concat(t);this._host.serviceScope.whenFinished(function(){var t=e._host.serviceScope.consume(X.SPHttpClient.serviceKey);e._toolboxACEManifestsPromise=e._fetchManifestsWithCache(t,i).then(function(e){if(e.ok)return e.jsonCached||(e.jsonCached=Promise.resolve(e.json()));throw B.create(R.ManifestDownloadFailed)}).then(function(t){var n=t.value.map(function(e){var t=JSON.parse(e.Manifest);return e.ManifestActivatedTime&&(t.manifestActivatedTime=e.ManifestActivatedTime),t});e._disambiguateWebPartManifestLocales(n),Z.SPComponentLoader.registerManifests(n)}).catch(function(t){throw e._toolboxACEManifestsPromise=void 0,e._clearManifestCacheItem(i),_._TraceLogger.logErrorData({source:a._logSource,error:t,serviceScope:e._host.serviceScope}),t})})}return this._toolboxACEManifestsPromise},a.prototype._fetchTeamsACEManifests=function(){var e=this;return this._toolboxTeamsACEManifestsPromise||(0,V.K$)()&&this._pageContext.web&&this._pageContext.web.serverRelativeUrl&&n.Environment.type!==n.EnvironmentType.Local&&n.Environment.type!==n.EnvironmentType.Test||(this._toolboxTeamsACEManifestsPromise=Promise.resolve(),this._toolboxTeamsAppComponentsManifests=void 0),this._toolboxTeamsACEManifestsPromise||(this._toolboxTeamsACEManifestsPromise=this._teamsAppsClient.then(function(e){return e?e.getTeamsAppComponentManifests():Promise.resolve([])}).then(function(t){e._toolboxTeamsAppComponentsManifests||(e._toolboxTeamsAppComponentsManifests=new Map),t.forEach(function(t){e._toolboxTeamsAppComponentsManifests.set(t.id,t)})}).catch(function(t){e._toolboxTeamsACEManifestsPromise=void 0,e._toolboxTeamsAppComponentsManifests=void 0,_._TraceLogger.logErrorData({source:a._logSource,error:t,serviceScope:e._host.serviceScope})})),this._toolboxACEManifestsPromise},a.prototype._clearManifestCacheItem=function(e){delete a._manifestRequestPromiseCache[e]},a.prototype._disambiguateWebPartManifestLocales=function(e){var t=this._pageContext.cultureInfo.currentUICultureName?this._pageContext.cultureInfo.currentUICultureName.toLowerCase():void 0;if(t){var n=function(e){var n=void 0;for(var a in e)if(a&&a.toLowerCase()===t&&e[a]){n=e[a];break}return{default:n||e.default}};e.forEach(function(e){"WebPart"===e.componentType&&e.preconfiguredEntries.forEach(function(e){e.title=n(e.title),e.description=n(e.description),e.group&&(e.group=n(e.group))})})}},a.prototype._loadIsolatedWebPart=function(e,n){var a=this;void 0===n&&(n=!1),this._iframedWebpartInstanceIds.add(e.instanceId);var i=(0,t._ensureIsolatedDomainUrl)(e.manifest.isolatedDomain,this._pageContext.web.absoluteUrl);return b.e(426).then(b.bind(b,194)).then(function(e){return e.default}).then(function(t){return a._iframedWebPartController||(a._iframedWebPartController=new t(a._host)),a._iframedWebPartController.loadWebPart(i,a._pageContext,e,n)})},a.prototype._waitForTeamsAppSync=function(e){var t=this,n=e.domElement,i=e.manifest,r=e.reservedHeight,o=e.webPartData,s=a._getWebPartTitle(i,o);return this._statusRenderer._displayLoadingIndicator(n,s,a.createWebPartTag(e.manifest,e.instanceId),r||180,i.isInternal),this._teamsAppsClient.then(function(e){if(!e)throw new Error("Invalid operation: TeamsAppsClient is undefined");return e.syncComponent(i)}).then(function(a){var i;t._statusRenderer.clearLoadingIndicator(n),null===(i=t._toolboxTeamsAppComponentsManifests)||void 0===i||i.set(a.id,a),Z.SPComponentLoader.registerManifests([a]),h.assign(e.manifest,a),e.manifest.isPendingTeamsAppSync=!1}).catch(function(e){throw t._statusRenderer.clearLoadingIndicator(n),t._statusRenderer.renderError(n,e),e})},a.prototype._loadComponentModules=function(e){this._swapManifestForWebparts(e);var t=e.domElement,n=e.manifest,i=e.reservedHeight,r=e.webPartData,o=a._getWebPartTitle(n,r);this._statusRenderer._displayLoadingIndicator(t,o,e.webPartTag,i,n.isInternal);var s=[Z.SPComponentLoader.loadComponent(n)];if(!s[0])throw B.create(R.ModuleUndefined,e.webPartTag);return r&&a._loadDynamicComponentDependencies(s,r,e.webPartTag),Promise.all(s).then(function(e){return e[0]})},a.prototype._executeForIdsOrAll=function(e,t){var n=this;e?e.forEach(function(e){var a=n._webParts.get(e);t(e,a)}):(this._webParts.forEach(function(e,n){a._instanceOfBase(e)&&t(n,e)}),this._iframedWebPartController&&this._iframedWebPartController.getAllInstanceIds().forEach(function(e){t(e)}))},a.prototype._startDirtyBitTimer=function(e){var t=this;e===n.DisplayMode.Read?this._dirtyBitTimer&&n.Environment.type!==n.EnvironmentType.ClassicSharePoint&&(window.clearInterval(this._dirtyBitTimer),this._dirtyBitTimer=void 0):this._dirtyBitTimer||(this._dirtyBitTimer=window.setInterval(function(){t._notifyWebPartsSetDirtyBit()},1e3))},a.prototype._notifyWebPartsSetDirtyBit=function(){var e=this;this._executeForIdsOrAll(void 0,function(t,n){n?n._internalSetDirtyBit():e._iframedWebpartInstanceIds.has(t)&&e._iframedWebPartController.startDirtyBitTimer(t)})},a.prototype._deleteWebPart=function(e){n.Validate.isNotNullOrUndefined(e,"id"),this._propertyPane&&this._propertyPane.onConsumerDelete(e);var t=this._webParts.get(e);t&&a._instanceOfBase(t)&&_._TraceLogger.logVerboseData({source:a._logSource,message:n.Text.format(N.zI,a._getWebPartTag(t)),serviceScope:this._host.serviceScope}),this._webParts.delete(e)},a.prototype._getManifestInstance=function(e){var t=e.manifest,n=h.cloneDeep(t);return delete n.preconfiguredEntries,n},a.prototype._getArrayOrUndefined=function(e){return e?[e]:void 0},a.prototype._initialzeOnResizeEventHandler=function(){window.addEventListener("resize",h.debounce(this._onContainerResize,1e3)),window.addEventListener("message",this._onPropertyPaneNotifications),window.addEventListener("resize",q.clear)},a.prototype._onContainerResize=function(){a._webPartManagerList.forEach(function(e){e._webParts.forEach(function(e){e._internalOnAfterResize()})})},a.prototype._onPropertyPaneNotifications=function(e){if(e&&e.origin===window.location.origin)switch(e.data){case"Content panel will open":case de:this._closeIsolatedPropertyPaneIfRequired();break;case le:case ue:q.clear(),this._onContainerResize()}},a.prototype._renderWebPart=function(e){return e._internalFirstTimeRender().then(function(t){return{webPart:e,renderCompleteTime:t}})},a.prototype._loadPropertyPaneModule=function(e){var t=this,i=Promise.resolve(e);if((e.displayMode===n.DisplayMode.Edit||n.Environment.type===n.EnvironmentType.ClassicSharePoint)&&!this._propertyPane){var r=new _._QosMonitor("ClientSideWebPartManager._loadPropertyPaneModule");i=this._host.serviceScope.consume(ee.serviceKey).propertyPane.then(function(n){return t._propertyPane=n,t._registerPendingPropertyPaneConsumers(),e}).catch(function(e){throw _._TraceLogger.logErrorData({source:a._logSource,error:e}),r.writeUnexpectedFailure("UnhandledError",e),e})}return i},a.prototype._getDataUpdatedEventName=function(e){return"WebPart_".concat(e,"_dataUpdated")},a.prototype._registerWebPartAsPropertyPaneConsumer=function(e){if(e)for(var t=void 0,n=0,i=a._webPartManagerList;n<i.length;n++)if(t=i[n]._webParts.get(e)){this._propertyPane?this._propertyPane.registerConsumer(e,t):this._propertyPaneConsumerQueue.set(e,t);break}},a.prototype._registerPendingPropertyPaneConsumers=function(){var e=this;this._propertyPaneConsumerQueue.forEach(function(t,n){e._propertyPane.registerConsumer(n,t)})},a.prototype._closeIsolatedPropertyPaneIfRequired=function(){a._webPartManagerList.forEach(function(e){e._iframedWebPartController&&e._iframedWebPartController.requestPropertyPaneAction("Close")})},a.prototype._loadLegacyFabricCssIfRequired=function(e){var n,i,r=this,o=e.manifest;return!t._LegacyThirdPartyFabricCoreLoader.needLegacyFabricCss(o)&&o.isInternal||null===(i=null===(n=e.domElement)||void 0===n?void 0:n.classList)||void 0===i||i.add("ms-SPLegacyFabricBlock"),t._LegacyThirdPartyFabricCoreLoader.forceLoad(o).then(function(){return Promise.resolve()}).catch(function(e){throw _._TraceLogger.logErrorData({source:a._logSource,error:e,serviceScope:r._host.serviceScope}),e})},Object.defineProperty(a.prototype,"_isDebugSession",{get:function(){return!!n._BrowserUtilities.safelyAccessSessionStorage("spfx-debug")},enumerable:!1,configurable:!0}),a.prototype._loadPropertyPaneModuleOld=function(e){var t=this;if(this._displayMode!==n.DisplayMode.Edit&&!e&&n.Environment.type!==n.EnvironmentType.ClassicSharePoint||this._propertyPane)return Promise.resolve(void 0);var i=new _._QosMonitor("ClientSideWebPartManager._loadPropertyPaneModule");return this._propertyPaneLoader=this._host.serviceScope.consume(ee.serviceKey),this._propertyPaneLoader.propertyPane.then(function(e){return t._propertyPane=e,t._registerPendingPropertyPaneConsumers(),e}).catch(function(e){throw _._TraceLogger.logErrorData({source:a._logSource,error:e}),i.writeUnexpectedFailure("UnhandledError",e),e})},a.prototype._validateIfWPIsNotDisposed=function(e){if(e.isDisposed||e._isDisposing)throw{error:new Error("The Web Part is disposed and cannot be rendered."),isDisposed:!0}},a.prototype._swapManifestForWebparts=function(e){var t;if((0,V.ky)()&&e.manifest.id===be&&!(null===(t=e.webPartData)||void 0===t?void 0:t.properties.isInlineImage)?(n=Z._ManifestStore.instance.tryGetManifest(ge))&&(e.manifest=n):(0,V.ky)()||e.manifest.id!==ge||(n=Z._ManifestStore.instance.tryGetManifest(be))&&(e.manifest=n),"f92bf067-bc19-489e-a556-7fe95f508720"===e.manifest.id){var n,a=(0,V.G9)()?"da46359b-3267-4af8-9c8e-42c631ae31c0":(0,V.Jx)()?"a572f711-58d9-473f-a827-ac3ffd529516":void 0;a&&(n=Z._ManifestStore.instance.tryGetManifest(a))&&(e.manifest=n)}},a.prototype._doesUserHasPermissions=function(e){if("AdaptiveCardExtension"===e.componentType&&e.isPendingTeamsAppSync)return Promise.resolve(!0);var t=e;return"AdaptiveCardExtension"===e.componentType&&t.connectedTeamsAppId&&(0,V.K$)()?this._teamsAppsClient.then(function(e){return!e||e.isComponentEnabled(t.connectedTeamsAppId)}).catch(function(){return!1}):Promise.resolve(!0)},Object.defineProperty(a.prototype,"_teamsAppsClient",{get:function(){return(0,V.K$)()?(this._deferredTeamsAppsClient||(this._deferredTeamsAppsClient=this._host.serviceScope.consume(t._DeferredTeamsAppsClient.serviceKey).getClient()),this._deferredTeamsAppsClient):Promise.resolve(void 0)},enumerable:!1,configurable:!0}),a.prototype._isTitleAreaBannerWebPart=function(e){var t,n,a=null===(n=null===(t=e.context)||void 0===t?void 0:t._getPositionOnPage)||void 0===n?void 0:n.call(t);if("cbe7b0a9-3504-44dd-a3a3-0e5cacd07788"===e.manifest.id&&a){var i=a.componentOrder,r=a.sectionFactor;return 0===i&&0===r}return!1},a._webPartManagerList=[],a._1PIsolatedDomainRegex=new RegExp("https://[a-z0-9]*(?=.sharepoint.com)","ig"),a._logSource=_._LogSource.create("ClientSideWebPartManager"),a._manifestRequestPromiseCache={},a}(),Se=function(t){function a(e){var n=t.call(this,e)||this;return n._wpMaintenanceModeData=new Map,n}return(0,e.__extends)(a,t),a.prototype.loadWebPart=function(e){return this._loadWebPartInMaintenanceMode(e),this._wpMaintenanceModeData.set(e.instanceId,e.webPartData),Promise.resolve()},a.prototype.serialize=function(e){return this._wpMaintenanceModeData},a.prototype.dispose=function(e){e?this._wpMaintenanceModeData.delete(e):this._wpMaintenanceModeData=new Map},a.prototype._loadWebPartInMaintenanceMode=function(e){var t=this._getWebPartContext(e);t.serviceScope.finish(),Z.SPComponentLoader.loadComponentById("88019639-8c06-4ba6-8545-03a1f38f8393").then(function(n){return n.MaintenanceModeRenderer.render(t,e.webPartData)}).then(function(){return W.disableAutomaticPostbacks(e.domElement,n.Environment.type)}).catch(function(e){return e})},a}(ye),De=function(){function e(){}return e.create=function(e){return ye.isMaintenanceMode?new Se(e):new ye(e)},e}(),Ie=function(){function e(){}return Object.defineProperty(e,"_parsingDocument",{get:function(){return this._tempDoc||(this._tempDoc=document.implementation.createHTMLDocument("tempDocument")),this._tempDoc},enumerable:!1,configurable:!0}),e.isWebPartHtml=function(t){return n.Validate.isNonemptyString(t,"htmlString"),0===t.indexOf("<div")&&-1!==t.indexOf(e._webPartDataAttribute)},e.convertWebPartDataToHtml=function(t){n.Validate.isNotNullOrUndefined(t,"web part data");var a=h.cloneDeep(t);e._initializeIfNeeded();var i=e._wpComponentIdDiv.cloneNode();i.textContent=a.id;var r=e._wpHtmlPropsDiv.cloneNode();r.innerHTML=e.convertServerProcessedDataToHtml(a.serverProcessedContent),a.serverProcessedContent=void 0;var o=e._wpDiv.cloneNode();o.setAttribute(e._webPartDataAttribute,JSON.stringify(a)),o.appendChild(i),o.appendChild(r);var s=e._parsingDocument.createElement("div");return s.appendChild(o),s.innerHTML},e.convertHtmlToWebPartData=function(t,n){var a,i=e._parsingDocument.createElement("div");i.innerHTML=t.trim();var r=i.children[0];if(r&&r.hasAttribute(e._webPartAttribute)){var o=r.getAttribute(e._webPartDataAttribute);if(o&&(a=JSON.parse(o)),a){var s=r.querySelector("[".concat(e._htmlPropertiesAttribute,"]"));a.serverProcessedContent=e.convertServerProcessedHtmlToData(s.innerHTML,n)}}return a||void 0},e.convertServerProcessedDataToHtml=function(n){var a="";return n&&(n.htmlStrings&&(a+=e._convertServerProcessedDataToHtmlByType(n.htmlStrings,t.ServerProcessedDataType.htmlString)),n.searchablePlainTexts&&(a+=e._convertServerProcessedDataToHtmlByType(n.searchablePlainTexts,t.ServerProcessedDataType.searchablePlainText)),n.links&&(a+=e._convertServerProcessedDataToHtmlByType(n.links,t.ServerProcessedDataType.link)),n.imageSources&&(a+=e._convertServerProcessedDataToHtmlByType(n.imageSources,t.ServerProcessedDataType.imageSource))),a},e.convertServerProcessedHtmlToData=function(t,n){var a={htmlStrings:{},searchablePlainTexts:{},links:{},imageSources:{}};if(!t||""===t)return a;var i=e._parsingDocument.createElement("DIV");i.innerHTML=t;for(var r=i.children,o=0;o<r.length;o++){var s=r[o],c=s.getAttribute(e._propNameAttribute);if(c)switch(s.tagName){case"DIV":s.hasAttribute(e._searchablePlainTextAttribute)&&a.searchablePlainTexts?a.searchablePlainTexts[c]=s.textContent:a.htmlStrings&&(a.htmlStrings[c]=s.innerHTML);break;case"LINK":case"A":if(n)e._extractSPLink(s,n,a,c,!1);else{var d=s.getAttribute("href");d&&a.links&&(a.links[c]=d)}break;case"IMG":case"SPIMG":if(n)e._extractSPLink(s,n,a,c,!0);else{var l=s.getAttribute("src");a.imageSources&&l&&(a.imageSources[c]=l);var u=s.getAttribute("href");u&&a&&a.imageSources&&(void 0===a.imageSources[c]||null===a.imageSources[c])&&(a.imageSources[c]=u)}}}return a},e._convertServerProcessedDataToHtmlByType=function(t,n){for(var a="",i=0,r=Object.entries(t);i<r.length;i++){var o=r[i],s=o[0],c=o[1];a+=e._getHtmlString(s,n,c)}return a},e._getHtmlString=function(n,a,i){var r="";if(n&&"string"==typeof i&&i)switch(a){case t.ServerProcessedDataType.htmlString:var o=this._parsingDocument.createElement("DIV");o.setAttribute(e._propNameAttribute,n);var s=e._normalizeHTML(i);o.innerHTML=s,r=o.outerHTML;break;case t.ServerProcessedDataType.searchablePlainText:var c=this._parsingDocument.createElement("DIV");c.setAttribute(e._propNameAttribute,n),c.setAttribute(e._searchablePlainTextAttribute,"true"),c.textContent=i,r=c.outerHTML;break;case t.ServerProcessedDataType.link:var d=this._parsingDocument.createElement("A");d.setAttribute(e._propNameAttribute,n),d.setAttribute("href",i),r=d.outerHTML;break;case t.ServerProcessedDataType.imageSource:var l=this._parsingDocument.createElement("IMG");l.setAttribute(e._propNameAttribute,n),l.setAttribute("src",i),r=l.outerHTML}return r},e._normalizeHTML=function(t){if(!t||""===t)return t;var n=e._parsingDocument.createElement("DIV");n.innerHTML="<div class='child1'></div><div class='main'>".concat(t,"</div><div class='child3'></div>");var a=n.children;if(!a[0]||"child1"!==a[0].className||!a[1]||"main"!==a[1].className||!a[2]||"child3"!==a[2].className)return"";for(var i=a[1],r=i.querySelectorAll("script"),o=0;o<r.length;o++){var s=r[0];s&&s.parentElement&&s.parentElement.removeChild(s)}return i.innerHTML},e._initializeIfNeeded=function(){e._wpDiv||(e._wpDiv=e._parsingDocument.createElement("div"),e._wpDiv.setAttribute(e._webPartAttribute,""),e._wpDiv.setAttribute(e._webPartDataVersionAttribute,"1.0"),e._wpComponentIdDiv=e._parsingDocument.createElement("div"),e._wpComponentIdDiv.setAttribute(e._componentIdAttribute,""),e._wpHtmlPropsDiv=e._parsingDocument.createElement("div"),e._wpHtmlPropsDiv.setAttribute(e._htmlPropertiesAttribute,""))},e._extractSPLink=function(t,n,a,i,r){if(!(n.length<=0)){var o=t.getAttribute("data-sp-splink");if(o){var s=e._linkPlaceHolderRegex.exec(o);if(!s)throw B.create(R.InvalidSPLinkAttributeFormat,o);var c=parseInt(s[1],10);if(isNaN(c)||!n[c])throw B.create(R.InvalidSPLinkIndex,s[1]);r&&a.imageSources?a.imageSources[i]=n[c]:a.links&&(a.links[i]=n[c])}}},e._componentIdAttribute="data-sp-componentid",e._htmlPropertiesAttribute="data-sp-htmlproperties",e._propNameAttribute="data-sp-prop-name",e._searchablePlainTextAttribute="data-sp-searchableplaintext",e._webPartAttribute="data-sp-webpart",e._webPartDataAttribute="data-sp-webpartdata",e._webPartDataVersionAttribute="data-sp-webpartdataversion",e._linkPlaceHolderRegex=/^__SPLINK__(\d+)__$/,e}();var xe=function(){function e(){var e=this;this.mediumCardMinWidth=164,this.cardSpacing=16,this.defaultCardWidthMap={Medium:this.mediumCardMinWidth,Large:2*this.mediumCardMinWidth+this.cardSpacing},this._mediumCardMaxWidth=204,this._mediumCardMinWidthSpacing=this.mediumCardMinWidth+this.cardSpacing,this.getCardWidthFromBreakpoint=function(t,n){var a,i=e.getCardWidthFromSize(e.mediumCardMinWidth,n);return t>=e._getCardBreakpoint(6)?e._getMaximizedCardWidth(Math.floor(t/6-e.cardSpacing),n):t>=e._getCardBreakpoint(5)?(a=Math.floor(t/5-e.cardSpacing),e._getMaximizedCardWidth(a,n)):t>=e._getCardBreakpoint(4)?(a=Math.floor(t/4-e.cardSpacing),e._getMaximizedCardWidth(a,n)):t>=e._getCardBreakpoint(3)?(a=Math.floor(t/3-e.cardSpacing),e._getMaximizedCardWidth(a,n)):t>=e._getCardBreakpoint(2)?(a=Math.floor(t/2-e.cardSpacing),e._getMaximizedCardWidth(a,n)):i},this.getCardWidthFromSize=function(t,n){return"Large"===n?2*t+e.cardSpacing:t},this.getDashboardCardWidthsFromContainer=function(t){if(t<((0,l.dv)()?2*e.mediumCardMinWidth+e.cardSpacing:e._getCardBreakpoint(2))){var n=(0,l._P)()?Math.floor(t/2-e.cardSpacing/2):Math.floor(t/2)-e.cardSpacing;return{Medium:n,Large:e.getCardWidthFromSize(n,"Large")}}var a=e.getCardWidthFromBreakpoint(t,"Medium");return{Medium:a,Large:e.getCardWidthFromSize(a,"Large")}},this._getCardBreakpoint=function(t){return e._mediumCardMinWidthSpacing*t}}return e.prototype._getMaximizedCardWidth=function(e,t){var n=Math.min(Math.max(e,this.mediumCardMinWidth),this._mediumCardMaxWidth);return this.getCardWidthFromSize(n,t)},e}(),Ce=b(390);const Oe=function(){function e(e){this._validateProps(e),this._props=e,this._webPartManager=De.create(this._props.host)}return Object.defineProperty(e.prototype,"webPartManager",{get:function(){return this._webPartManager},enumerable:!1,configurable:!0}),e.prototype.render=function(e){var t=this;return n.Validate.isNotNullOrUndefined(e,"domElement"),this._domElement=e,this._props.openPropertyPane?this._domElement.style.display="none":this._domElement.style.display="block",this._renderWebPart(this._domElement).then(function(){t._props.openPropertyPane?t._webPartManager.requestPropertyPaneAction(t._props.webPartInstanceId,"Open"):t._props.openDetailsPropertyPane?t._webPartManager.requestPropertyPaneAction(t._props.webPartInstanceId,"OpenDetails"):(t._props.requestDisplayModeStatus&&t._props.requestDisplayModeStatus(),t._props.requestTheme&&t._props.requestTheme(),t._props.sendDimensionsToParent&&(t._intervalTask=window.setInterval(t._sendDimensionsCallback.bind(t),200)))}).catch(function(e){console.log(e)})},e.prototype.dispose=function(){this._intervalTask&&clearTimeout(this._intervalTask),this._webPartManager.disposeWebparts(this._props.webPartInstanceId),this._webPartManager.dispose()},e.prototype.setWebPartData=function(e,t){var n=this._getWebPartManagerContext(this._domElement,e);this._webPartManager.setWebPartData(n,t).catch(function(e){return console.log(e)})},e.prototype.serialize=function(){var e=this._webPartManager.serialize(this._props.webPartInstanceId).get(this._props.webPartInstanceId);return n.Validate.isNotNullOrUndefined(e,"webPartData"),e},e.prototype.setDisplayMode=function(e){return this._webPartManager._setDisplayMode(e,this._props.webPartInstanceId)},e.prototype.requestPropertyPaneAction=function(e,t,a){a&&(n.Validate.isNotNullOrUndefined(this._domElement,"domElement"),this.setWebPartData(a,e)),this._webPartManager.requestPropertyPaneAction(e,t)},e.prototype._getHeight=function(){return n.Validate.isNotNullOrUndefined(this._domElement,"domElement"),this._domElement.children.item(0).offsetHeight},e.prototype._getWidth=function(){return n.Validate.isNotNullOrUndefined(this._domElement,"domElement"),this._domElement.children.item(0).offsetWidth},e.prototype._sendDimensionsCallback=function(){this._props.sendDimensionsToParent(this._getHeight())},e.prototype._renderWebPart=function(e){var t=this;return this._webPartManager.loadWebPart(this._getWebPartManagerContext(e,this._props.webPartData)).catch(function(n){t._webPartManager.renderError(e,n)})},e.prototype._getWebPartManagerContext=function(e,t){return{domElement:e,instanceId:this._props.webPartInstanceId,manifest:this._props.manifest,displayMode:this._props.displayMode||(this._props.openPropertyPane?n.DisplayMode.Edit:n.DisplayMode.Read),webPartData:t,addedFromPersistedData:this._isDataAddedFromPersistedData(),formFactor:this._props.formFactor,pageLayoutType:this._props.pageHostLayoutType}},e.prototype._isDataAddedFromPersistedData=function(){return!(!(0,l.mj)()&&void 0!==this._props.isDataAddedFromPersistedData)||this._props.isDataAddedFromPersistedData},e.prototype._validateProps=function(e){n.Validate.isNotNullOrUndefined(e,"props"),n.Validate.isNotNullOrUndefined(e.webPartData,"props.webPartData"),n.Validate.isNotNullOrUndefined(e.webPartInstanceId,"props.webPartInstanceId"),n.Validate.isNotNullOrUndefined(e.manifest,"props.manifest"),n.Validate.isNotNullOrUndefined(e.serviceScope,"props.applicationContext.serviceScope")},e}()})(),v})())})();