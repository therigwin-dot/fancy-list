define("e40f8203-b39d-425a-a957-714852e33b79_1.21.1",["@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-diagnostics"],(e,t,n)=>(()=>{"use strict";var a={676:e=>{e.exports=t},207:e=>{e.exports=n},529:t=>{t.exports=e}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return a[e](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{r.r(o),r.d(o,{DynamicDataReference:()=>e,_DynamicDataManager:()=>f,_DynamicDataUtilities:()=>p,_PageContextDataSource:()=>m});const e=function(){function e(e){var t=e.split(":");if(t.length<2)throw new Error('Data id is malformed. Data id: "'.concat(e,'"'));this._reference=e,this._sourceId=t[0],this._property=t[1],this._propertyPath=t[2]}return Object.defineProperty(e.prototype,"reference",{get:function(){return this._reference},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sourceId",{get:function(){return this._sourceId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"property",{get:function(){return this._property},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertyPath",{get:function(){return this._propertyPath},enumerable:!1,configurable:!0}),e}();var t=r(529);const n=JSON.parse('{"o1":"A source with id \\u0022{0}\\u0022 already exists.","y9":"No source with id \\u0022{0}\\u0022 found.","ip":"Page environment","OC":"This includes some metadata about the page"}');var a=r(676),i=r(207),s="DynamicData_SourcesChanged",c="_",d=function(){function e(){}return e.getAllPropertiesChangedEventName=function(e){return"".concat("DynamicData_AllPropertiesChanged").concat(c).concat(e)},e.getAnyPropertyChangedEventName=function(e){return"".concat("DynamicData_AnyPropertyChanged").concat(c).concat(e)},e.getPropertyChangedEventName=function(e,t){return"".concat(this.getPropertyChangedEventPrefix(e)).concat(c).concat(t)},e.getPropertyChangedEventPrefix=function(e){return"".concat("DynamicData_PropertyChanged").concat(c).concat(e)},e.getPropertyValueEventName=function(e,t,n){return"".concat(n?"DynamicData_Annotated_PropertyValue":"DynamicData_PropertyValue").concat(c).concat(e).concat(c).concat(t)},e.getPropertyDefintionsEventName=function(e){return"".concat("DynamicData_PropertyDefinitions").concat(c).concat(e)},e.getAllowedEventsEventName=function(e){return"".concat("DynamicData_Allowed_Events").concat(c).concat(e)},e.getNativeSourceApiEventName=function(){return"".concat("Native_Source_Api_Event")},e.getDynamicDataManagerExceptionEventName=function(e){return"".concat("DynamicDataManager_Exception").concat(c).concat(e)},e}(),l="DynamicData.DynamicDataManager",u=i._LogSource.create("DynamicDataManager");const f=function(){function e(e){this._sources=new Map,this._sourcesChangedEvent=new a.SPEvent(s)}return Object.defineProperty(e.prototype,"sourcesChangedEvent",{get:function(){return this._sourcesChangedEvent},enumerable:!1,configurable:!0}),e.prototype.notifySourceChanged=function(e){a.Validate.isNonemptyString(e,"sourceId"),a._SPEventManager.instance.raiseEvent(d.getAllPropertiesChangedEventName(e),{}),a._SPEventManager.instance.raiseEvent(d.getAnyPropertyChangedEventName(e),{})},e.prototype.notifyPropertyChanged=function(e,t){a.Validate.isNonemptyString(e,"sourceId"),a.Validate.isNonemptyString(t,"propertyId"),a._SPEventManager.instance.raiseEvent(d.getPropertyChangedEventName(e,t),{}),a._SPEventManager.instance.raiseEvent(d.getAnyPropertyChangedEventName(e),{})},e.prototype.registerSourceChanged=function(e,t,r){var o=this._createQosExtraData(t.manifest),s=new i._QosMonitor(l+".registerSourceChanged");try{if(a.Validate.isNonemptyString(e,"sourceId"),a.Validate.isNotNullOrUndefined(t,"observer"),a.Validate.isNotNullOrUndefined(r,"callback"),!this._sources.has(e))throw new Error(a.Text.format(n.y9,e));a._SPEventManager.instance.registerEvent(d.getAllPropertiesChangedEventName(e),t,r),a._SPEventManager.instance.registerEvent(d.getAnyPropertyChangedEventName(e),t,r),s.writeSuccess(o)}catch(e){throw s.writeUnexpectedFailure("UnhandledRegisterSourceChange",e,o),e}},e.prototype.unregisterSourceChanged=function(e,t,r){var o=this._createQosExtraData(t.manifest),s=new i._QosMonitor(l+".unregisterSourceChanged");try{if(a.Validate.isNonemptyString(e,"sourceId"),a.Validate.isNotNullOrUndefined(t,"observer"),a.Validate.isNotNullOrUndefined(r,"callback"),!this._sources.has(e))throw new Error(a.Text.format(n.y9,e));a._SPEventManager.instance.unregisterEvent(d.getAllPropertiesChangedEventName(e),t,r),a._SPEventManager.instance.unregisterEvent(d.getAnyPropertyChangedEventName(e),t,r),s.writeSuccess(o)}catch(e){throw s.writeUnexpectedFailure("UnhandledUnregisterSourceChange",e,o),e}},e.prototype.registerPropertyChanged=function(e,t,r,o){var s=this._createQosExtraData(r.manifest),c=new i._QosMonitor(l+".registerPropertyChanged");try{if(a.Validate.isNonemptyString(e,"sourceId"),a.Validate.isNonemptyString(t,"propertyId"),a.Validate.isNotNullOrUndefined(r,"observer"),a.Validate.isNotNullOrUndefined(o,"callback"),!this._sources.has(e))throw new Error(a.Text.format(n.y9,e));a._SPEventManager.instance.registerEvent(d.getPropertyChangedEventName(e,t),r,o),a._SPEventManager.instance.registerEvent(d.getAllPropertiesChangedEventName(e),r,o),c.writeSuccess(s)}catch(e){throw c.writeUnexpectedFailure("UnhandledRegisterPropertyChange",e,s),e}},e.prototype.unregisterPropertyChanged=function(e,t,r,o){var s=this._createQosExtraData(r.manifest),c=new i._QosMonitor(l+".unregisterPropertyChanged");try{if(a.Validate.isNonemptyString(e,"sourceId"),a.Validate.isNonemptyString(t,"propertyId"),a.Validate.isNotNullOrUndefined(r,"observer"),a.Validate.isNotNullOrUndefined(o,"callback"),!this._sources.has(e))throw new Error(a.Text.format(n.y9,e));a._SPEventManager.instance.unregisterEvent(d.getPropertyChangedEventName(e,t),r,o),a._SPEventManager.instance.unregisterEvent(d.getAllPropertiesChangedEventName(e),r,o),c.writeSuccess(s)}catch(e){throw c.writeUnexpectedFailure("UnhandledUnregisterPropertyChange",e,s),e}},e.prototype.getSources=function(){var e=[];return this._sources.forEach(function(t){return e.push(t)}),e},e.prototype.tryGetSource=function(e){return a.Validate.isNotNullOrUndefined(e,"sourceId"),this._sources.get(e)},e.prototype.addSource=function(e){this._validateSource(e),this._sources.has(e.id)&&i._TraceLogger.logVerbose(u,a.Text.format(n.o1,e.id)),this._sources.set(e.id,e),this._raiseSourcesChangedEvent()},e.prototype.removeSource=function(e){var t=new i._QosMonitor(l+".removeSource");try{a.Validate.isNonemptyString(e,"sourceId"),this._sources.has(e)&&(a._SPEventManager.instance.removeEvent(d.getAllPropertiesChangedEventName(e)),a._SPEventManager.instance.removeEvent(d.getAnyPropertyChangedEventName(e)),a._SPEventManager.instance.removeEventsByPrefix(d.getPropertyChangedEventPrefix(e)),this._sources.delete(e),this._raiseSourcesChangedEvent()),t.writeSuccess()}catch(e){throw t.writeUnexpectedFailure(e),e}},e.prototype._createQosExtraData=function(e){if(e)return{alias:e.alias,isInternal:e.isInternal,manifestId:e.id}},e.prototype._validateSource=function(e){if(a.Validate.isNotNullOrUndefined(e,"source"),e.id.indexOf(c)>-1)throw new Error('Source id contains invalid characters, like "'.concat(c,'". Id: "').concat(e.id,'".'));var t=/^[a-zA-Z0-9\-_]+$/;e.getPropertyDefinitions().forEach(function(e){if(!t.test(e.id))throw new Error('Source contains invalid property "'.concat(e.id,'".'))})},e.prototype._raiseSourcesChangedEvent=function(){a._SPEventManager.instance.raiseStickyEvent(s,{})},e}();var p=function(){function e(){}return e.IDynamicDataManagerServiceKey=a.ServiceKey.create("sp-dynamic-data:IDynamicDataManager",f),e}();const m=function(){function e(t){var a=this;this._propertyDefinitions={},this._eventDefinitions={},this._serviceScope=t,this._serviceScope.whenFinished(function(){a._dynamicDataManager=t.consume(p.IDynamicDataManagerServiceKey),a._dynamicDataManager.addSource({id:e.pageContextDataSourceId,metadata:{title:n.ip,description:n.OC,componentId:"1c4541f7-5c31-41aa-9fa8-fbc9dc14c0a8",alias:e._pageContextDataSourceAlias},getPropertyDefinitions:a.getPropertyDefinitions.bind(a),getAnnotatedPropertyValue:a.getAnnotatedPropertyValue.bind(a),getPropertyValue:a.getPropertyValue.bind(a),sendEvent:a.sendEvent.bind(a),getPropertyDefinitionsAsync:a.getPropertyDefinitionsAsync.bind(a),allowedEventsAsync:a.allowedEventsAsync.bind(a),getAnnotatedPropertyValueAsync:a.getAnnotatedPropertyValueAsync.bind(a),getPropertyValueAsync:a.getPropertyValueAsync.bind(a)})})}return e.prototype.addPropertyHandler=function(t){var n=this;t.dynamicDataFunctions.getPropertyDefinitions().forEach(function(e){n._propertyDefinitions[e.id]={propertyCollectionId:t.id,annotatedPropertyValueFunction:t.dynamicDataFunctions.getAnnotatedPropertyValue,propertyValueFunction:t.dynamicDataFunctions.getPropertyValue,definition:e}}),t.dynamicDataFunctions.allowedEvents&&t.dynamicDataFunctions.allowedEvents().forEach(function(e){t.dynamicDataFunctions.sendEvent&&(n._eventDefinitions[e.name]={propertyCollectionId:t.id,sendEvent:t.dynamicDataFunctions.sendEvent,definition:e})}),this._dynamicDataManager.notifySourceChanged(e.pageContextDataSourceId)},e.prototype.notifyPropertyChanged=function(t){this._dynamicDataManager.notifyPropertyChanged(e.pageContextDataSourceId,t)},e.prototype.removePropertyHandler=function(e){for(var t in this._propertyDefinitions)this._propertyDefinitions.hasOwnProperty(t)&&this._propertyDefinitions[t].propertyCollectionId===e&&delete this._propertyDefinitions[t];for(var t in this._eventDefinitions)this._eventDefinitions.hasOwnProperty(t)&&this._eventDefinitions[t].propertyCollectionId===e&&delete this._eventDefinitions[t];this._dynamicDataManager.notifySourceChanged("PageContext")},e.prototype.getPropertyDefinitions=function(){var e=[];for(var n in this._propertyDefinitions)this._propertyDefinitions.hasOwnProperty(n)&&e.push(this._propertyDefinitions[n].definition);return(0,t.cloneDeep)(e)},e.prototype.getPropertyValue=function(e){if(this._propertyDefinitions[e])return(0,t.cloneDeep)(this._propertyDefinitions[e].propertyValueFunction(e))},e.prototype.getAnnotatedPropertyValue=function(e){return this._propertyDefinitions[e]?(0,t.cloneDeep)(this._propertyDefinitions[e].annotatedPropertyValueFunction(e)):{sampleValue:void 0}},e.prototype.getPropertyDefinitionsAsync=function(){return Promise.resolve(this.getPropertyDefinitions())},e.prototype.getPropertyValueAsync=function(e){return Promise.resolve(this.getPropertyValue(e))},e.prototype.getAnnotatedPropertyValueAsync=function(e){return Promise.resolve(this.getAnnotatedPropertyValue(e))},e.prototype.allowedEventsAsync=function(){var e=[];for(var n in this._eventDefinitions)this._eventDefinitions.hasOwnProperty(n)&&e.push(this._eventDefinitions[n].definition);return Promise.resolve((0,t.cloneDeep)(e))},e.prototype.sendEvent=function(e,t){this._eventDefinitions[e]&&this._eventDefinitions[e].sendEvent(e,t)},e.pageContextDataSourceId="PageContext",e._pageContextDataSourceAlias="Page Context",e}()})(),o})());