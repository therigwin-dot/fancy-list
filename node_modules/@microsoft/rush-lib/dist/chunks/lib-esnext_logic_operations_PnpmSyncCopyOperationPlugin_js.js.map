{"version":3,"file":"chunks/lib-esnext_logic_operations_PnpmSyncCopyOperationPlugin_js.js","mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACiE;AACf;AACE;AACkB;AACtE;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,qBAAqB,+BAA+B;AACxE;AACA,2BAA2B,6DAAe;AAC1C,2BAA2B,6DAAe;AAC1C,2BAA2B,6DAAe;AAC1C;AACA;AACA;AACA,4CAA4C,sBAAsB;AAClE,0BAA0B,oEAAU;AACpC,4BAA4B,mBAAmB,QAAQ,sIAEJ;AACnD,0BAA0B,gEAAiB;AAC3C;AACA,2CAA2C,oEAAU;AACrD,qDAAqD,+DAAK;AAC1D;AACA,mEAAmE,2EAAiB;AACpF,qBAAqB;AACrB;AACA;AACA,SAAS;AACT;AACA;AACA","sources":["webpack://@microsoft/rush-lib/./lib-esnext/logic/operations/PnpmSyncCopyOperationPlugin.js"],"sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n// See LICENSE in the project root for license information.\nimport { Async, FileSystem } from '@rushstack/node-core-library';\nimport { pnpmSyncCopyAsync } from 'pnpm-sync-lib';\nimport { OperationStatus } from './OperationStatus';\nimport { PnpmSyncUtilities } from '../../utilities/PnpmSyncUtilities';\nconst PLUGIN_NAME = 'PnpmSyncCopyOperationPlugin';\nexport class PnpmSyncCopyOperationPlugin {\n    constructor(terminal) {\n        this._terminal = terminal;\n    }\n    apply(hooks) {\n        hooks.afterExecuteOperation.tapPromise(PLUGIN_NAME, async (runnerContext) => {\n            const record = runnerContext;\n            const { status, operation: { associatedProject: project } } = record;\n            //skip if the phase is skipped or no operation\n            if (status === OperationStatus.Skipped ||\n                status === OperationStatus.NoOp ||\n                status === OperationStatus.Failure) {\n                return;\n            }\n            if (project) {\n                const pnpmSyncJsonPath = `${project.projectFolder}/node_modules/.pnpm-sync.json`;\n                if (await FileSystem.exists(pnpmSyncJsonPath)) {\n                    const { PackageExtractor } = await import(\n                    /* webpackChunkName: 'PackageExtractor' */\n                    '@rushstack/package-extractor');\n                    await pnpmSyncCopyAsync({\n                        pnpmSyncJsonPath,\n                        ensureFolderAsync: FileSystem.ensureFolderAsync,\n                        forEachAsyncWithConcurrency: Async.forEachAsync,\n                        getPackageIncludedFiles: PackageExtractor.getPackageIncludedFilesAsync,\n                        logMessageCallback: (logMessageOptions) => PnpmSyncUtilities.processLogMessage(logMessageOptions, this._terminal)\n                    });\n                }\n            }\n        });\n    }\n}\n//# sourceMappingURL=PnpmSyncCopyOperationPlugin.js.map"],"names":[],"sourceRoot":""}