{"version":3,"file":"CommandLineMigrationAdvisor.js","sourceRoot":"","sources":["../../src/cli/CommandLineMigrationAdvisor.ts"],"names":[],"mappings":"AAAA,4FAA4F;AAC5F,2DAA2D;AAE3D,OAAO,EAAE,QAAQ,EAAE,cAAc,EAAE,MAAM,qBAAqB,CAAC;AAE/D,OAAO,EAAE,aAAa,EAAE,MAAM,wBAAwB,CAAC;AAEvD,MAAM,OAAO,2BAA2B;IACtC,wDAAwD;IACxD,mFAAmF;IAC5E,MAAM,CAAC,SAAS,CAAC,IAAc;QACpC,4BAA4B;QAC5B,MAAM,IAAI,GAAa,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAE7C,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YACpB,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE,CAAC;gBAC3B,2BAA2B,CAAC,iBAAiB,CAC3C,wEAAwE,CACzE,CAAC;gBACF,OAAO,KAAK,CAAC;YACf,CAAC;YAED,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE,CAAC;gBAC1B,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC;oBACtC,2BAA2B,CAAC,iBAAiB,CAC3C,oEAAoE,CACrE,CAAC;oBACF,OAAO,KAAK,CAAC;gBACf,CAAC;gBACD,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;oBAC5B,2BAA2B,CAAC,iBAAiB,CAC3C,0DAA0D,CAC3D,CAAC;oBACF,OAAO,KAAK,CAAC;gBACf,CAAC;gBACD,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC;oBACjC,2BAA2B,CAAC,iBAAiB,CAC3C,gEAAgE,CACjE,CAAC;oBACF,OAAO,KAAK,CAAC;gBACf,CAAC;gBACD,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;oBAC5B,2BAA2B,CAAC,iBAAiB,CAC3C,2DAA2D,CAC5D,CAAC;oBACF,OAAO,KAAK,CAAC;gBACf,CAAC;YACH,CAAC;QACH,CAAC;QAED,qBAAqB;QACrB,OAAO,IAAI,CAAC;IACd,CAAC;IAEO,MAAM,CAAC,iBAAiB,CAAC,OAAe;QAC9C,sCAAsC;QACtC,OAAO,CAAC,KAAK,CACX,QAAQ,CAAC,GAAG,CACV,cAAc,CAAC,SAAS,CACtB,oGAAoG,CACrG,CACF,CACF,CAAC;QACF,sCAAsC;QACtC,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAClE,sCAAsC;QACtC,OAAO,CAAC,KAAK,EAAE,CAAC;QAChB,sCAAsC;QACtC,OAAO,CAAC,KAAK,CACX,cAAc,CAAC,SAAS,CACtB,qEAAqE;YACnE,iBAAiB,aAAa,CAAC,cAAc,EAAE,CAClD,CACF,CAAC;IACJ,CAAC;CACF","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n// See LICENSE in the project root for license information.\n\nimport { Colorize, PrintUtilities } from '@rushstack/terminal';\n\nimport { RushConstants } from '../logic/RushConstants';\n\nexport class CommandLineMigrationAdvisor {\n  // NOTE: THIS RUNS BEFORE THE REAL COMMAND-LINE PARSING.\n  // TAKE EXTREME CARE THAT THE HEURISTICS CANNOT FALSELY MATCH A VALID COMMAND LINE.\n  public static checkArgv(argv: string[]): boolean {\n    // 0=node.exe, 1=script name\n    const args: string[] = process.argv.slice(2);\n\n    if (args.length > 0) {\n      if (args[0] === 'generate') {\n        CommandLineMigrationAdvisor._reportDeprecated(\n          'Instead of \"rush generate\", use \"rush update\" or \"rush update --full\".'\n        );\n        return false;\n      }\n\n      if (args[0] === 'install') {\n        if (args.indexOf('--full-clean') >= 0) {\n          CommandLineMigrationAdvisor._reportDeprecated(\n            'Instead of \"rush install --full-clean\", use \"rush purge --unsafe\".'\n          );\n          return false;\n        }\n        if (args.indexOf('-C') >= 0) {\n          CommandLineMigrationAdvisor._reportDeprecated(\n            'Instead of \"rush install -C\", use \"rush purge --unsafe\".'\n          );\n          return false;\n        }\n        if (args.indexOf('--clean') >= 0) {\n          CommandLineMigrationAdvisor._reportDeprecated(\n            'Instead of \"rush install --clean\", use \"rush install --purge\".'\n          );\n          return false;\n        }\n        if (args.indexOf('-c') >= 0) {\n          CommandLineMigrationAdvisor._reportDeprecated(\n            'Instead of \"rush install -c\", use \"rush install --purge\".'\n          );\n          return false;\n        }\n      }\n    }\n\n    // Everything is okay\n    return true;\n  }\n\n  private static _reportDeprecated(message: string): void {\n    // eslint-disable-next-line no-console\n    console.error(\n      Colorize.red(\n        PrintUtilities.wrapWords(\n          'ERROR: You specified an outdated command-line that is no longer supported by this version of Rush:'\n        )\n      )\n    );\n    // eslint-disable-next-line no-console\n    console.error(Colorize.yellow(PrintUtilities.wrapWords(message)));\n    // eslint-disable-next-line no-console\n    console.error();\n    // eslint-disable-next-line no-console\n    console.error(\n      PrintUtilities.wrapWords(\n        `For command-line help, type \"rush -h\".  For migration instructions,` +\n          ` please visit ${RushConstants.rushWebSiteUrl}`\n      )\n    );\n  }\n}\n"]}